!function(t){function e(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var n={};e.m=t,e.c=n,e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="/",e(e.s=125)}([function(t,e,n){"use strict";e.__esModule=!0,e.default=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},function(t,e,n){"use strict";e.__esModule=!0;var i=n(143),r=function(t){return t&&t.__esModule?t:{default:t}}(i);e.default=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}()},function(t,e,n){"use strict";e.__esModule=!0;var i=n(4),r=function(t){return t&&t.__esModule?t:{default:t}}(i);e.default=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":(0,r.default)(e))&&"function"!=typeof e?t:e}},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var r=n(170),o=i(r),a=n(174),s=i(a),u=n(4),l=i(u);e.default=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":(0,l.default)(e)));t.prototype=(0,s.default)(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(o.default?(0,o.default)(t,e):t.__proto__=e)}},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var r=n(146),o=i(r),a=n(148),s=i(a),u="function"==typeof s.default&&"symbol"==typeof o.default?function(t){return typeof t}:function(t){return t&&"function"==typeof s.default&&t.constructor===s.default&&t!==s.default.prototype?"symbol":typeof t};e.default="function"==typeof s.default&&"symbol"===u(o.default)?function(t){return void 0===t?"undefined":u(t)}:function(t){return t&&"function"==typeof s.default&&t.constructor===s.default&&t!==s.default.prototype?"symbol":void 0===t?"undefined":u(t)}},function(t,e,n){"use strict";function i(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),i(n(21)),i(n(8)),i(n(183)),i(n(184))},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var r=n(189),o=i(r),a=n(192),s=i(a);e.default=function t(e,n,i){null===e&&(e=Function.prototype);var r=(0,s.default)(e,n);if(void 0===r){var a=(0,o.default)(e);return null===a?void 0:t(a,n,i)}if("value"in r)return r.value;var u=r.get;return void 0!==u?u.call(i):void 0}},function(t,e,n){"use strict";function i(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),i(n(159)),i(n(50)),i(n(20)),i(n(93)),i(n(49)),i(n(160)),i(n(22)),i(n(76)),i(n(51)),i(n(13))},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a);Object.defineProperty(e,"__esModule",{value:!0});var u,l=n(48),c=n(92),h=n(162),f=n(179),d=n(180),p=n(26),y=n(101),v=n(51);!function(t){t[t.Desktop=0]="Desktop",t[t.Web=1]="Web"}(u=e.Client||(e.Client={}));var g=function(){function t(){if((0,o.default)(this,t),this.scene=null,this.nextScene=null,this.dt=0,this.elapsed=0,this.paused=!1,this.frameCount=0,this.lastTime=0,this.timeScale=1,this.useStats=!1,null!=t.instance)throw Error("Engine has already been instantiated");if(!t.started)throw Error("Engine must be instantiated through static Engine.start");t.instance=this,this.client=u.Web,window&&window.process&&window.process.versions&&window.process.versions.electron&&(this.client=u.Desktop),this.startTime=Date.now(),this.lastTime=Date.now()}return(0,s.default)(t,[{key:"step",value:function(){this.useStats&&!this._stats&&(this._stats=new Stats,this._stats.showPanel(0),document.body.appendChild(this._stats.dom)),this._stats&&this._stats.begin();var e=Date.now();this.dt=this.paused?0:Math.floor(e-this.lastTime)/1e3*this.timeScale,this.lastTime=e,this.frameCount++,this.elapsed+=this.dt,this.graphics.update(),p.Mouse.update(),p.Keyboard.update(),null!=this.nextScene&&(null!=this.scene&&(this.scene.ended(),this.disposeLastScene&&this.scene.dispose()),this.scene=this.nextScene,this.nextScene=null,this.scene.begin()),null!=this.scene&&this.scene.update(),null==this.nextScene&&(this.graphics.reset(),null!=this.scene&&this.scene.render(),this.graphics.finalize());var n=!0,i=!1,r=void 0;try{for(var o,a=c.Sound.active[Symbol.iterator]();!(n=(o=a.next()).done);n=!0)o.value.update()}catch(t){i=!0,r=t}finally{try{!n&&a.return&&a.return()}finally{if(i)throw r}}this._stats&&this._stats.end(),t.exiting||requestAnimationFrame(this.step.bind(this))}},{key:"exit",value:function(){t.exiting=!0,l.Assets.unload(),t.graphics.unload(),t.client===u.Desktop&&n(96).remote.getCurrentWindow().close()}}],[{key:"start",value:function(e,n,i,r,o){t.started=!0,new t,new f.GameWindow,document.addEventListener("visibilitychange",function(){document.hidden?t._hidden=!0:(t._hidden=!1,t.instance&&(t.instance.lastTime=Date.now()))}),f.GameWindow.title=e,f.GameWindow.resize(n*r,i*r),f.GameWindow.center();var a=function(){String.fromCharCode(9679),t.instance.root=document.getElementsByClassName("container")[0],h.registerDefaultOverlapTests(),y.FosterIO.init(),t.instance.graphics=new d.Graphics(t.instance),t.instance.graphics.load(),t.resize(n,i),v.Shaders.init(),p.Mouse.init(),p.Keyboard.init(),p.GamepadManager.init(),t.instance.step(),void 0!==o&&o()};"complete"===document.readyState||"interactive"===document.readyState?a():document.addEventListener("DOMContentLoaded",a)}},{key:"goto",value:function(e,n){return t.scene,t.instance.nextScene=e,t.instance.disposeLastScene=n,e}},{key:"exit",value:function(){t.started&&!t.exiting&&t.instance.exit()}},{key:"resize",value:function(e,n){t.instance.width=e,t.instance.height=n,t.instance.graphics.resize()}},{key:"assert",value:function(t,e){if(!t)throw e;return t}},{key:"root",get:function(){return t.instance.root}},{key:"client",get:function(){return t.instance.client}},{key:"scene",get:function(){return null!=t.instance.nextScene?t.instance.nextScene:t.instance.scene}},{key:"width",get:function(){return t.instance.width}},{key:"height",get:function(){return t.instance.height}},{key:"debugMode",get:function(){return t.instance.debuggerEnabled},set:function(e){t.instance.debuggerEnabled=e}},{key:"delta",get:function(){return t.instance.paused?0:t.instance.dt}},{key:"elapsed",get:function(){return t.instance.elapsed}},{key:"paused",get:function(){return this._hidden||t.instance.paused},set:function(e){t.instance.paused=e}},{key:"timeScale",get:function(){return t.instance.timeScale},set:function(e){t.instance.timeScale=e}},{key:"frameCount",get:function(){return t.instance.frameCount}},{key:"graphics",get:function(){return t.instance.graphics}},{key:"volume",get:function(){return t._volume},set:function(e){t._volume=e;var n=!0,i=!1,r=void 0;try{for(var o,a=c.Sound.active[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;s.volume=s.volume}}catch(t){i=!0,r=t}finally{try{!n&&a.return&&a.return()}finally{if(i)throw r}}}},{key:"muted",get:function(){return t._muted},set:function(e){t._muted=e;var n=!0,i=!1,r=void 0;try{for(var o,a=c.Sound.active[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;s.muted=s.muted}}catch(t){i=!0,r=t}finally{try{!n&&a.return&&a.return()}finally{if(i)throw r}}}}]),t}();g.version="0.1.11",g._volume=1,g._muted=!1,g._hidden=!1,g.instance=null,g.started=!1,g.exiting=!1,e.Engine=g},function(t,e,n){"use strict";function i(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),i(n(110)),i(n(198)),i(n(199)),i(n(200))},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a),u=n(2),l=i(u),c=n(3),h=i(c);Object.defineProperty(e,"__esModule",{value:!0});var f=n(5),d=n(41),AutoComponent=function(t){function AutoComponent(t){(0,o.default)(this,AutoComponent);var e=(0,l.default)(this,(AutoComponent.__proto__||Object.getPrototypeOf(AutoComponent)).call(this));return e.opts=t,e}return(0,h.default)(AutoComponent,t),(0,s.default)(AutoComponent,[{key:"removeSelf",value:function(){this.entity.remove(this)}},{key:"destroyParentEntity",value:function(){this.entity.scene.remove(this.entity)}},{key:"level",get:function(){return this.scene instanceof d.Level?this.scene:null}}]),AutoComponent}(f.Component);e.AutoComponent=AutoComponent},function(t,e,n){(function(t,e){/*! *****************************************************************************
Copyright (C) Microsoft. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var n;!function(n){"use strict";function i(t,e,n,i){if(O(n)){if(!A(t))throw new TypeError;if(!F(e))throw new TypeError;return d(t,e)}if(!A(t))throw new TypeError;if(!T(e))throw new TypeError;if(!T(i)&&!O(i)&&!S(i))throw new TypeError;return S(i)&&(i=void 0),n=M(n),p(t,e,n,i)}function r(t,e){function n(n,i){if(!T(n))throw new TypeError;if(!O(i)&&!B(i))throw new TypeError;b(t,e,n,i)}return n}function o(t,e,n,i){if(!T(n))throw new TypeError;return O(i)||(i=M(i)),b(t,e,n,i)}function a(t,e,n){if(!T(e))throw new TypeError;return O(n)||(n=M(n)),v(t,e,n)}function s(t,e,n){if(!T(e))throw new TypeError;return O(n)||(n=M(n)),g(t,e,n)}function u(t,e,n){if(!T(e))throw new TypeError;return O(n)||(n=M(n)),m(t,e,n)}function l(t,e,n){if(!T(e))throw new TypeError;return O(n)||(n=M(n)),_(t,e,n)}function c(t,e){if(!T(t))throw new TypeError;return O(e)||(e=M(e)),x(t,e)}function h(t,e){if(!T(t))throw new TypeError;return O(e)||(e=M(e)),w(t,e)}function f(t,e,n){if(!T(e))throw new TypeError;O(n)||(n=M(n));var i=y(e,n,!1);if(O(i))return!1;if(!i.delete(t))return!1;if(i.size>0)return!0;var r=tt.get(e);return r.delete(n),r.size>0||(tt.delete(e),!0)}function d(t,e){for(var n=t.length-1;n>=0;--n){var i=t[n],r=i(e);if(!O(r)&&!S(r)){if(!F(r))throw new TypeError;e=r}}return e}function p(t,e,n,i){for(var r=t.length-1;r>=0;--r){var o=t[r],a=o(e,n,i);if(!O(a)&&!S(a)){if(!T(a))throw new TypeError;i=a}}return i}function y(t,e,n){var i=tt.get(t);if(O(i)){if(!n)return;i=new $,tt.set(t,i)}var r=i.get(e);if(O(r)){if(!n)return;r=new $,i.set(e,r)}return r}function v(t,e,n){if(g(t,e,n))return!0;var i=V(e);return!S(i)&&v(t,i,n)}function g(t,e,n){var i=y(e,n,!1);return!O(i)&&R(i.has(t))}function m(t,e,n){if(g(t,e,n))return _(t,e,n);var i=V(e);return S(i)?void 0:m(t,i,n)}function _(t,e,n){var i=y(e,n,!1);if(!O(i))return i.get(t)}function b(t,e,n,i){y(n,i,!0).set(t,e)}function x(t,e){var n=w(t,e),i=V(t);if(null===i)return n;var r=x(i,e);if(r.length<=0)return n;if(n.length<=0)return r;for(var o=new Q,a=[],s=0,u=n;s<u.length;s++){var l=u[s],c=o.has(l);c||(o.add(l),a.push(l))}for(var h=0,f=r;h<f.length;h++){var l=f[h],c=o.has(l);c||(o.add(l),a.push(l))}return a}function w(t,e){var n=[],i=y(t,e,!1);if(O(i))return n;for(var r=i.keys(),o=G(r),a=0;;){var s=N(o);if(!s)return n.length=a,n;var u=U(s);try{n[a]=u}catch(t){try{I(o)}finally{throw t}}a++}}function k(t){if(null===t)return 1;switch(typeof t){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===t?1:6;default:return 6}}function O(t){return void 0===t}function S(t){return null===t}function E(t){return"symbol"==typeof t}function T(t){return"object"==typeof t?null!==t:"function"==typeof t}function P(t,e){switch(k(t)){case 0:case 1:case 2:case 3:case 4:case 5:return t}var n=3===e?"string":5===e?"number":"default",i=D(t,K);if(void 0!==i){var r=i.call(t,n);if(T(r))throw new TypeError;return r}return C(t,"default"===n?"number":n)}function C(t,e){if("string"===e){var n=t.toString;if(L(n)){var i=n.call(t);if(!T(i))return i}var r=t.valueOf;if(L(r)){var i=r.call(t);if(!T(i))return i}}else{var r=t.valueOf;if(L(r)){var i=r.call(t);if(!T(i))return i}var o=t.toString;if(L(o)){var i=o.call(t);if(!T(i))return i}}throw new TypeError}function R(t){return!!t}function j(t){return""+t}function M(t){var e=P(t,3);return E(e)?e:j(e)}function A(t){return Array.isArray?Array.isArray(t):t instanceof Object?t instanceof Array:"[object Array]"===Object.prototype.toString.call(t)}function L(t){return"function"==typeof t}function F(t){return"function"==typeof t}function B(t){switch(k(t)){case 3:case 4:return!0;default:return!1}}function D(t,e){var n=t[e];if(void 0!==n&&null!==n){if(!L(n))throw new TypeError;return n}}function G(t){var e=D(t,z);if(!L(e))throw new TypeError;var n=e.call(t);if(!T(n))throw new TypeError;return n}function U(t){return t.value}function N(t){var e=t.next();return!e.done&&e}function I(t){var e=t.return;e&&e.call(t)}function V(t){var e=Object.getPrototypeOf(t);if("function"!=typeof t||t===q)return e;if(e!==q)return e;var n=t.prototype,i=n&&Object.getPrototypeOf(n);if(null==i||i===Object.prototype)return e;var r=i.constructor;return"function"!=typeof r?e:r===t?e:r}function X(t){return t.__=void 0,delete t.__,t}var Y,H=Object.prototype.hasOwnProperty,W="function"==typeof Symbol,K=W&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",z=W&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator";!function(t){var e="function"==typeof Object.create,n={__proto__:[]}instanceof Array,i=!e&&!n;t.create=e?function(){return X(Object.create(null))}:n?function(){return X({__proto__:null})}:function(){return X({})},t.has=i?function(t,e){return H.call(t,e)}:function(t,e){return e in t},t.get=i?function(t,e){return H.call(t,e)?t[e]:void 0}:function(t,e){return t[e]}}(Y||(Y={}));var q=Object.getPrototypeOf(Function),J="object"==typeof t&&t.env&&"true"===t.env.REFLECT_METADATA_USE_MAP_POLYFILL,$=J||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?function(){function t(t,e){return t}function e(t,e){return e}function n(t,e){return[t,e]}var i={},r=[],o=function(){function t(t,e,n){this._index=0,this._keys=t,this._values=e,this._selector=n}return t.prototype["@@iterator"]=function(){return this},t.prototype[z]=function(){return this},t.prototype.next=function(){var t=this._index;if(t>=0&&t<this._keys.length){var e=this._selector(this._keys[t],this._values[t]);return t+1>=this._keys.length?(this._index=-1,this._keys=r,this._values=r):this._index++,{value:e,done:!1}}return{value:void 0,done:!0}},t.prototype.throw=function(t){throw this._index>=0&&(this._index=-1,this._keys=r,this._values=r),t},t.prototype.return=function(t){return this._index>=0&&(this._index=-1,this._keys=r,this._values=r),{value:t,done:!0}},t}();return function(){function r(){this._keys=[],this._values=[],this._cacheKey=i,this._cacheIndex=-2}return Object.defineProperty(r.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),r.prototype.has=function(t){return this._find(t,!1)>=0},r.prototype.get=function(t){var e=this._find(t,!1);return e>=0?this._values[e]:void 0},r.prototype.set=function(t,e){var n=this._find(t,!0);return this._values[n]=e,this},r.prototype.delete=function(t){var e=this._find(t,!1);if(e>=0){for(var n=this._keys.length,r=e+1;r<n;r++)this._keys[r-1]=this._keys[r],this._values[r-1]=this._values[r];return this._keys.length--,this._values.length--,t===this._cacheKey&&(this._cacheKey=i,this._cacheIndex=-2),!0}return!1},r.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=i,this._cacheIndex=-2},r.prototype.keys=function(){return new o(this._keys,this._values,t)},r.prototype.values=function(){return new o(this._keys,this._values,e)},r.prototype.entries=function(){return new o(this._keys,this._values,n)},r.prototype["@@iterator"]=function(){return this.entries()},r.prototype[z]=function(){return this.entries()},r.prototype._find=function(t,e){return this._cacheKey!==t&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=t)),this._cacheIndex<0&&e&&(this._cacheIndex=this._keys.length,this._keys.push(t),this._values.push(void 0)),this._cacheIndex},r}()}():Map,Q=J||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?function(){return function(){function t(){this._map=new $}return Object.defineProperty(t.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),t.prototype.has=function(t){return this._map.has(t)},t.prototype.add=function(t){return this._map.set(t,t),this},t.prototype.delete=function(t){return this._map.delete(t)},t.prototype.clear=function(){this._map.clear()},t.prototype.keys=function(){return this._map.keys()},t.prototype.values=function(){return this._map.values()},t.prototype.entries=function(){return this._map.entries()},t.prototype["@@iterator"]=function(){return this.keys()},t.prototype[z]=function(){return this.keys()},t}()}():Set,Z=J||"function"!=typeof WeakMap?function(){function t(){var t;do{t="@@WeakMap@@"+r()}while(Y.has(a,t));return a[t]=!0,t}function e(t,e){if(!H.call(t,s)){if(!e)return;Object.defineProperty(t,s,{value:Y.create()})}return t[s]}function n(t,e){for(var n=0;n<e;++n)t[n]=255*Math.random()|0;return t}function i(t){return"function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(t)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(t)):n(new Uint8Array(t),t):n(Array(t),t)}function r(){var t=i(o);t[6]=79&t[6]|64,t[8]=191&t[8]|128;for(var e="",n=0;n<o;++n){var r=t[n];4!==n&&6!==n&&8!==n||(e+="-"),r<16&&(e+="0"),e+=r.toString(16).toLowerCase()}return e}var o=16,a=Y.create(),s=t();return function(){function n(){this._key=t()}return n.prototype.has=function(t){var n=e(t,!1);return void 0!==n&&Y.has(n,this._key)},n.prototype.get=function(t){var n=e(t,!1);return void 0!==n?Y.get(n,this._key):void 0},n.prototype.set=function(t,n){return e(t,!0)[this._key]=n,this},n.prototype.delete=function(t){var n=e(t,!1);return void 0!==n&&delete n[this._key]},n.prototype.clear=function(){this._key=t()},n}()}():WeakMap,tt=new Z;n.decorate=i,n.metadata=r,n.defineMetadata=o,n.hasMetadata=a,n.hasOwnMetadata=s,n.getMetadata=u,n.getOwnMetadata=l,n.getMetadataKeys=c,n.getOwnMetadataKeys=h,n.deleteMetadata=f,function(t){if(void 0!==t.Reflect){if(t.Reflect!==n)for(var e in n)H.call(n,e)&&(t.Reflect[e]=n[e])}else t.Reflect=n}(void 0!==e?e:"undefined"!=typeof self?self:Function("return this;")())}(n||(n={}))}).call(e,n(91),n(74))},function(t,e,n){"use strict";function i(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),i(n(40)),i(n(94)),i(n(95))},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a);Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(e,n){(0,o.default)(this,t),this.x=0,this.y=0,void 0!==e&&(this.x=e),void 0!==n&&(this.y=n)}return(0,s.default)(t,[{key:"set",value:function(t,e){return this.x=t,this.y=e,this}},{key:"copy",value:function(t){return this.x=t.x,this.y=t.y,this}},{key:"add",value:function(t){return this.x+=t.x,this.y+=t.y,this}},{key:"sub",value:function(t){return this.x-=t.x,this.y-=t.y,this}},{key:"max",value:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}},{key:"min",value:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}},{key:"mult",value:function(t){return"number"==typeof t?(this.x*=t,this.y*=t):(this.x*=t.x,this.y*=t.y),this}},{key:"div",value:function(t){return this.x/=t.x,this.y/=t.y,this}},{key:"scale",value:function(t){return this.x*=t,this.y*=t,this}},{key:"rotate",value:function(t,e){var n=this.x,i=this.y;return this.x=n*e-i*t,this.y=n*t+i*e,this}},{key:"transform",value:function(t){var e=this.x,n=this.y;return this.x=t.mat[0]*e+t.mat[3]*n+t.mat[6],this.y=t.mat[1]*e+t.mat[4]*n+t.mat[7],this}},{key:"clone",value:function(){return new t(this.x,this.y)}},{key:"normalize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=this.length;return this.x=this.x/e*t,this.y=this.y/e*t,this}},{key:"length",get:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}},{key:"angle",get:function(){return Math.atan2(this.y,this.x)}},{key:"normal",get:function(){var e=this.length;return new t(this.x/e,this.y/e)}}],[{key:"distance",value:function(e,n){return t._dist_temp.copy(e).sub(n).length}},{key:"zero",get:function(){return t._zero.set(0,0)}}]),t}();u._dist_temp=new u,u.directions=[new u(-1,0),new u(0,-1),new u(1,0),new u(0,1)],u.temp0=new u,u.temp1=new u,u.temp2=new u,u.temp3=new u,u.temp4=new u,u.temp5=new u,u.up=new u(0,-1),u.down=new u(0,1),u.left=new u(-1,0),u.right=new u(1,0),u._zero=new u,e.Vector=u},function(t,e,n){"use strict";function i(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),i(n(195)),i(n(196)),i(n(197))},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(){k=n(233),k.defineTemplates()}function o(t){var e=[];return JSON.stringify(t,function(t,n){if("object"===(void 0===n?"undefined":(0,f.default)(n))&&null!==n){if(-1!==e.indexOf(n))return;e.push(n)}return n},2)}var a=n(17),s=(i(a),n(0)),u=i(s),l=n(1),c=i(l),h=n(4),f=i(h);Object.defineProperty(e,"__esModule",{value:!0});var d=n(5),p=n(35),y=n(105),v=n(187),g=n(26),m=n(7),_=n(188),b=(n(41),n(123)),x=n(231),w=(n(232),n(16)),k=void 0,O=function(){function t(){(0,u.default)(this,t)}return(0,c.default)(t,null,[{key:"start",value:function(){d.Engine.start("traplands",320,288,5,function(){d.Engine.graphics.clearColor=t.transitionColor,t.load()})}},{key:"load",value:function(){var e=t.KEYS,n=g.Keyboard.map;n(e.LEFT,[g.Key.left,g.Key.a,g.Key.j]),n(e.RIGHT,[g.Key.right,g.Key.d,g.Key.l]),n(e.UP,[g.Key.up,g.Key.w,g.Key.i]),n(e.DOWN,[g.Key.down,g.Key.s,g.Key.k]),n(e.A,[g.Key.z,g.Key.c]),n(e.B,[g.Key.x,g.Key.v]),n(e.SHOOT,[g.Key.space,g.Key.ctrl]),n(e.RESTART,[g.Key.r]),n(e.START,[g.Key.enter]),n(e.SELECT,[g.Key.shift]),n(e.TELEPORT,[g.Key.t]),n(e.PAUSE,[g.Key.p]),n(e.FAST_FORWARD,[g.Key.graveAccent]),n(e.DEBUG_NEXT_LEVEL,[g.Key.closeBraket]),n(e.DEBUG_PREV_LEVEL,[g.Key.openBracket]),n(e.DEBUG_OPEN_DOOR,[g.Key.o]),n(e.BACK_TO_TITLE,[g.Key.escape]),n(e.FINISH_LEVEL,[g.Key.zero]),r(),UpdateLoadingBarProgress(.2),new p.AssetLoader("assets").addJson("assets.json").load(function(){UpdateLoadingBarProgress(.25),t.loadAssets(p.Assets.json["assets/assets.json"])})}},{key:"getAtlasReaderByName",value:function(t){switch(t){case"DoodleStudio":return y.AtlasReaders.DoodleStudio;case"Asesprite":return y.AtlasReaders.Aseprite;default:throw Error("expected a loaderType but got "+t)}}},{key:"loadAssets",value:function(e){var i=new p.AssetLoader("assets");i.progressCallback=function(t){UpdateLoadingBarProgress(.25+.75*t)};var r="fantasy/TMX/";i.addAtlas("gfx","atlas.png","atlas.json",y.AtlasReaders.Aseprite).addAtlas("sprites","sprites/sprite_atlas.png","sprites/sprite_atlas.json",y.AtlasReaders.Aseprite).addXml(r+"oryx_creatures.tsx").addXml(r+"oryx_items.tsx").addXml(r+"oryx_world2.tsx").addTexture(r+"../oryx_world2.png").addTexture(r+"../oryx_creatures.png").addTexture(r+"../oryx_items.png").addJson("prefabs.json").addTexture("lookingformore.png").load(function(){t.levels=n(234).levels,w.setPrefabs(p.Assets.json["assets/prefabs.json"]),RemoveLoadingBar(),t.begin()})}},{key:"debugText",value:function(e){e="object"===(void 0===e?"undefined":(0,f.default)(e))?o(e):e,t.getConsoleEl().innerText=""+e}},{key:"markLevelCompleted",value:function(t){v.SaveGame.markLevelCompleted(t)}},{key:"getNextLevelName",value:function(){return v.SaveGame.getNextLevelName()}},{key:"clearCompletedLevels",value:function(){return v.SaveGame.clearCompletedLevels()}},{key:"getConsoleEl",value:function(){var t=document.getElementById("debug_console");return t||(t=document.createElement("pre"),t.setAttribute("id","debug_console"),document.body.appendChild(t)),t}},{key:"getStartScene",value:function(){return new b.TitleScreen}},{key:"begin",value:function(){w.initPrefabs(),_.loadAutoSprites(),d.Engine.graphics.pixel=p.Assets.atlases.gfx.get("pixel"),d.Engine.goto(t.getStartScene(),!1)}},{key:"hasLevelsCompleted",get:function(){return v.SaveGame.hasLevelsCompleted}},{key:"EndScreen",get:function(){return new x.EndScreen}}]),t}();O.developer=!1,O.cheats={unlimitedAmmo:!1},O.TAGS={PLAYER:"player",SOLID:"solid"},O.KEYS={LEFT:"left",RIGHT:"right",UP:"up",DOWN:"down",A:"a",B:"b",SHOOT:"shoot",START:"start",SELECT:"select",BACK_TO_TITLE:"back_to_title",TELEPORT:"teleport",RESTART:"restart",PAUSE:"pause",FINISH_LEVEL:"finish_level",FAST_FORWARD:"fast_forward",DEBUG_NEXT_LEVEL:"debug_next_level",DEBUG_PREV_LEVEL:"debug_prev_level",DEBUG_OPEN_DOOR:"debug_open_door"},O.SOUNDS={},O.COLORS=[new m.Color(155/255,188/255,15/255,1),new m.Color(139/255,172/255,15/255,1),new m.Color(48/255,98/255,48/255,1),new m.Color(15/255,56/255,15/255,1)],O.transitionColor=new m.Color(0,.25,.05),O.levels=[],O.debugConsoleId="debug_console",e.Game=O},function(t,e,n){"use strict";function i(t){if(t.indexOf("_")!==t.lastIndexOf("_"))throw Error("only zero or one underscores permitted in name '"+t+"'");var e=t.split("_"),n=(0,c.default)(e,2);return[n[0],n[1]]}function r(t,e,n,r){var o=p[t];if(!o)throw Error("no prefab named "+t);e||(e=new f.Entity),void 0!==n&&(e.x=n),void 0!==r&&(e.y=r),void 0===e.name&&(e.name=t);var a=!0,s=!1,u=void 0;try{for(var l,d=Object.keys(o)[Symbol.iterator]();!(a=(l=d.next()).done);a=!0){var y=l.value,v=i(y),g=(0,c.default)(v,2),m=g[0],_=g[1],b=o[y],x=h.getComponentByName(m);if(!x)throw Error("no component named "+m+" found in template\n "+JSON.stringify(o,null,2));var w=new x(b);w.prefabLink=b,e.add(w),void 0!==_&&(e.componentByName[_]=w)}}catch(t){s=!0,u=t}finally{try{!a&&d.return&&d.return()}finally{if(s)throw u}}return e}function o(){return p}function a(t){p=t}function s(){function t(){}var e=window.LiveReload;e&&(t.identifier="Foo2",t.prototype.reload=function(t,e){return!!(y>0&&t.endsWith("prefabs.json"))&&(y-=1,!0)},e.addPlugin(t))}function u(){function t(t){if(t.status>=200&&t.status<300)return t;var e=Error(t.statusText);throw e.response=t,e}y=2,fetch("/prefabs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o())}).then(t).then(function(t){return t.text()}).then(function(t){d.Game.debugText("Saved prefabs at "+f.Engine.elapsed+": "+t)}).catch(function(t){})}var l=n(17),c=function(t){return t&&t.__esModule?t:{default:t}}(l);Object.defineProperty(e,"__esModule",{value:!0});var h=n(36),f=n(5),d=n(15);e.instantiatePrefab=r;var p={};e.getPrefabs=o,e.setPrefabs=a;var y=0;e.initPrefabs=s,e.sendPrefabsToServer=u,e.default=p},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var r=n(126),o=i(r),a=n(140),s=i(a);e.default=function(){function t(t,e){var n=[],i=!0,r=!1,o=void 0;try{for(var a,u=(0,s.default)(t);!(i=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{!i&&u.return&&u.return()}finally{if(r)throw o}}return n}return function(e,n){if(Array.isArray(e))return e;if((0,o.default)(Object(e)))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()},function(t,e){var n=t.exports={version:"2.4.0"};"number"==typeof __e&&(__e=n)},function(t,e,n){var i=n(66)("wks"),r=n(46),o=n(24).Symbol,a="function"==typeof o;(t.exports=function(t){return i[t]||(i[t]=a&&o[t]||(a?o:r)("Symbol."+t))}).store=i},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a);Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(e,n,i,r){(0,o.default)(this,t),this.color=[0,0,0,1],this.r=e||0,this.g=n||0,this.b=i||0,this.a=r||1}return(0,s.default)(t,[{key:"toString",value:function(){return"Color("+this.r+", "+this.g+", "+this.b+", "+this.a+")"}},{key:"set",value:function(t,e,n,i){return this.r=t,this.g=e,this.b=n,this.a=i,this}},{key:"copy",value:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a,this}},{key:"lerp",value:function(t,e,n){return this.r=t.r+(e.r-t.r)*n,this.g=t.g+(e.g-t.g)*n,this.b=t.b+(e.b-t.b)*n,this.a=t.a+(e.a-t.a)*n,this}},{key:"clone",value:function(){return(new t).copy(this)}},{key:"mult",value:function(t){return this.set(this.r,this.g,this.b,this.a*t)}},{key:"r",get:function(){return this.color[0]},set:function(t){this.color[0]=Math.min(1,Math.max(0,t))}},{key:"g",get:function(){return this.color[1]},set:function(t){this.color[1]=Math.min(1,Math.max(0,t))}},{key:"b",get:function(){return this.color[2]},set:function(t){this.color[2]=Math.min(1,Math.max(0,t))}},{key:"a",get:function(){return this.color[3]},set:function(t){this.color[3]=Math.min(1,Math.max(0,t))}},{key:"rgba",get:function(){return this.color}}],[{key:"fromHex",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return e=e.replace("#",""),new t(parseInt(3===e.length?e.slice(0,1).repeat(2):e.slice(0,2),16)/255,parseInt(3===e.length?e.slice(1,2).repeat(2):e.slice(2,4),16)/255,parseInt(3===e.length?e.slice(2,3).repeat(2):e.slice(4,6),16)/255,n)}}]),t}();u.white=new u(1,1,1,1),u.black=new u(0,0,0,1),u.red=new u(1,0,0,1),u.green=new u(0,1,0,1),u.blue=new u(0,0,1,1),u.temp=new u,e.Color=u},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(t instanceof d.Vector)t.copy(e);else{if(!(t instanceof f.Color))return!1;t.copy(e)}return!0}var o=n(17),a=i(o),s=n(4),u=(i(s),n(0)),l=i(u),c=n(1),h=i(c);Object.defineProperty(e,"__esModule",{value:!0}),n(11);var f=n(20),d=n(13),p=function(){function t(e){(0,l.default)(this,t),this._entity=null,this.scene=null,this.active=!0,this.visible=!0,this.position=new d.Vector(0,0),e&&void 0!==e.active&&(this.active=e.active)}return(0,h.default)(t,[{key:"toString",value:function(){return"<"+this.constructor.name+" of "+this.entity+">"}},{key:"setPrefabValues",value:function(t){if(this.prefabLink){var e=this.prefabLink,n=!0,i=!1,o=void 0;try{for(var s,u=Object.entries(t)[Symbol.iterator]();!(n=(s=u.next()).done);n=!0){var l=(0,a.default)(s.value,2),c=l[0],h=l[1];c in e&&(r(e[c],h)||(e[c]=h))}}catch(t){i=!0,o=t}finally{try{!n&&u.return&&u.return()}finally{if(i)throw o}}}var f=!0,d=!1,p=void 0;try{for(var y,v=Object.entries(t)[Symbol.iterator]();!(f=(y=v.next()).done);f=!0){var g=(0,a.default)(y.value,2),c=g[0],h=g[1];r(this[c],h)||(this[c]=h)}}catch(t){d=!0,p=t}finally{try{!f&&v.return&&v.return()}finally{if(d)throw p}}}},{key:"setActive",value:function(t){this.active=t}},{key:"getScenePosition",value:function(t){return t.set(this.sceneX,this.sceneY)}},{key:"addedToEntity",value:function(){}},{key:"addedToScene",value:function(){if(void 0!==this.siblings){var t=!0,e=!1,n=void 0;try{for(var i,r=Object.entries(this.siblings)[Symbol.iterator]();!(t=(i=r.next()).done);t=!0){var o=(0,a.default)(i.value,2),s=o[0],u=o[1],l=this.entity.find(u);if(!l)throw Error("@Component.require needs "+u.name+" but it is missing");this[s]=l}}catch(t){e=!0,n=t}finally{try{!t&&r.return&&r.return()}finally{if(e)throw n}}}}},{key:"removedFromEntity",value:function(){}},{key:"removedFromScene",value:function(){}},{key:"update",value:function(){}},{key:"lateUpdate",value:function(){}},{key:"render",value:function(t){}},{key:"debugRender",value:function(t){}},{key:"entity",get:function(){return this._entity},set:function(t){if(null!=this._entity&&null!=t)throw Error("This Component is already attached to an Entity");this._entity=t}},{key:"x",get:function(){return this.position.x},set:function(t){this.position.x=t}},{key:"y",get:function(){return this.position.y},set:function(t){this.position.y=t}},{key:"scenePosition",get:function(){return this.getScenePosition(new d.Vector)}},{key:"sceneX",get:function(){return(this._entity?this._entity.x:0)+this.position.x}},{key:"sceneY",get:function(){return(this._entity?this._entity.y:0)+this.position.y}}],[{key:"register",value:function(e){if(e.name in t.registeredComponents)throw Error("already a Component named "+e.name);t.registeredComponents[e.name]=e}},{key:"require",value:function(t,e){var n=Reflect.getMetadata("design:type",t,e);if(!n){var i="no design:type metadata found for key "+e;throw i+=" - is experimentalDecorators and emitDecoratorMetadata on in tsconfig.json?"}(t.siblings||(t.siblings={}))[e]=n}}]),t}();p.registeredComponents={},e.Component=p},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a);Object.defineProperty(e,"__esModule",{value:!0});var u=n(13),l=new u.Vector,c=function(){function t(e,n,i,r){(0,o.default)(this,t),this.x=e||0,this.y=n||0,this.width=i||1,this.height=r||1}return(0,s.default)(t,[{key:"getCenter",value:function(t){return t.set(this.centerX,this.centerY),t}},{key:"corners",value:function(){return[new u.Vector(this.x,this.y),new u.Vector(this.x+this.width,this.y),new u.Vector(this.x,this.y+this.height),new u.Vector(this.x+this.width,this.y+this.height)]}},{key:"toString",value:function(){return"<Rectangle "+this.x+", "+this.y+", "+this.width+", "+this.height+">"}},{key:"set",value:function(t,e,n,i){return this.x=t,this.y=e,this.width=n,this.height=i,this}},{key:"containsPoint",value:function(t){return this.x<=t.x&&this.right>t.x&&this.y<=t.y&&this.bottom>t.y}},{key:"overlapsVertically",value:function(t){return t.top>this.top&&t.top<this.bottom||t.bottom>this.top&&t.bottom<this.bottom}},{key:"overlapsHorizontally",value:function(t){return t.left>this.left&&t.left<this.right||t.right>this.left&&t.right<this.right}},{key:"expand",value:function(t,e){this.x-=t/2,this.width+=2*t,this.y-=e/2,this.height+=2*e}},{key:"intersectsRect",value:function(t){var e=l;return this.containsPoint(e.set(t.x,t.y))||this.containsPoint(e.set(t.x+t.width,t.y))||this.containsPoint(e.set(t.x,t.y+t.height))||this.containsPoint(e.set(t.x+t.width,t.y+t.height))}},{key:"cropRect",value:function(t){return t.x<this.x&&(t.width+=t.x-this.x,t.x=this.x),t.y<this.x&&(t.height+=t.y-this.y,t.y=this.y),t.x>this.right&&(t.x=this.right,t.width=0),t.y>this.bottom&&(t.y=this.bottom,t.height=0),t.right>this.right&&(t.width=this.right-t.x),t.bottom>this.bottom&&(t.height=this.bottom-t.y),t}},{key:"crop",value:function(e,n,i,r,o){return void 0===o&&(o=new t),o.set(e,n,i,r),this.cropRect(o),o}},{key:"clone",value:function(){return(new t).copy(this)}},{key:"copy",value:function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}},{key:"left",get:function(){return this.x},set:function(t){var e=this.x+this.width;this.x=t,this.width=e-this.x}},{key:"right",get:function(){return this.x+this.width},set:function(t){this.width=t-this.x}},{key:"top",get:function(){return this.y},set:function(t){var e=this.y+this.height;this.y=t,this.height=e-this.y}},{key:"bottom",get:function(){return this.y+this.height},set:function(t){this.height=t-this.y}},{key:"centerX",get:function(){return this.x+this.width/2}},{key:"centerY",get:function(){return this.y+this.height/2}}]),t}();c.temp0=new c,c.temp1=new c,c.temp2=new c,e.Rectangle=c},function(t,e,n){var i=n(131),r=n(59);t.exports=function(t){return i(r(t))}},function(t,e){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(t,e,n){var i=n(28),r=n(81),o=n(62),a=Object.defineProperty;e.f=n(29)?Object.defineProperty:function(t,e,n){if(i(t),e=o(e,!0),i(n),r)try{return a(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},function(t,e,n){"use strict";function i(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),i(n(181)),i(n(182)),i(n(75))},function(t,e,n){var i=n(24),r=n(18),o=n(61),a=n(33),s=function(t,e,n){var u,l,c,h=t&s.F,f=t&s.G,d=t&s.S,p=t&s.P,y=t&s.B,v=t&s.W,g=f?r:r[e]||(r[e]={}),m=g.prototype,_=f?i:d?i[e]:(i[e]||{}).prototype;f&&(n=e);for(u in n)(l=!h&&_&&void 0!==_[u])&&u in g||(c=l?_[u]:n[u],g[u]=f&&"function"!=typeof _[u]?n[u]:y&&l?o(c,i):v&&_[u]==c?function(t){var e=function(e,n,i){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,n)}return new t(e,n,i)}return t.apply(this,arguments)};return e.prototype=t.prototype,e}(c):p&&"function"==typeof c?o(Function.call,c):c,p&&((g.virtual||(g.virtual={}))[u]=c,t&s.R&&m&&!m[u]&&a(m,u,c)))};s.F=1,s.G=2,s.S=4,s.P=8,s.B=16,s.W=32,s.U=64,s.R=128,t.exports=s},function(t,e,n){var i=n(37);t.exports=function(t){if(!i(t))throw TypeError(t+" is not an object!");return t}},function(t,e,n){t.exports=!n(38)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a),u=n(2),l=i(u),c=n(6),h=i(c),f=n(3),d=i(f);Object.defineProperty(e,"__esModule",{value:!0});var p=n(5),y=n(12),v=n(119),g=n(26),m=n(36),_=n(15),b=n(41),x=n(14),w=n(16),k=function(t){function e(){(0,o.default)(this,e);var t=(0,l.default)(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.killed=!1,w.instantiatePrefab("player",t),t.group("player"),t.physics=t.find(x.Physics),t.find(m.Health).onDie.push(function(){t.find(m.TopDownControls).movingEnabled=!1,t.find(m.FreezingShot).active=!1,t._untagHack()}),t.shadow=t.find(v.Shadow),t}return(0,d.default)(e,t),(0,s.default)(e,[{key:"update",value:function(){(0,h.default)(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),g.Keyboard.pressed(_.Game.KEYS.RESTART)&&(this.killed?this.level&&this.level.reloadLevel(!1):this.kill()),this.physics&&this.shadow&&this.shadow.graphic&&(this.shadow.graphic.visible=!this.physics.check("solid",0,3))}},{key:"kill",value:function(){this.killed||(this.killed=!0,this.find(m.Health).kill())}},{key:"_untagHack",value:function(){this.ungroup("player"),this.findAll(y.Collider).forEach(function(t){return t.untag("player")})}},{key:"level",get:function(){return this.scene instanceof b.Level?this.scene:null}}]),e}(p.Entity);e.Player=k},function(t,e){t.exports={}},function(t,e,n){var i=n(25),r=n(39);t.exports=n(29)?function(t,e,n){return i.f(t,e,r(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e,n){"use strict";e.__esModule=!0;var i=n(163),r=function(t){return t&&t.__esModule?t:{default:t}}(i);e.default=function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return(0,r.default)(t)}},function(t,e,n){"use strict";function i(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),i(n(185)),i(n(48))},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}function o(t){if(!t)throw Error("must pass a non-empty non-null name to getComponentByName");var e=b.Component.registeredComponents[t];if(e)return e}var a=n(0),s=i(a),u=n(1),l=i(u),c=n(2),h=i(c),f=n(6),d=i(f),p=n(3),y=i(p),v=n(4),g=i(v),m=function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===("undefined"==typeof Reflect?"undefined":(0,g.default)(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},_=function(t,e){if("object"===("undefined"==typeof Reflect?"undefined":(0,g.default)(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0}),r(n(111)),r(n(202)),r(n(112)),r(n(115)),r(n(56)),r(n(204)),r(n(205)),r(n(206)),r(n(116)),r(n(207)),r(n(117)),r(n(208)),r(n(118)),r(n(43)),r(n(209)),r(n(55)),r(n(210)),r(n(77)),r(n(211)),r(n(212)),r(n(120)),r(n(213)),r(n(119)),r(n(214)),r(n(215)),r(n(216)),r(n(79)),r(n(217)),r(n(78)),r(n(218)),r(n(219)),r(n(225)),r(n(124)),n(11);var b=n(5),x=n(14),w=n(12),k=n(42),O=n(9),S=n(120),E=n(78),T=n(124),P=n(16),RenderDepth=function(t){function RenderDepth(t){var e=t.depth;(0,s.default)(this,RenderDepth);var n=(0,h.default)(this,(RenderDepth.__proto__||Object.getPrototypeOf(RenderDepth)).call(this));return n.depth=e,n}return(0,y.default)(RenderDepth,t),(0,l.default)(RenderDepth,[{key:"addedToScene",value:function(){(0,d.default)(RenderDepth.prototype.__proto__||Object.getPrototypeOf(RenderDepth.prototype),"addedToScene",this).call(this),void 0===this.depth||isNaN(this.depth)||(this.entity.depth=this.depth)}}]),RenderDepth}(b.Component);RenderDepth=m([b.Component.register,_("design:paramtypes",[Object])],RenderDepth),e.RenderDepth=RenderDepth;var Blockize=function(t){function Blockize(){return(0,s.default)(this,Blockize),(0,h.default)(this,(Blockize.__proto__||Object.getPrototypeOf(Blockize)).apply(this,arguments))}return(0,y.default)(Blockize,t),(0,l.default)(Blockize,[{key:"update",value:function(){this.physics.check("player")&&(this.sprite.play("blockize"),this.physics.stop(),this.wonder.active=!1)}}]),Blockize}(b.Component);m([b.Component.require,_("design:type",x.Physics)],Blockize.prototype,"physics",void 0),m([b.Component.require,_("design:type",O.Sprite)],Blockize.prototype,"sprite",void 0),m([b.Component.require,_("design:type",T.Wonder)],Blockize.prototype,"wonder",void 0),Blockize=m([b.Component.register],Blockize);var HeartPickup=function(t){function HeartPickup(t){(0,s.default)(this,HeartPickup);var e=(0,h.default)(this,(HeartPickup.__proto__||Object.getPrototypeOf(HeartPickup)).call(this,t));return e.type=t.type,e}return(0,y.default)(HeartPickup,t),(0,l.default)(HeartPickup,[{key:"didPickup",value:function(t){(0,d.default)(HeartPickup.prototype.__proto__||Object.getPrototypeOf(HeartPickup.prototype),"didPickup",this).call(this,t);var e=t.find(E.FreezingShot);e&&e.didPickupHeart(this),this.level&&this.level.events.triggerSingleHeartCollected()}}]),HeartPickup}(S.Pickup);HeartPickup=m([b.Component.register,_("design:paramtypes",[Object])],HeartPickup),e.HeartPickup=HeartPickup;var DiesOnCollision=function(t){function DiesOnCollision(t){(0,s.default)(this,DiesOnCollision);var e=(0,h.default)(this,(DiesOnCollision.__proto__||Object.getPrototypeOf(DiesOnCollision)).call(this));return e.done=!1,e.opts=t,e}return(0,y.default)(DiesOnCollision,t),(0,l.default)(DiesOnCollision,[{key:"addedToScene",value:function(){var t=this;(0,d.default)(DiesOnCollision.prototype.__proto__||Object.getPrototypeOf(DiesOnCollision.prototype),"addedToScene",this).call(this),this.physics.onCollide.push(function(e,n){t.done||(t.done=!0,t.opts.particlesPrefab&&t.scene.add(P.instantiatePrefab(t.opts.particlesPrefab,null,t.physics.sceneCenterX,t.physics.sceneCenterY)),x.Alarm.create(t.entity).start(.01,function(){t.entity.scene.remove(t.entity),t.active=!1}))})}}]),DiesOnCollision}(b.Component);m([b.Component.require,_("design:type",x.Physics)],DiesOnCollision.prototype,"physics",void 0),DiesOnCollision=m([b.Component.register,_("design:paramtypes",[Object])],DiesOnCollision),e.DiesOnCollision=DiesOnCollision;var MapLocation=function(t){function MapLocation(t){var e=t.name;(0,s.default)(this,MapLocation);var n=(0,h.default)(this,(MapLocation.__proto__||Object.getPrototypeOf(MapLocation)).call(this));return n.name=e,n}return(0,y.default)(MapLocation,t),MapLocation}(b.Component);MapLocation=m([b.Component.register,_("design:paramtypes",[Object])],MapLocation),e.MapLocation=MapLocation;var Rotater=function(t){function Rotater(){(0,s.default)(this,Rotater);var t=(0,h.default)(this,(Rotater.__proto__||Object.getPrototypeOf(Rotater)).apply(this,arguments));return t.degrees=0,t.speed=2,t}return(0,y.default)(Rotater,t),(0,l.default)(Rotater,[{key:"update",value:function(){(0,d.default)(Rotater.prototype.__proto__||Object.getPrototypeOf(Rotater.prototype),"update",this).call(this),this.degrees+=b.Engine.delta*this.speed,this.graphic.rotation=this.degrees}}]),Rotater}(b.Component);m([b.Component.require,_("design:type",O.Graphic)],Rotater.prototype,"graphic",void 0),Rotater=m([b.Component.register],Rotater);for(var C=[w.Hitbox,x.Physics,O.Sprite,k.ParticleSystem],R=0;R<C.length;R++){var j=C[R];b.Component.register(j)}e.getComponentByName=o},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(34),o=i(r),a=n(0),s=i(a),u=n(1),l=i(u),c=n(2),h=i(c),f=n(3),d=i(f);Object.defineProperty(e,"__esModule",{value:!0});var p=n(21),Collider=function(t){function Collider(){(0,s.default)(this,Collider);var t=(0,h.default)(this,(Collider.__proto__||Object.getPrototypeOf(Collider)).apply(this,arguments));return t.tags=[],t}return(0,d.default)(Collider,t),(0,l.default)(Collider,[{key:"tag",value:function(t){this.tags.push(t),null!=this.entity&&null!=this.entity.scene&&this.entity.scene._trackCollider(this,t)}},{key:"untag",value:function(t){var e=this.tags.indexOf(t);e>=0&&(this.tags.splice(e,1),null!=this.entity&&null!=this.entity.scene&&this.entity.scene._untrackCollider(this,t))}},{key:"check",value:function(t,e,n){return null!=this.collide(t,e,n)}},{key:"checks",value:function(t,e,n){var i=!0,r=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var u=a.value;if(null!=this.collide(u,e,n))return!0}}catch(t){r=!0,o=t}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}return!1}},{key:"collide",value:function(t,e,n){var i=null,r=this.entity.scene.allCollidersInTag(t);this.x+=e||0,this.y+=n||0;var o=!0,a=!1,s=void 0;try{for(var u,l=r[Symbol.iterator]();!(o=(u=l.next()).done);o=!0){var c=u.value;if(c.active&&Collider.overlap(this,c)){i=c;break}}}catch(t){a=!0,s=t}finally{try{!o&&l.return&&l.return()}finally{if(a)throw s}}return this.x-=e||0,this.y-=n||0,i}},{key:"collides",value:function(t,e,n){var i=!0,r=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var u=a.value,l=this.collide(u,e,n);if(null!=l)return l}}catch(t){r=!0,o=t}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}return null}},{key:"collideAll",value:function(t,e,n){return this.collideAllMulti([t],e,n)}},{key:"collideAllMulti",value:function(t,e,n){var i=[],r=!0,a=!1,s=void 0;try{for(var u,l=t[Symbol.iterator]();!(r=(u=l.next()).done);r=!0){var c=u.value;i.push.apply(i,(0,o.default)(this.entity.scene.allCollidersInTag(c)))}}catch(t){a=!0,s=t}finally{try{!r&&l.return&&l.return()}finally{if(a)throw s}}var h=[];this.x+=e||0,this.y+=n||0;var f=!0,d=!1,p=void 0;try{for(var y,v=i[Symbol.iterator]();!(f=(y=v.next()).done);f=!0){var g=y.value;g.active&&Collider.overlap(this,g)&&h.push(g)}}catch(t){d=!0,p=t}finally{try{!f&&v.return&&v.return()}finally{if(d)throw p}}return this.x-=e||0,this.y-=n||0,h}}],[{key:"registerOverlapTest",value:function(t,e,n){void 0===Collider.overlaptest[t.name]&&(Collider.overlaptest[t.name]={}),void 0===Collider.overlaptest[e.name]&&(Collider.overlaptest[e.name]={}),Collider.overlaptest[t.name][e.name]=function(t,e){return n(t,e)},Collider.overlaptest[e.name][t.name]=function(t,e){return n(e,t)}}},{key:"overlap",value:function(t,e){return Collider.overlaptest[t.type][e.type](t,e)}}]),Collider}(p.Component);Collider.overlaptest={},e.Collider=Collider},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){var n=t.getAttribute(e);return parseInt(n,10)}function o(t,e){switch(e){case"int":return parseInt(t,10);case"float":return parseFloat(t);case"bool":return""+t=="true";case"string":default:return""+t}}function a(t){return parseInt(t,10)}function s(t,e){var n=!0,i=!1,r=void 0;try{for(var o,s=Object.entries(t.tileproperties)[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var u=(0,d.default)(o.value,2),l=u[0],c=u[1].shadow;void 0!==c&&(e[c]=t.tilemap.getTileSubtexture(a(l)))}}catch(t){i=!0,r=t}finally{try{!n&&s.return&&s.return()}finally{if(i)throw r}}}function u(t){var e={},n=!0,i=!1,r=void 0;try{for(var o,s=Object.entries(t.tileproperties)[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var u=(0,d.default)(o.value,2),l=u[0],c=u[1],h=c.anim_name,f=c.anim_frame,p=c.anim_speed,y=c.anim_track,v=c.anim_goto;if(h){var g=a(l),m=y||"main",_=e[h]||(e[h]={});void 0===_[m]&&(_[m]={frames:[],speed:2.2,gotoFrames:null});var b=_[m].frames,x=t.tilemap.getTileSubtexture(g);void 0===f?b.push(x):b.splice(f,0,x),void 0!==p&&(_.speed=p),void 0!==v&&(_[m].gotoFrames=[""+v])}}}catch(t){i=!0,r=t}finally{try{!n&&s.return&&s.return()}finally{if(i)throw r}}var w=!0,k=!1,O=void 0;try{for(var S,E=Object.entries(e)[Symbol.iterator]();!(w=(S=E.next()).done);w=!0){var T=(0,d.default)(S.value,2),P=T[0],C=T[1],R=A.SpriteBank.create(P),j=!0,M=!1,L=void 0;try{for(var F,B=Object.entries(C)[Symbol.iterator]();!(j=(F=B.next()).done);j=!0){var D=(0,d.default)(F.value,2),G=D[0],U=D[1],N=U.speed,I=U.frames,V=U.gotoFrames,X=R.add(G,N,I,!0);if(V){var Y=X.get(G);Y.goto=V,Y.loops=!1}}}catch(t){M=!0,L=t}finally{try{!j&&B.return&&B.return()}finally{if(M)throw L}}}}catch(t){k=!0,O=t}finally{try{!w&&E.return&&E.return()}finally{if(k)throw O}}}function l(t){var e,n,i,r,o,a,s,u;return h.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:e=0,n=0,i=!0,r=!1,o=void 0,l.prev=5,a=t.data[Symbol.iterator]();case 7:if(i=(s=a.next()).done){l.next=15;break}return u=s.value,l.next=11,{tile:u,mapX:e,mapY:n};case 11:++e>=t.width&&(e=0,n++);case 12:i=!0,l.next=7;break;case 15:l.next=21;break;case 17:l.prev=17,l.t0=l.catch(5),r=!0,o=l.t0;case 21:l.prev=21,l.prev=22,!i&&a.return&&a.return();case 24:if(l.prev=24,!r){l.next=27;break}throw o;case 27:return l.finish(24);case 28:return l.finish(21);case 29:case"end":return l.stop()}},E[0],this,[[5,17,21,29],[22,,24,28]])}var c=n(52),h=i(c),f=n(17),d=i(f),p=n(6),y=i(p),v=n(0),g=i(v),m=n(1),_=i(m),b=n(2),x=i(b),w=n(3),k=i(w),O=n(4),S=i(O),E=[l].map(h.default.mark),T=function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===("undefined"==typeof Reflect?"undefined":(0,S.default)(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(e,"__esModule",{value:!0});var P=n(5),C=n(14),R=n(105),j=n(102),M=n(35),A=n(54),L=n(12),F=n(9),B=n(26),D=n(103),G=n(7),U=n(201),N=n(36),I=n(226),V=n(44),X=n(15),Y=n(31),H=n(227),W=n(16),K=["terrain","shadows","corners","water","water_corners"],WobblyShaderParams=function(t){function WobblyShaderParams(){return(0,g.default)(this,WobblyShaderParams),(0,x.default)(this,(WobblyShaderParams.__proto__||Object.getPrototypeOf(WobblyShaderParams)).apply(this,arguments))}return(0,k.default)(WobblyShaderParams,t),(0,_.default)(WobblyShaderParams,[{key:"update",value:function(){this.tilemap.color.r=(Math.sin(P.Engine.elapsed)+1)/2+.5,this.tilemap.color.g=(Math.cos(P.Engine.elapsed)+1)/2}}]),WobblyShaderParams}(P.Component);T([P.Component.require,function(t,e){if("object"===("undefined"==typeof Reflect?"undefined":(0,S.default)(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:type",F.Tilemap)],WobblyShaderParams.prototype,"tilemap",void 0),WobblyShaderParams=T([P.Component.register],WobblyShaderParams);var z=n(228),q=function(t){function e(t){(0,g.default)(this,e);var n=(0,x.default)(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.sortOrder=1,n.groupsMask.push(t),n.shader=e.shader,n.shaderCameraUniformName="matrix",n}return(0,k.default)(e,t),(0,_.default)(e,null,[{key:"shader",get:function(){return e._shader||(e._shader=z()),e._shader}}]),(0,_.default)(e,[{key:"render",value:function(){return this.shader.set("time",P.Engine.elapsed),(0,y.default)(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"render",this).call(this)}}]),e}(D.Renderer),J=function(t){function e(t,n){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];(0,g.default)(this,e);var r=(0,x.default)(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,i));return r._shadows={},r.events=new N.GameEventsEmitter,r.reloading=!1,r.scene=t,r.entrance=n,r.renderers.at(0).groupsMask.push("sprite"),r.bgTarget=R.RenderTarget.create(24,24),r.bgRenderer=new j.SpriteRenderer,r.bgRenderer.groupsMask=["bg"],r.bgRenderer.target=r.bgTarget,r.addRenderer(r.bgRenderer),r.addRenderer(new q("water")),r}return(0,k.default)(e,t),(0,_.default)(e,[{key:"getShadow",value:function(t){return this._shadows[t]}},{key:"loadTiledXML",value:function(t){for(var e=[],n=[],i=0;i<t.childElementCount;++i){var o=t.children[i];if("layer"===o.nodeName){var a=o.children[0],s=[],u=a.textContent.split(","),l=!0,c=!1,h=void 0;try{for(var f,d=u[Symbol.iterator]();!(l=(f=d.next()).done);l=!0){var p=f.value;s.push(parseInt(p,10))}}catch(t){c=!0,h=t}finally{try{!l&&d.return&&d.return()}finally{if(c)throw h}}e.push({width:r(o,"width"),height:r(o,"height"),name:o.getAttribute("name"),type:"tilelayer",data:s,objects:[],x:0,y:0})}else{if("tileset"!==o.nodeName)throw Error(o.nodeName);var y=o.getAttribute("source");!y||y.length,n.push({firstgid:r(o,"firstgid"),source:o.getAttribute("source")})}}return{tilewidth:r(t,"tilewidth"),tileheight:r(t,"tileheight"),width:r(t,"width"),height:r(t,"height"),type:t.nodeName,tilesets:n,layers:e}}},{key:"loadTiled",value:function(t,e,n,i){function r(t){var e=!0,n=!1,i=void 0;try{for(var r,o=f[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var a=r.value;if(t>=a.firstGid&&t<a.lastGid)return a}}catch(t){n=!0,i=t}finally{try{!e&&o.return&&o.return()}finally{if(n)throw i}}}function a(t){if(t<1)return null;var e=r(t);if(!e)return null;var n=t-e.firstGid;return(null!=e.tileproperties?e.tileproperties[n]:void 0)||null}var c=t+e,h=void 0;if(e.endsWith("json")?h=M.Assets.json[c]:e.endsWith("tmx")&&(h=this.loadTiledXML(M.Assets.xml[c].documentElement)),!h)throw Error("no level at "+(t+e));var f=[],p=!0,y=!1,v=void 0;try{for(var g,m=h.tilesets[Symbol.iterator]();!(p=(g=m.next()).done);p=!0){var _=g.value,b=_.firstgid;if(void 0!==_.source)!function(){for(var e=function(t){if(null==t)throw Error("got null");var e=parseInt(t,10);if(isNaN(e))throw Error("expected a number, got "+t);return e},n=t+_.source,i=M.Assets.xml[n],r=i.documentElement,a=function(t){return e(r.getAttribute(t))},s=(a("columns"),a("tilewidth")),u=a("tileheight"),l=b+a("tilecount"),c=-1,h="",d=-1,p={},y=0;y<r.children.length;++y){var v=r.children[y];switch(v.nodeName){case"image":c=e(v.getAttribute("width")),e(v.getAttribute("height")),v.getAttribute("trans"),h=v.getAttribute("source"),d=Math.floor(c/s);break;case"tileoffset":var g=e(v.getAttribute("x")),m=e(v.getAttribute("y"));new G.Vector(g,m);break;case"tile":var x=e(v.getAttribute("id")),w=v.getAttribute("type");w&&(p[x]={type:w});for(var k=0;k<v.children.length;++k){var O=v.children[k];switch(O.nodeName){case"properties":for(var S=p[x]||(p[x]={}),E=0;E<O.children.length;++E){var T=O.children[E],P=T.getAttribute("name");if(null==P)throw Error("null name");var C=T.getAttribute("value");if(null==C)throw Error("expected non-null at value");var R=T.getAttribute("type");S[P]=o(C,R)}break;default:throw Error("unknown <tile/> child "+O.nodeName)}}break;default:throw Error("unknown node name "+v.nodeName)}}var j={firstGid:b,lastGid:l,tilewidth:s,tileheight:u,tilesPerRow:d,image:h,tileproperties:p,tilemap:null};f.push(j)}();else{var x=b+function(t,e){var n=t[e],i=void 0===n?"undefined":(0,S.default)(n);if("number"!==i)throw Error("expected "+e+" to be a number, got "+i);if(isNaN(n))throw Error("expected "+e+" to be a number, got NaN");return n}(_,"tilecount"),w={firstGid:b,lastGid:x,tilewidth:_.tilewidth,tileheight:_.tileheight,tilesPerRow:Math.floor(_.imagewidth/_.tilewidth),tileproperties:_.tileproperties,image:_.image,tilemap:null};f.push(w)}}}catch(t){y=!0,v=t}finally{try{!p&&m.return&&m.return()}finally{if(y)throw v}}var k=new L.Hitgrid(h.tilewidth,h.tileheight,[X.Game.TAGS.SOLID]);n.add(k);var O=void 0;O=new L.Hitgrid(h.tilewidth,h.tileheight,["water"]),i.add(O);var E={},T=!0,C=!1,R=void 0;try{for(var j,A=f[Symbol.iterator]();!(T=(j=A.next()).done);T=!0){var B=j.value,D=t+B.image,U=M.Assets.textures[D],V=new F.Tilemap(U,B.tilewidth,B.tileheight);B.tilemap=V,u(B),s(B,this._shadows);var Y=!0,H=!1,z=void 0;try{for(var q,J=Object.entries(B.tileproperties)[Symbol.iterator]();!(Y=(q=J.next()).done);Y=!0){var $=(0,d.default)(q.value,2),Q=$[0],Z=$[1];Z&&(E[parseInt(Q,10)+B.firstGid]=Z.solid)}}catch(t){H=!0,z=t}finally{try{!Y&&J.return&&J.return()}finally{if(H)throw z}}}}catch(t){C=!0,R=t}finally{try{!T&&A.return&&A.return()}finally{if(C)throw R}}var tt=[],et=-1,nt=!0,it=!1,rt=void 0;try{for(var ot,at=h.layers[Symbol.iterator]();!(nt=(ot=at.next()).done);nt=!0){var st=ot.value;if(et+=1,"objects"===st.name){var ut=!0,lt=!1,ct=void 0;try{for(var ht,ft=l(st)[Symbol.iterator]();!(ut=(ht=ft.next()).done);ut=!0){var dt=ht.value,pt=dt.mapX,yt=dt.mapY,vt=dt.tile,gt=a(vt);if(gt)if(gt.pushable){var mt=void 0,_t=r(vt);_t&&_t.tilemap&&(this.add(mt=new P.Entity(pt*_t.tilewidth,yt*_t.tileheight)),mt.depth=-10,mt.add(new F.Graphic(_t.tilemap.getTileSubtexture(vt-_t.firstGid))),W.instantiatePrefab("pushableBlock",mt))}else if(gt.type){var bt=r(vt),xt=0,wt=0;bt&&(xt=.5*(h.tilewidth-bt.tilewidth),wt=.5*(h.tileheight-bt.tileheight));var kt=pt*h.tilewidth+xt,Ot=yt*h.tileheight+wt,St=W.instantiatePrefab(gt.type,void 0,kt,Ot);bt&&bt.tilemap&&!St.find(F.Graphic)&&!St.find(N.MapLocation)&&St.add(gt.anim_name?new F.Sprite({animation:gt.anim_name}):new F.Graphic(bt.tilemap.getTileSubtexture(vt-bt.firstGid))),this.add(St)}}}catch(t){lt=!0,ct=t}finally{try{!ut&&ft.return&&ft.return()}finally{if(lt)throw ct}}}else if(-1!==K.indexOf(st.name)){var Et=!0,Tt=!1,Pt=void 0;try{for(var Ct,Rt=l(st)[Symbol.iterator]();!(Et=(Ct=Rt.next()).done);Et=!0){var jt=Ct.value,pt=jt.mapX,yt=jt.mapY,vt=jt.tile;if(0!==vt){"terrain"===st.name&&E[vt]?k.set(!0,pt,yt):"water"===st.name&&O.set(!0,pt,yt);var Mt=r(vt);if(!Mt)throw Error("couldn't find a tilesetInfo for tile "+vt+" at ("+pt+", "+yt+") in layer "+st.name);var At=vt-Mt.firstGid,Lt=Math.floor(At/Mt.tilesPerRow),Ft=Math.floor(At%Mt.tilesPerRow);if(void 0===tt[et]&&Mt.tilemap){var Bt=tt[et]=new F.Tilemap(Mt.tilemap.texture,Mt.tilemap.tileWidth,Mt.tilemap.tileHeight),Dt=st.name.startsWith("water")?i:n;Dt.add(Bt)}tt[et].set(Ft,Lt,pt,yt)}}}catch(t){Tt=!0,Pt=t}finally{try{!Et&&Rt.return&&Rt.return()}finally{if(Tt)throw Pt}}"water"===st.name&&tt[et].entity.add(new N.WaterFlow({tilemap:tt[et],hitgrid:O}))}else if("entities"===st.name){var Gt=!0,Ut=!1,Nt=void 0;try{for(var It,Vt=st.objects[Symbol.iterator]();!(Gt=(It=Vt.next()).done);Gt=!0){var Xt=It.value;if("door"===Xt.type){var Yt=Xt.name,Ht=Yt===this.entrance;this.add(new I.Door(Yt,Xt.gotoScene||"",Xt.gotoDoor||"",Ht),new G.Vector(parseInt(Xt.x,10),parseInt(Xt.y,10)))}else if("teleport"===Xt.type){var Wt=new P.Entity(Xt.x,Xt.y);Wt.add(new N.Teleport(Xt.name)),this.add(Wt),Wt.group("teleports")}else{var Kt=new P.Entity(Xt.x,Xt.y);Kt.depth=-2e3;var zt=void 0,qt=Xt.gid;if("number"==typeof qt&&qt>=1){var Z=a(qt),Jt=r(qt);Z&&Z.type&&(zt=Z.type),Jt&&Jt.tilemap&&Kt.add(new F.Graphic(Jt.tilemap.getTileSubtexture(qt-Jt.firstGid)))}else zt=Xt.type;zt&&W.instantiatePrefab(zt,Kt),Kt.components.count>0&&this.add(Kt)}}}catch(t){Ut=!0,Nt=t}finally{try{!Gt&&Vt.return&&Vt.return()}finally{if(Ut)throw Nt}}}else if("solids"===st.name){var $t=!0,Qt=!1,Zt=void 0;try{for(var te,ee=l(st)[Symbol.iterator]();!($t=(te=ee.next()).done);$t=!0){var ne=te.value,pt=ne.mapX,yt=ne.mapY,vt=ne.tile;0!==vt&&k.set(!0,pt,yt)}}catch(t){Qt=!0,Zt=t}finally{try{!$t&&ee.return&&ee.return()}finally{if(Qt)throw Zt}}}}}catch(t){it=!0,rt=t}finally{try{!nt&&at.return&&at.return()}finally{if(it)throw rt}}}},{key:"loadOgmo",value:function(t,e){var n=M.Assets.json[t],i=!0,r=!1,o=void 0;try{for(var a,s=n.layers[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var u=a.value;if("terrain"===u.name){var l=new F.Tilemap(M.Assets.atlases.gfx.get("tilemap"),8,8);e.add(l);for(var c=u.data.split("\n"),h=0;h<c.length;h++)for(var f=0,d=c[h].split(","),p=0;p<d.length-1;p++)if("-1"!==d[p]){var y=d[p],v=d[p+1];l.set(parseInt(y,10),parseInt(v,10),f,h),f++,p++}else f++}else if("solids"===u.name){var g=new L.Hitgrid(8,8,[X.Game.TAGS.SOLID]);e.add(g);for(var m=u.data.split("\n"),_=0;_<m.length;_++)for(var b=0;b<m[_].length;b++)"1"===m[_][b]&&g.set(!0,b,_)}else if("bgclouds"===u.name){var x=!0,w=!1,k=void 0;try{for(var O,S=u.entities[Symbol.iterator]();!(x=(O=S.next()).done);x=!0){var E=O.value,T=E.index,P=E.x,C=E.y;this.add(new U.Clouds(T,10),new G.Vector(P,C))}}catch(t){w=!0,k=t}finally{try{!x&&S.return&&S.return()}finally{if(w)throw k}}}else if("fgclouds"===u.name){var R=!0,j=!1,A=void 0;try{for(var B,D=u.entities[Symbol.iterator]();!(R=(B=D.next()).done);R=!0){var N=B.value,T=N.index,V=N.x,Y=N.y;this.add(new U.Clouds(T,-10),new G.Vector(V,Y))}}catch(t){j=!0,A=t}finally{try{!R&&D.return&&D.return()}finally{if(j)throw A}}}else if("entities"===u.name){var H=!0,W=!1,K=void 0;try{for(var z,q=u.entities[Symbol.iterator]();!(H=(z=q.next()).done);H=!0){var J=z.value;"door"===J.name&&this.add(new I.Door(J.doorName,J.gotoScene,J.gotoDoor,J.doorName===this.entrance),new G.Vector(parseInt(J.x,10),parseInt(J.y,10)))}}catch(t){W=!0,K=t}finally{try{!H&&q.return&&q.return()}finally{if(W)throw K}}}}}catch(t){r=!0,o=t}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}}},{key:"begin",value:function(){var t=this;(0,y.default)(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"begin",this).call(this),this.loaded=!1,new M.AssetLoader("assets").addXml(this.mapPath).load(function(){t.loaded=!0,t.afterLoad()})}},{key:"afterLoad",value:function(){this.camera.origin.set(P.Engine.width/2,P.Engine.height/2),this.camera.position.set(P.Engine.width/2,P.Engine.height/2),this.add(new H.Hud);var t=this.terrain=this.add(new P.Entity);t.name="terrain",t.depth=100,this.loadTiled("assets/fantasy/TMX/",this.scene+".tmx",t,t);var e=this.add(new P.Entity);e.name="events",e.add(this.events);var n=this.getMapLocationByName("player_spawn");n&&this.add(new Y.Player,n.getScenePosition(G.Vector.temp0).add(G.Vector.temp3.set(0,-8))),this.markLevel()}},{key:"getMapLocationByName",value:function(t){return!(arguments.length>1&&void 0!==arguments[1])||arguments[1],this.findAllComponents(N.MapLocation).find(function(e){return e.name===t})}},{key:"checkDevKeys",value:function(){if(B.Keyboard.pressed(B.Key.one)&&(this.terrain.visible=!this.terrain.visible),B.Keyboard.pressed(X.Game.KEYS.DEBUG_OPEN_DOOR)&&N.GameEventsEmitter.callAll(this.events.onTreasureCollected),B.Keyboard.pressed(X.Game.KEYS.DEBUG_NEXT_LEVEL))this.nextLevel(!1,!0);else{if(!B.Keyboard.pressed(X.Game.KEYS.DEBUG_PREV_LEVEL))return!0;this.prevLevel(!1,!0)}return!1}},{key:"update",value:function(){var t=this;if((0,y.default)(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),(!X.Game.developer||this.checkDevKeys())&&this.loaded){if(B.Keyboard.pressed(X.Game.KEYS.BACK_TO_TITLE))return void this.transitionToTitle();this.dust&&this.dust.burst(this.camera.position.x+P.Engine.width,this.camera.position.y-P.Engine.height+Math.random()*P.Engine.height*2,0),0!==this.allCollidersInTag("player").length||this.reloading||(this.reloading=!0,C.Alarm.create(this.terrain).start(1.92,function(){return t.reloadLevel()}));var n=this.firstColliderInTag(X.Game.TAGS.PLAYER);if(n){var i=n.entity,r=(new G.Rectangle).copy(this.camera.extents),o=G.Vector.temp5.set(r.width/2,r.height/2),a=this.terrain.find(F.Tilemap),s=a.getSceneBounds(G.Rectangle.temp0),u=G.Vector.temp0.set(i.x,i.y).sub(o).max(G.Vector.temp2.set(s.x,s.y)).min(G.Vector.temp2.set(s.right,s.bottom)).add(o);s.width<r.width&&(u.x=s.centerX+a.tileWidth/2),s.height<r.height&&(u.y=s.centerY+a.tileHeight/2),this.camera.position.copy(u)}}}},{key:"numShadows",get:function(){return Object.keys(this._shadows).length}},{key:"mapPath",get:function(){return"fantasy/TMX/"+this.scene+".tmx"}},{key:"waterFlow",get:function(){return this.terrain.find(N.WaterFlow)}}]),e}(V.EditableScene);e.Level=J},function(t,e,n){"use strict";function i(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),i(n(113)),i(n(203)),i(n(114))},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(6),o=i(r),a=n(2),s=i(a),u=n(3),l=i(u),c=n(34),h=i(c),f=n(17),d=i(f),p=n(0),y=i(p),v=n(1),g=i(v),m=n(4),_=i(m),b=function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===("undefined"==typeof Reflect?"undefined":(0,_.default)(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(e,"__esModule",{value:!0});var x=n(5),w=n(36),k=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;(0,y.default)(this,t),this.callInfos=e||[],n&&this.bind(n)}return(0,g.default)(t,[{key:"bind",value:function(t){this.cbs=O.makeCalls(t,this.callInfos)}},{key:"invoke",value:function(){var t=!0,e=!1,n=void 0;try{for(var i,r=this.cbs[Symbol.iterator]();!(t=(i=r.next()).done);t=!0)(0,i.value)()}catch(t){e=!0,n=t}finally{try{!t&&r.return&&r.return()}finally{if(e)throw n}}}}]),t}();e.EventDelegate=k;var O=function(){function t(){(0,y.default)(this,t)}return(0,g.default)(t,null,[{key:"makeCalls",value:function(e,n){var i=[];if(void 0!==n){"string"==typeof n&&(n=[[n,[]]]);var r=!0,o=!1,a=void 0;try{for(var s,u=n[Symbol.iterator]();!(r=(s=u.next()).done);r=!0){var l=s.value;i.push(t.makeCall(e,l))}}catch(t){o=!0,a=t}finally{try{!r&&u.return&&u.return()}finally{if(o)throw a}}}return i}},{key:"makeCall",value:function(e,n){if("string"==typeof n&&(n=[n,[]]),n instanceof Array){var i=n,r=(0,d.default)(i,2),o=r[0],a=r[1],s=o.split("."),u=(0,d.default)(s,2),l=u[0],c=u[1];return t.makeCall(e,{componentName:l,methodName:c,args:a})}var f=void 0;if(n.componentName[0].toLowerCase()===n.componentName[0])f=e.componentByName[n.componentName];else{var p=w.getComponentByName(n.componentName);f=e.find(p)}var y=f[n.methodName],v=n.args;return v instanceof Array||(v=[v]),function(){return y.call.apply(y,[f].concat((0,h.default)(v)))}}}]),t}();e.EventUtil=O;var GameEvents=function(t){function GameEvents(t){(0,y.default)(this,GameEvents);var e=(0,s.default)(this,(GameEvents.__proto__||Object.getPrototypeOf(GameEvents)).call(this));return e.eventListeners=t,e}return(0,l.default)(GameEvents,t),(0,g.default)(GameEvents,[{key:"addedToScene",value:function(){var t=this.scene.events,e=!0,n=!1,i=void 0;try{for(var r,o=Object.entries(this.eventListeners)[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var a=(0,d.default)(r.value,2),s=a[0],u=a[1],l=void 0;switch(s){case"onSingleHeartCollected":l=t.onSingleHeartCollected;break;case"onHeartsCollected":l=t.onHeartsCollected;break;case"onTreasureCollected":l=t.onTreasureCollected;break;default:throw Error("unrecognized event "+s)}var c=!0,h=!1,f=void 0;try{for(var p,y=u[Symbol.iterator]();!(c=(p=y.next()).done);c=!0){var v=p.value;l.push(O.makeCall(this.entity,v))}}catch(t){h=!0,f=t}finally{try{!c&&y.return&&y.return()}finally{if(h)throw f}}}}catch(t){n=!0,i=t}finally{try{!e&&o.return&&o.return()}finally{if(n)throw i}}}}]),GameEvents}(x.Component);GameEvents=b([x.Component.register,function(t,e){if("object"===("undefined"==typeof Reflect?"undefined":(0,_.default)(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],GameEvents),e.GameEvents=GameEvents;var GameEventsEmitter=S=function(t){function GameEventsEmitter(){(0,y.default)(this,GameEventsEmitter);var t=(0,s.default)(this,(GameEventsEmitter.__proto__||Object.getPrototypeOf(GameEventsEmitter)).apply(this,arguments));return t.onSingleHeartCollected=[],t.onHeartsCollected=[],t.onTreasureCollected=[],t}return(0,l.default)(GameEventsEmitter,t),(0,g.default)(GameEventsEmitter,[{key:"triggerSingleHeartCollected",value:function(){S.callAll(this.onSingleHeartCollected)}},{key:"addedToScene",value:function(){this.didEmitHeartsCollected=!1,this.didEmitTreasureCollected=!1}},{key:"update",value:function(){(0,o.default)(GameEventsEmitter.prototype.__proto__||Object.getPrototypeOf(GameEventsEmitter.prototype),"update",this).call(this),this.didEmitHeartsCollected||0!==this.scene.allCollidersInTag("heart").length||(this.didEmitHeartsCollected=!0,S.callAll(this.onHeartsCollected)),this.didEmitTreasureCollected||0!==this.scene.allCollidersInTag("treasure").length||(this.didEmitTreasureCollected=!0,S.callAll(this.onTreasureCollected))}}],[{key:"callAll",value:function(t){var e=!0,n=!1,i=void 0;try{for(var r,o=t[Symbol.iterator]();!(e=(r=o.next()).done);e=!0)(0,r.value)()}catch(t){n=!0,i=t}finally{try{!e&&o.return&&o.return()}finally{if(n)throw i}}}}]),GameEventsEmitter}(x.Component);GameEventsEmitter=S=b([x.Component.register],GameEventsEmitter),e.GameEventsEmitter=GameEventsEmitter;var S},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a),u=n(2),l=i(u),c=n(6),h=i(c),f=n(3),d=i(f);Object.defineProperty(e,"__esModule",{value:!0});var p=n(7),y=n(5),v=n(12),g=n(26),m=n(41),_=n(26),b=n(15),x=n(16),w=n(122),k=function(t){function e(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];(0,o.default)(this,e);var n=(0,l.default)(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.sliderEnabled=!0,n.slider=0,n.sliderTo=-1,n.groupsMask=[],n.selection=null,n.dragging=null,n.dragOrigin=new p.Vector,n.draggingRect=new p.Rectangle,n.loaded=!1,window.scene=n,t||(n.slider=n.sliderTo),n}return(0,d.default)(e,t),(0,s.default)(e,[{key:"findUnder",value:function(t){var e=this.groupsMask.length>0?this.allInGroups(this.groupsMask):this.entities,n=null;return e.each(function(e){if(e.visible){var i=e.findAll(v.Hitbox),r=!0,o=!1,a=void 0;try{for(var s,u=i[Symbol.iterator]();!(r=(s=u.next()).done);r=!0){var l=s.value;if(l.sceneBounds.containsPoint(t))return n=l,!1}}catch(t){o=!0,a=t}finally{try{!r&&u.return&&u.return()}finally{if(o)throw a}}}}),n}},{key:"renderSlider",value:function(){var t=b.Game.transitionColor;if(!this.loaded)return void y.Engine.graphics.clear(t);var e=p.Vector.temp5.copy(this.camera.position),n=e.x+p.Ease.cubeInOut(this.slider)*(y.Engine.width+0),i=e.y-y.Engine.height/2,r=n-y.Engine.width/2;y.Engine.width,y.Engine.graphics.setRenderTarget(y.Engine.graphics.buffer),y.Engine.graphics.shader=p.Shaders.texture,y.Engine.graphics.shader.set("matrix",this.camera.matrix),y.Engine.graphics.rect(r-1,i,y.Engine.width+2,y.Engine.height,t);var o=p.Vector.temp0.set(r,i),a=p.Vector.temp1.set(r-0,i+y.Engine.height),s=p.Vector.temp2.set(r,i+y.Engine.height);y.Engine.graphics.triangle(o,a,s,t)}},{key:"update",value:function(){(0,h.default)(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),b.Game.developer&&this.checkCommonDevKeys(),this.sliderEnabled&&this.slider!==this.sliderTo&&(this.slider=p.Calc.approach(this.slider,this.sliderTo,1.7*y.Engine.delta),this.slider===this.sliderTo&&this.sliderOnEnd&&(this.sliderOnEnd(),this.sliderOnEnd=null)),y.Engine.debugMode&&b.Game.developer&&this.updateDebugView()}},{key:"checkCommonDevKeys",value:function(){_.Keyboard.pressed(b.Game.KEYS.SELECT)&&(y.Engine.debugMode=!y.Engine.debugMode),_.Keyboard.pressed(b.Game.KEYS.PAUSE)&&(y.Engine.paused=!y.Engine.paused),_.Keyboard.pressed(b.Game.KEYS.FINISH_LEVEL)&&this.completeLevel(),y.Engine.timeScale=_.Keyboard.check(b.Game.KEYS.FAST_FORWARD)?7:1}},{key:"render",value:function(){(0,h.default)(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"render",this).call(this),this.sliderEnabled&&this.slider!==this.sliderTo&&this.renderSlider()}},{key:"debugRender",value:function(t){(0,h.default)(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"debugRender",this).call(this,t),y.Engine.graphics.fillText("scene: "+this.scene,100,100)}},{key:"updateDebugView",value:function(){var t=this.camera.worldMouse;if(g.Mouse.leftPressed){var n=(this.groupsMask.length>0?this.allInGroups(this.groupsMask):this.entities,this.findUnder(t));n&&(this.selection=n,window.editSelection=n,w.editJSON(this.selection.prefabLink),this.dragging=n,this.draggingMode=e.borderContainsPoint(n.sceneBounds,t,3),this.draggingRect.copy(n.sceneBounds),this.dragOrigin.copy(t).sub(p.Vector.temp1.set(n.left,n.top)))}else if(g.Mouse.left&&this.dragging){var i=p.Vector.temp0.copy(t).sub(this.dragOrigin),r=p.Vector.temp1.copy(t).sub(p.Vector.temp2.set(this.draggingRect.x,this.draggingRect.y)),o=p.Vector.temp3.set(this.draggingRect.right,this.draggingRect.bottom).sub(t);r.x+=1,r.y+=1;var a={};switch(this.draggingMode){case"None":a={left:i.x,top:i.y};break;case"Top":a={top:i.y,height:o.y};break;case"Bottom":a={height:r.y};break;case"Left":a={left:i.x,width:o.x};break;case"Right":a={width:r.x};break;case"BottomRight":a={width:r.x,height:r.y};break;case"TopLeft":a={top:i.y,height:o.y,left:i.x,width:o.x};break;case"TopRight":a={top:i.y,height:o.y,width:r.x};break;case"BottomLeft":a={height:r.y,left:i.x,width:o.x};break;default:throw Error("unexpected RectBorder")}this.dragging.setPrefabValues(a)}else if(!g.Mouse.left){var s="inherit",u=this.findUnder(t);if(u){var l=u.sceneBounds,c=e.borderContainsPoint(l,t,3);s="None"===c?"move":e.cursorForRectBorder(c)}y.Engine.graphics.canvas.style.cursor=s}g.Mouse.leftReleased&&this.dragging&&(this.dragging=null,x.sendPrefabsToServer())}},{key:"markLevel",value:function(){localStorage.setItem(e.DEV_LEVELNAME_KEY,this.scene)}},{key:"transitionTo",value:function(t){var e=this;this.sliderEnabled?this.doSlide(1,0,function(){return e.goto(t)}):this.goto(t)}},{key:"transitionToTitle",value:function(){var t=this,e=new(n(123).TitleScreen);this.sliderEnabled?this.doSlide(1,0,function(){return t.gotoLevel(e)}):this.gotoLevel(e)}},{key:"gotoLevel",value:function(t){y.Engine.goto(t,!0)}},{key:"goto",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.gotoLevel(new m.Level(t,"start",e))}},{key:"reloadLevel",value:function(){arguments.length>0&&void 0!==arguments[0]&&!arguments[0]?this.goto(this.scene,!1):this.transitionTo(this.scene)}},{key:"nextLevel",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.levelDelta(1,t,e)}},{key:"prevLevel",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.levelDelta(-1,t,e)}},{key:"newGame",value:function(){b.Game.clearCompletedLevels(),this.nextLevel()}},{key:"completeLevel",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];b.Game.markLevelCompleted(this.scene),this.nextLevel(t)}},{key:"levelDelta",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=b.Game.levels.indexOf(this.scene),r=1!=t||n?b.Game.levels[i+t]:b.Game.getNextLevelName();r||n?e?this.transitionTo(r):r&&this.goto(r,!1):this.gotoLevel(b.Game.EndScreen)}},{key:"doSlide",value:function(t,e,n){this.sliderOnEnd||(this.slider=t,this.sliderTo=e,this.sliderOnEnd=n)}}],[{key:"borderContainsPoint",value:function(t,e){var n=e.x,i=e.y,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,o=t.left,a=t.top,s=t.right,u=t.bottom,l=Math.abs(o-n)<=r,c=Math.abs(s-n)<=r,h=Math.abs(a-i)<=r,f=Math.abs(u-i)<=r;if(l&&h)return"TopLeft";if(c&&h)return"TopRight";if(l&&f)return"BottomLeft";if(c&&f)return"BottomRight";var d=o<n&&n<s,p=a<i&&i<u;return h&&d?"Top":f&&d?"Bottom":l&&p?"Left":c&&p?"Right":"None"}},{key:"cursorForRectBorder",value:function(t){switch(t){case"Top":return"n-resize";case"Bottom":return"s-resize";case"Left":return"w-resize";case"Right":return"e-resize";case"TopLeft":return"nw-resize";case"TopRight":return"ne-resize";case"BottomLeft":return"sw-resize";case"BottomRight":return"se-resize";case"None":return"inherit";default:throw Error("unexpected RectBorder value")}}}]),e}(y.Scene);k.DEV_LEVELNAME_KEY="lastDevLevel",e.EditableScene=k},function(t,e,n){var i=n(84),r=n(67);t.exports=Object.keys||function(t){return i(t,r)}},function(t,e){var n=0,i=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++n+i).toString(36))}},function(t,e,n){"use strict";var i=n(138)(!0);n(80)(String,"String",function(t){this._t=t+"",this._i=0},function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=i(e,n),this._i+=t.length,{value:t,done:!1})})},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a);Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(){(0,o.default)(this,t)}return(0,s.default)(t,null,[{key:"unload",value:function(){t.json={},t.xml={},t.text={},t.atlases={};for(var e in t.textures)t.textures[e].dispose();t.textures={};for(var n in t.sounds)t.sounds[n].dispose();t.sounds={}}}]),t}();u.textures={},u.json={},u.xml={},u.text={},u.sounds={},u.atlases={},e.Assets=u},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a);Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(){(0,o.default)(this,t),this.mat=new Float32Array(9),this.identity()}return(0,s.default)(t,[{key:"identity",value:function(){return this.mat[0]=1,this.mat[1]=0,this.mat[2]=0,this.mat[3]=0,this.mat[4]=1,this.mat[5]=0,this.mat[6]=0,this.mat[7]=0,this.mat[8]=1,this}},{key:"copy",value:function(t){return this.mat[0]=t.mat[0],this.mat[1]=t.mat[1],this.mat[2]=t.mat[2],this.mat[3]=t.mat[3],this.mat[4]=t.mat[4],this.mat[5]=t.mat[5],this.mat[6]=t.mat[6],this.mat[7]=t.mat[7],this.mat[8]=t.mat[8],this}},{key:"set",value:function(t,e,n,i,r,o){return this.mat[0]=t,this.mat[1]=i,this.mat[2]=0,this.mat[3]=n,this.mat[4]=e,this.mat[5]=0,this.mat[6]=r,this.mat[7]=o,this.mat[8]=1,this}},{key:"add",value:function(t){return this.mat[0]+=t.mat[0],this.mat[1]+=t.mat[1],this.mat[2]+=t.mat[2],this.mat[3]+=t.mat[3],this.mat[4]+=t.mat[4],this.mat[5]+=t.mat[5],this.mat[6]+=t.mat[6],this.mat[7]+=t.mat[7],this.mat[8]+=t.mat[8],this}},{key:"sub",value:function(t){return this.mat[0]-=t.mat[0],this.mat[1]-=t.mat[1],this.mat[2]-=t.mat[2],this.mat[3]-=t.mat[3],this.mat[4]-=t.mat[4],this.mat[5]-=t.mat[5],this.mat[6]-=t.mat[6],this.mat[7]-=t.mat[7],this.mat[8]-=t.mat[8],this}},{key:"scaler",value:function(t){return this.mat[0]*=t,this.mat[1]*=t,this.mat[2]*=t,this.mat[3]*=t,this.mat[4]*=t,this.mat[5]*=t,this.mat[6]*=t,this.mat[7]*=t,this.mat[8]*=t,this}},{key:"invert",value:function(){var t=this.mat[0],e=this.mat[1],n=this.mat[2],i=this.mat[3],r=this.mat[4],o=this.mat[5],a=this.mat[6],s=this.mat[7],u=this.mat[8],l=u*r-o*s,c=-u*i+o*a,h=s*i-r*a,f=t*l+e*c+n*h;return f?(f=1/f,this.mat[0]=l*f,this.mat[1]=(-u*e+n*s)*f,this.mat[2]=(o*e-n*r)*f,this.mat[3]=c*f,this.mat[4]=(u*t-n*a)*f,this.mat[5]=(-o*t+n*i)*f,this.mat[6]=h*f,this.mat[7]=(-s*t+e*a)*f,this.mat[8]=(r*t-e*i)*f,this):this}},{key:"multiply",value:function(t){var e=this.mat[0],n=this.mat[1],i=this.mat[2],r=this.mat[3],o=this.mat[4],a=this.mat[5],s=this.mat[6],u=this.mat[7],l=this.mat[8],c=t.mat[0],h=t.mat[1],f=t.mat[2],d=t.mat[3],p=t.mat[4],y=t.mat[5],v=t.mat[6],g=t.mat[7],m=t.mat[8];return this.mat[0]=c*e+h*r+f*s,this.mat[1]=c*n+h*o+f*u,this.mat[2]=c*i+h*a+f*l,this.mat[3]=d*e+p*r+y*s,this.mat[4]=d*n+p*o+y*u,this.mat[5]=d*i+p*a+y*l,this.mat[6]=v*e+g*r+m*s,this.mat[7]=v*n+g*o+m*u,this.mat[8]=v*i+g*a+m*l,this}},{key:"rotate",value:function(t){var e=this.mat[0],n=this.mat[1],i=this.mat[2],r=this.mat[3],o=this.mat[4],a=this.mat[5],s=Math.sin(t),u=Math.cos(t);return this.mat[0]=u*e+s*r,this.mat[1]=u*n+s*o,this.mat[2]=u*i+s*a,this.mat[3]=u*r-s*e,this.mat[4]=u*o-s*n,this.mat[5]=u*a-s*i,this}},{key:"scale",value:function(t,e){return this.mat[0]=t*this.mat[0],this.mat[1]=t*this.mat[1],this.mat[2]=t*this.mat[2],this.mat[3]=e*this.mat[3],this.mat[4]=e*this.mat[4],this.mat[5]=e*this.mat[5],this}},{key:"translate",value:function(t,e){var n=this.mat[0],i=this.mat[1],r=this.mat[2],o=this.mat[3],a=this.mat[4],s=this.mat[5],u=this.mat[6],l=this.mat[7],c=this.mat[8];return this.mat[6]=t*n+e*o+u,this.mat[7]=t*i+e*a+l,this.mat[8]=t*r+e*s+c,this}},{key:"fromRotation",value:function(t){var e=Math.sin(t),n=Math.cos(t);return this.identity(),this.mat[0]=n,this.mat[1]=-e,this.mat[3]=e,this.mat[4]=n,this}},{key:"fromScale",value:function(t,e){return this.identity(),this.mat[0]=t,this.mat[4]=e,this}},{key:"fromTranslation",value:function(t,e){return this.identity(),this.mat[6]=t,this.mat[7]=e,this}}]),t}();e.Matrix=u},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a);Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(){(0,o.default)(this,t)}return(0,s.default)(t,null,[{key:"sign",value:function(t){return t<0?-1:t>0?1:0}},{key:"cmp",value:function(t,e){return t<e?-1:t>e?1:0}},{key:"clamp",value:function(t,e,n){return Math.max(e,Math.min(n,t))}},{key:"approach",value:function(t,e,n){return t>e?Math.max(t-n,e):Math.min(t+n,e)}},{key:"range",value:function(t,e){return void 0===e?-t+Math.random()*t*2:t+Math.random()*(e-t)}},{key:"choose",value:function(t){return t[Math.floor(Math.random()*t.length)]}}]),t}();e.Calc=u},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a);Object.defineProperty(e,"__esModule",{value:!0});var u=n(76),l=function(){function t(){(0,o.default)(this,t)}return(0,s.default)(t,null,[{key:"init",value:function(){t.texture=new u.Shader("attribute vec2 a_position;attribute vec2 a_texcoord;attribute vec4 a_color;uniform mat3 matrix;varying vec2 v_texcoord;varying vec4 v_color;void main(){\tgl_Position = vec4((matrix * vec3(a_position, 1.0)).xy, 0.0, 1.0);\tv_texcoord = a_texcoord;\tv_color = vec4(a_color.rgb * a_color.a, a_color.a);}","precision mediump float;varying vec2 v_texcoord;varying vec4 v_color;uniform sampler2D texture;void main() {\tgl_FragColor = texture2D(texture, v_texcoord) * v_color;}",[new u.ShaderUniform("matrix",u.ShaderUniformType.matrix3d),new u.ShaderUniform("texture",u.ShaderUniformType.sampler2D)],[new u.ShaderAttribute("a_position",u.ShaderAttributeType.Position),new u.ShaderAttribute("a_texcoord",u.ShaderAttributeType.Texcoord),new u.ShaderAttribute("a_color",u.ShaderAttributeType.Color)]),t.solid=new u.Shader("attribute vec2 a_position;attribute vec2 a_texcoord;attribute vec4 a_color;uniform mat3 matrix;varying vec2 v_texcoord;varying vec4 v_color;void main(){\tgl_Position = vec4((matrix * vec3(a_position, 1.0)).xy, 0.0, 1.0);\tv_texcoord = a_texcoord;\tv_color = a_color;}","precision mediump float;varying vec2 v_texcoord;varying vec4 v_color;uniform sampler2D texture;void main() {\tgl_FragColor = v_color * texture2D(texture, v_texcoord).a;}",[new u.ShaderUniform("matrix",u.ShaderUniformType.matrix3d),new u.ShaderUniform("texture",u.ShaderUniformType.sampler2D)],[new u.ShaderAttribute("a_position",u.ShaderAttributeType.Position),new u.ShaderAttribute("a_texcoord",u.ShaderAttributeType.Texcoord),new u.ShaderAttribute("a_color",u.ShaderAttributeType.Color)]),t.primitive=new u.Shader("attribute vec2 a_position;attribute vec4 a_color;uniform mat3 matrix;varying vec4 v_color;void main(){\tgl_Position = vec4((matrix * vec3(a_position, 1.0)).xy, 0.0, 1.0);\tv_color = a_color;}","precision mediump float;varying vec4 v_color;void main() {\tgl_FragColor = v_color;}",[new u.ShaderUniform("matrix",u.ShaderUniformType.matrix3d)],[new u.ShaderAttribute("a_position",u.ShaderAttributeType.Position),new u.ShaderAttribute("a_color",u.ShaderAttributeType.Color)])}}]),t}();e.Shaders=l},function(t,e,n){t.exports=n(177)},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a);Object.defineProperty(e,"__esModule",{value:!0});var u=n(8),l=n(22),c=n(13),h=n(100),f=function(){function t(e,n,i){(0,o.default)(this,t),this.bounds=null,this.frame=null,this.texture=null,this.metadata={},this.texture=e,this.bounds=n||new l.Rectangle(0,0,e.width,e.height),this.frame=i||new l.Rectangle(0,0,this.bounds.width,this.bounds.height),this.center=new c.Vector(this.frame.width/2,this.frame.height/2)}return(0,s.default)(t,[{key:"getSubtexture",value:function(e,n){return void 0===n?n=new t(this.texture):n.texture=this.texture,n.bounds.x=this.bounds.x+Math.max(0,Math.min(this.bounds.width,e.x+this.frame.x)),n.bounds.y=this.bounds.y+Math.max(0,Math.min(this.bounds.height,e.y+this.frame.y)),n.bounds.width=Math.max(0,this.bounds.x+Math.min(this.bounds.width,e.x+this.frame.x+e.width)-n.bounds.x),n.bounds.height=Math.max(0,this.bounds.y+Math.min(this.bounds.height,e.y+this.frame.y+e.height)-n.bounds.y),n.frame.x=Math.min(0,this.frame.x+e.x),n.frame.y=Math.min(0,this.frame.y+e.y),n.frame.width=e.width,n.frame.height=e.height,n.center=new c.Vector(n.frame.width/2,n.frame.height/2),n}},{key:"clone",value:function(){return new t(this.texture,this.bounds.clone(),this.frame.clone())}},{key:"toString",value:function(){return this.texture.path+": ["+this.bounds.x+", "+this.bounds.y+", "+this.bounds.width+", "+this.bounds.height+"]frame["+this.frame.x+", "+this.frame.y+", "+this.frame.width+", "+this.frame.height+"]"}},{key:"draw",value:function(t,e,n,i,r,o,a){u.Engine.graphics.texture(this,t.x,t.y,null,r,e,n,i,o,a)}},{key:"drawCropped",value:function(t,e,n,i,r,o,a,s){u.Engine.graphics.texture(this,t.x,t.y,e,o,n,i,r,a,s)}},{key:"drawCenter",value:function(t,e,n,i,r,o){u.Engine.graphics.texture(this,t.x,t.y,null,i,this.center,e,n,r,o)}},{key:"drawCenterCropped",value:function(t,e,n,i,r,o,a){u.Engine.graphics.texture(this,t.x,t.y,e,r,new c.Vector(e.width/2,e.height/2),n,i,o,a)}},{key:"drawJustify",value:function(t,e,n,i,r,o,a){u.Engine.graphics.texture(this,t.x,t.y,null,r,new c.Vector(this.width*e.x,this.height*e.y),n,i,o,a)}},{key:"drawJustifyCropped",value:function(t,e,n,i,r,o,a,s){u.Engine.graphics.texture(this,t.x,t.y,e,o,new c.Vector(e.width*n.x,e.height*n.y),i,r,a,s)}},{key:"dispose",value:function(){this.texture.dispose(),this.texture=null}},{key:"width",get:function(){return this.frame.width}},{key:"height",get:function(){return this.frame.height}},{key:"clippedWidth",get:function(){return this.bounds.width}},{key:"clippedHeight",get:function(){return this.bounds.height}}],[{key:"makeTransparent",value:function(t,e){var n=document.createElement("canvas");n.width=t.width,n.height=t.height;var i=n.getContext("2d");i.drawImage(t,0,0);for(var r=i.getImageData(0,0,n.width,n.height),o=r.data,a=0;a<o.length;a+=4)o[a+0]===e.r&&o[a+1]===e.g&&o[a+2]===e.b&&(o[a+3]=0);return i.putImageData(r,0,0),n}},{key:"create",value:function(e,n){var i=u.Engine.graphics.gl,r=i.createTexture();return i.bindTexture(i.TEXTURE_2D,r),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1),n?i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,t.makeTransparent(e,n)):i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,e),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.bindTexture(i.TEXTURE_2D,null),new t(new h.FosterWebGLTexture(r,e.width,e.height))}},{key:"createFromData",value:function(e,n,i){for(var r=u.Engine.graphics.gl,o=r.createTexture(),a=[],s=0;s<e.length;s++)a[s]=Math.floor(255*e[s]);return r.bindTexture(r.TEXTURE_2D,o),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,n,i,0,r.RGBA,r.UNSIGNED_BYTE,new Uint8Array(e)),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.NEAREST),new t(new h.FosterWebGLTexture(o,n,i))}}]),t}();e.Texture=f},function(t,e,n){"use strict";function i(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),i(n(106)),i(n(108)),i(n(107))},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a),u=n(2),l=i(u),c=n(3),h=i(c),f=n(4),d=i(f);Object.defineProperty(e,"__esModule",{value:!0});var p=n(5),Health=function(t){function Health(){(0,o.default)(this,Health);var t=(0,l.default)(this,(Health.__proto__||Object.getPrototypeOf(Health)).apply(this,arguments));return t.health=1,t.invincibilityTime=1,t.lastHitTime=-1e3,t.onDamage=[],t.onDie=[],t}return(0,h.default)(Health,t),(0,s.default)(Health,[{key:"kill",value:function(){this.applyDamage(this.health,null)}},{key:"tryApplyDamage",value:function(t){return!this.invincible&&this.applyDamage(t.amount,t)}},{key:"applyDamage",value:function(t,e){this.lastHitTime=p.Engine.elapsed;var n=this.health;this.health-=t;var i=!0,r=!1,o=void 0;try{for(var a,s=this.onDamage[Symbol.iterator]();!(i=(a=s.next()).done);i=!0)(0,a.value)(e)}catch(t){r=!0,o=t}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}if(n>0&&this.health<=0){var u=!0,l=!1,c=void 0;try{for(var h,f=this.onDie[Symbol.iterator]();!(u=(h=f.next()).done);u=!0)(0,h.value)(e)}catch(t){l=!0,c=t}finally{try{!u&&f.return&&f.return()}finally{if(l)throw c}}}return!0}},{key:"dead",get:function(){return this.health<=0}},{key:"invincible",get:function(){return!this.dead&&p.Engine.elapsed-this.lastHitTime<this.invincibilityTime}}]),Health}(p.Component);Health=function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===("undefined"==typeof Reflect?"undefined":(0,d.default)(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a}([p.Component.register],Health),e.Health=Health},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a),u=n(2),l=i(u),c=n(6),h=i(c),f=n(3),d=i(f),p=n(4),y=i(p);Object.defineProperty(e,"__esModule",{value:!0});var v=n(5),g=n(7),m=n(16),_=n(10);n(11);var ChildEntity=function(t){function ChildEntity(){return(0,o.default)(this,ChildEntity),(0,l.default)(this,(ChildEntity.__proto__||Object.getPrototypeOf(ChildEntity)).apply(this,arguments))}return(0,d.default)(ChildEntity,t),(0,s.default)(ChildEntity,[{key:"setActive",value:function(t){(0,h.default)(ChildEntity.prototype.__proto__||Object.getPrototypeOf(ChildEntity.prototype),"setActive",this).call(this,t),this.child.visible=t}},{key:"addedToScene",value:function(){(0,h.default)(ChildEntity.prototype.__proto__||Object.getPrototypeOf(ChildEntity.prototype),"addedToScene",this).call(this),this.child=this.scene.add(this.opts.prefabName?m.instantiatePrefab(this.opts.prefabName):new v.Entity),void 0!==this.opts.name&&(this.child.name=this.opts.name),this.updatePos()}},{key:"update",value:function(){this.updatePos()}},{key:"updatePos",value:function(){this.getScenePosition(this.child.position),this.child.position.add(g.Vector.temp0.set(this.opts.left||0,this.opts.top||0))}},{key:"removedFromScene",value:function(){this.child&&this.scene.remove(this.child),(0,h.default)(ChildEntity.prototype.__proto__||Object.getPrototypeOf(ChildEntity.prototype),"removedFromScene",this).call(this)}}]),ChildEntity}(_.AutoComponent);ChildEntity=function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===("undefined"==typeof Reflect?"undefined":(0,y.default)(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a}([_.AutoComponent.register],ChildEntity),e.ChildEntity=ChildEntity},function(t,e,n){n(128);for(var i=n(24),r=n(33),o=n(32),a=n(19)("toStringTag"),s=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],u=0;u<5;u++){var l=s[u],c=i[l],h=c&&c.prototype;h&&!h[a]&&r(h,a,l),o[l]=o.Array}},function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},function(t,e){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e){t.exports=!0},function(t,e,n){var i=n(132);t.exports=function(t,e,n){if(i(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,i){return t.call(e,n,i)};case 3:return function(n,i,r){return t.call(e,n,i,r)}}return function(){return t.apply(e,arguments)}}},function(t,e,n){var i=n(37);t.exports=function(t,e){if(!i(t))return t;var n,r;if(e&&"function"==typeof(n=t.toString)&&!i(r=n.call(t)))return r;if("function"==typeof(n=t.valueOf)&&!i(r=n.call(t)))return r;if(!e&&"function"==typeof(n=t.toString)&&!i(r=n.call(t)))return r;throw TypeError("Can't convert object to primitive value")}},function(t,e,n){var i=n(28),r=n(134),o=n(67),a=n(65)("IE_PROTO"),s=function(){},u=function(){var t,e=n(82)("iframe"),i=o.length;for(e.style.display="none",n(137).appendChild(e),e.src="javascript:",t=e.contentWindow.document,t.open(),t.write("<script>document.F=Object<\/script>"),t.close(),u=t.F;i--;)delete u.prototype[o[i]];return u()};t.exports=Object.create||function(t,e){var n;return null!==t?(s.prototype=i(t),n=new s,s.prototype=null,n[a]=t):n=u(),void 0===e?n:r(n,e)}},function(t,e){var n=Math.ceil,i=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?i:n)(t)}},function(t,e,n){var i=n(66)("keys"),r=n(46);t.exports=function(t){return i[t]||(i[t]=r(t))}},function(t,e,n){var i=n(24),r=i["__core-js_shared__"]||(i["__core-js_shared__"]={});t.exports=function(t){return r[t]||(r[t]={})}},function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,e,n){var i=n(25).f,r=n(30),o=n(19)("toStringTag");t.exports=function(t,e,n){t&&!r(t=n?t:t.prototype,o)&&i(t,o,{configurable:!0,value:e})}},function(t,e,n){var i=n(59);t.exports=function(t){return Object(i(t))}},function(t,e,n){e.f=n(19)},function(t,e,n){var i=n(24),r=n(18),o=n(60),a=n(70),s=n(25).f;t.exports=function(t){var e=r.Symbol||(r.Symbol=o?{}:i.Symbol||{});"_"==t.charAt(0)||t in e||s(e,t,{value:a.f(t)})}},function(t,e){e.f={}.propertyIsEnumerable},function(t,e,n){var i=n(72),r=n(39),o=n(23),a=n(62),s=n(30),u=n(81),l=Object.getOwnPropertyDescriptor;e.f=n(29)?l:function(t,e){if(t=o(t),e=a(e,!0),u)try{return l(t,e)}catch(t){}if(s(t,e))return r(!i.f.call(t,e),t[e])}},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a);Object.defineProperty(e,"__esModule",{value:!0});var u=n(8),l=n(13),c=function(){function t(){(0,o.default)(this,t)}return(0,s.default)(t,[{key:"percent",value:function(){return new l.Vector}}],[{key:"init",value:function(){t._position=new l.Vector(0,0),t._positionNext=new l.Vector(0,0),u.Engine.root.addEventListener("mousemove",function(e){t.absolute=new l.Vector(e.pageX,e.pageY),t.setNextMouseTo(e.pageX,e.pageY)}),u.Engine.root.addEventListener("mousedown",function(e){0===e.button?t._leftNext=!0:t._rightNext=!0}),u.Engine.root.addEventListener("mouseup",function(e){0===e.button?t._leftNext=!1:t._rightNext=!1})}},{key:"update",value:function(){this._leftWas=this._left,this._left=this._leftNext,this._rightWas=this._right,this._right=this._rightNext,this._position=this._positionNext}},{key:"setNextMouseTo",value:function(e,n){var i=u.Engine.graphics.canvas.getBoundingClientRect(),r=u.Engine.graphics.getOutputBounds(),o=new l.Vector(r.width/u.Engine.width,r.height/u.Engine.height);t._positionNext,t._positionNext=new l.Vector((e-i.left-r.left)/o.x,(n-i.top-r.top)/o.y)}},{key:"x",get:function(){return this._position.x}},{key:"y",get:function(){return this._position.y}},{key:"position",get:function(){return new l.Vector(this._position.x,this._position.y)}},{key:"left",get:function(){return this._left}},{key:"leftPressed",get:function(){return this._left&&!this._leftWas}},{key:"leftReleased",get:function(){return!this._left&&this._leftWas}},{key:"right",get:function(){return this._right}},{key:"rightPressed",get:function(){return this._right&&!this._rightWas}},{key:"rightReleased",get:function(){return!this._right&&this._rightWas}}]),t}();c.absolute=new l.Vector(0,0),e.Mouse=c},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a);Object.defineProperty(e,"__esModule",{value:!0});var u=n(8),l=n(49),c=n(13),h=function(){function t(e,n,i,r){(0,o.default)(this,t),this.dirty=!0,this.uniformsByName={},u.Engine.graphics.gl,this.attributes=r,this.uniforms=i,this.setProgramText(e,n)}return(0,s.default)(t,[{key:"setProgramText",value:function(t,e){var n=u.Engine.graphics.gl,i=n.createShader(n.VERTEX_SHADER);if(n.shaderSource(i,t),n.compileShader(i),!n.getShaderParameter(i,n.COMPILE_STATUS))throw Error("An error occurred compiling the shaders: "+n.getShaderInfoLog(i));var r=n.createShader(n.FRAGMENT_SHADER);if(n.shaderSource(r,e),n.compileShader(r),!n.getShaderParameter(r,n.COMPILE_STATUS))throw Error("An error occurred compiling the shaders: "+n.getShaderInfoLog(r));if(this.program&&n.deleteProgram(this.program),this.program=n.createProgram(),n.attachShader(this.program,i),n.attachShader(this.program,r),n.linkProgram(this.program),!n.getProgramParameter(this.program,n.LINK_STATUS))throw Error("Unable to initialize the shader program.");n.deleteShader(i),n.deleteShader(r);var o=!0,a=!1,s=void 0;try{for(var l,c=this.attributes[Symbol.iterator]();!(o=(l=c.next()).done);o=!0){var h=l.value;h.attribute=n.getAttribLocation(this.program,h.name)}}catch(t){a=!0,s=t}finally{try{!o&&c.return&&c.return()}finally{if(a)throw s}}var d=!0,p=!1,y=void 0;try{for(var v,g=this.uniforms[Symbol.iterator]();!(d=(v=g.next()).done);d=!0){var m=v.value;this.uniformsByName[m.name]=m,m.shader=this,m.uniform=n.getUniformLocation(this.program,m.name),m.type===f.sampler2D&&null==this.sampler2d&&(this.sampler2d=m)}}catch(t){p=!0,y=t}finally{try{!d&&g.return&&g.return()}finally{if(p)throw y}}}},{key:"set",value:function(t,e){this.uniformsByName[t].value=e}}]),t}();h._last_uuid=0,e.Shader=h;var f;!function(t){t[t.float=0]="float",t[t.floatArray=1]="floatArray",t[t.float2=2]="float2",t[t.float2Array=3]="float2Array",t[t.float3=4]="float3",t[t.float3Array=5]="float3Array",t[t.float4=6]="float4",t[t.float4Array=7]="float4Array",t[t.matrix2d=8]="matrix2d",t[t.matrix3d=9]="matrix3d",t[t.matrix4d=10]="matrix4d",t[t.int=11]="int",t[t.intArray=12]="intArray",t[t.int2=13]="int2",t[t.int2Array=14]="int2Array",t[t.int3=15]="int3",t[t.int3Array=16]="int3Array",t[t.int4=17]="int4",t[t.int4Array=18]="int4Array",t[t.sampler2D=19]="sampler2D"}(f=e.ShaderUniformType||(e.ShaderUniformType={}));var d=function(){function t(e,n,i){(0,o.default)(this,t),this._value=null,this.name=e,this.type=n,this._value=i}return(0,s.default)(t,[{key:"value",get:function(){return this._value},set:function(t){this.value!=t&&(this._value=t,this._shader.dirty=!0,this.dirty=!0)}},{key:"shader",set:function(t){this._shader=t}}]),t}();e.ShaderUniform=d,function(t){t[t.Position=0]="Position",t[t.Texcoord=1]="Texcoord",t[t.Color=2]="Color"}(e.ShaderAttributeType||(e.ShaderAttributeType={}));var p=function t(e,n){(0,o.default)(this,t),this.name=e,this.type=n};e.ShaderAttribute=p,e.setGLUniformValue={},e.setGLUniformValue[f.float]=function(t,e,n){t.uniform1f(e,n)},e.setGLUniformValue[f.float2]=function(t,e,n){n instanceof c.Vector?t.uniform2f(e,n.x,n.y):t.uniform2f(e,n[0],n[1])},e.setGLUniformValue[f.float3]=function(t,e,n){t.uniform3f(e,n[0],n[1],n[2])},e.setGLUniformValue[f.float4]=function(t,e,n){t.uniform4f(e,n[0],n[1],n[2],n[3])},e.setGLUniformValue[f.floatArray]=function(t,e,n){t.uniform1fv(e,n)},e.setGLUniformValue[f.float2Array]=function(t,e,n){t.uniform2fv(e,n)},e.setGLUniformValue[f.float3Array]=function(t,e,n){t.uniform3fv(e,n)},e.setGLUniformValue[f.float4Array]=function(t,e,n){t.uniform4fv(e,n)},e.setGLUniformValue[f.int]=function(t,e,n){t.uniform1i(e,n)},e.setGLUniformValue[f.int2]=function(t,e,n){n instanceof c.Vector?t.uniform2i(e,Math.round(n.x),Math.round(n.y)):t.uniform2i(e,n[0],n[1])},e.setGLUniformValue[f.int3]=function(t,e,n){t.uniform3i(e,n[0],n[1],n[2])},e.setGLUniformValue[f.int4]=function(t,e,n){t.uniform4i(e,n[0],n[1],n[2],n[3])},e.setGLUniformValue[f.intArray]=function(t,e,n){t.uniform1iv(e,n)},e.setGLUniformValue[f.int2Array]=function(t,e,n){t.uniform2iv(e,n)},e.setGLUniformValue[f.int3Array]=function(t,e,n){t.uniform3iv(e,n)},e.setGLUniformValue[f.int4Array]=function(t,e,n){t.uniform4iv(e,n)},e.setGLUniformValue[f.matrix2d]=function(t,e,n){t.uniformMatrix2fv(e,!1,n)},e.setGLUniformValue[f.matrix3d]=function(t,e,n){n instanceof l.Matrix?t.uniformMatrix3fv(e,!1,n.mat):t.uniformMatrix3fv(e,!1,n)},e.setGLUniformValue[f.matrix4d]=function(t,e,n){t.uniformMatrix2fv(e,!1,n)}},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a),u=n(2),l=i(u),c=n(3),h=i(c),f=n(4),d=i(f),p=function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===("undefined"==typeof Reflect?"undefined":(0,d.default)(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(e,"__esModule",{value:!0});var y=n(14),v=n(10);n(11);var Mover=function(t){function Mover(){return(0,o.default)(this,Mover),(0,l.default)(this,(Mover.__proto__||Object.getPrototypeOf(Mover)).apply(this,arguments))}return(0,h.default)(Mover,t),(0,s.default)(Mover,[{key:"update",value:function(){this.physics.speed.set(this.opts.x,this.opts.y)}},{key:"setDelta",value:function(t,e){this.opts.x=t,this.opts.y=e}}]),Mover}(v.AutoComponent);p([v.AutoComponent.require,function(t,e){if("object"===("undefined"==typeof Reflect?"undefined":(0,d.default)(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:type",y.Physics)],Mover.prototype,"physics",void 0),Mover=p([v.AutoComponent.register],Mover),e.Mover=Mover},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(1),o=i(r),a=n(6),s=i(a),u=n(0),l=i(u),c=n(2),h=i(c),f=n(3),d=i(f),p=n(4),y=i(p),v=function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===("undefined"==typeof Reflect?"undefined":(0,y.default)(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},g=function(t,e){if("object"===("undefined"==typeof Reflect?"undefined":(0,y.default)(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var m=n(5),_=n(14),b=n(12),x=n(9),w=n(26),k=n(7),O=n(31),S=n(15),E=n(16),T=n(77),P=n(117),TopDownDirection=function(t){function TopDownDirection(){(0,l.default)(this,TopDownDirection);var t=(0,h.default)(this,(TopDownDirection.__proto__||Object.getPrototypeOf(TopDownDirection)).apply(this,arguments));return t.direction=new k.Vector(1,0),t}return(0,d.default)(TopDownDirection,t),TopDownDirection}(m.Component);TopDownDirection=v([m.Component.register],TopDownDirection),e.TopDownDirection=TopDownDirection;var FreezingShot=function(t){function FreezingShot(t){var e=t.shotSpeed;(0,l.default)(this,FreezingShot);var n=(0,h.default)(this,(FreezingShot.__proto__||Object.getPrototypeOf(FreezingShot)).call(this));return n.shotSpeed=10,n.shots=[],n.shotSpeed=void 0!==e?e:n.shotSpeed,n}return(0,d.default)(FreezingShot,t),(0,o.default)(FreezingShot,[{key:"addedToScene",value:function(){(0,s.default)(FreezingShot.prototype.__proto__||Object.getPrototypeOf(FreezingShot.prototype),"addedToScene",this).call(this),this.bodySprite=this.entity.getComponentByName("body"),this.mouthSprite=this.entity.getComponentByName("mouth"),this.mouthSprite.visible=!1}},{key:"update",value:function(){if(w.Keyboard.pressed(S.Game.KEYS.SHOOT)){var t=this.bodySprite.scale.x<0;if(this.mouthSprite.x=t?7:9,this.mouthSprite.visible=!0,this.mouthSprite.play("close",!0),this.shots.length>0)this.fireShot(this.shots.splice(0,1)[0]);else if(S.Game.cheats.unlimitedAmmo)this.fireShot("ice");else{var e=this.sceneX+(t?-17:17),n=this.scene.add(E.instantiatePrefab("empty_breath",null,e,this.sceneY));t&&(n.find(x.Sprite).flipX=!0)}}}},{key:"fireShot",value:function(t){var e=this,n=void 0;switch(t){case"ice":n="blue_orb";break;case"mimic":n="grey_orb";break;default:throw Error(n)}var i=this.scene.add(E.instantiatePrefab(n,null,this.physics.sceneCenterX,this.physics.sceneCenterY)),r=i.find(T.Mover),o=this.topDownDirection.direction,a=o.x,s=o.y,u=void 0;if("ice"===t){u=300;var l=!1;i.find(_.Physics).onCollide.push(function(t,e){var n=e.entity?e.entity.find(P.Freezable):null;n&&!l&&(l=!0,n.freeze())})}else{if("mimic"!==t)throw Error(t);u=120;var c=!1;i.group("player");var h=i.find(_.Physics);h.onCollide.push(function(t,n){if(!c){c=!0;var i=k.Vector.temp0.set(h.sceneCenterX,h.sceneCenterY).sub(k.Vector.temp2.set(12,12)).add(k.Vector.temp1.set(12*-a,12*-s)),r=e.scene.add(new O.Player,i),o=r.find(x.Sprite);_.Tween.create(r).start(.2,.5,1,k.Ease.cubeOut,function(t){o.scale.set(t,t)},!0).restart()}})}r.setDelta(a*u,s*u)}},{key:"didPickupHeart",value:function(t){this.shots.push(t.type)}},{key:"shotsLeft",get:function(){return this.shots.length}}]),FreezingShot}(m.Component);v([m.Component.require,g("design:type",TopDownDirection)],FreezingShot.prototype,"topDownDirection",void 0),v([m.Component.require,g("design:type",_.Physics)],FreezingShot.prototype,"physics",void 0),FreezingShot=v([m.Component.register,g("design:paramtypes",[Object])],FreezingShot),e.FreezingShot=FreezingShot;var TopDownControls=function(t){function TopDownControls(t){var e=t.maxSpeed;(0,l.default)(this,TopDownControls);var n=(0,h.default)(this,(TopDownControls.__proto__||Object.getPrototypeOf(TopDownControls)).call(this));return n.movingEnabled=!0,n.maxSpeed=55,n.addedSpeed=new k.Vector(0,0),n.maxSpeed=e,n}return(0,d.default)(TopDownControls,t),(0,o.default)(TopDownControls,[{key:"addedToScene",value:function(){var t=this;(0,s.default)(TopDownControls.prototype.__proto__||Object.getPrototypeOf(TopDownControls.prototype),"addedToScene",this).call(this),this.physics.onCollideX=function(){t.physics.speed.x=0},this.physics.onCollideY=function(){t.physics.speed.y=0}}},{key:"unstick",value:function(){var t=this.physics,e=["water_solid","solid"],n=t.collideAllMulti(e),i=t.sceneBounds.getCenter(k.Vector.temp0);if(n.length>0){var r=n[0],o=void 0;if(r instanceof b.Hitgrid){var a=[[t.collideAllMulti(e,-t.width,0).length,[-1,0]],[t.collideAllMulti(e,t.width,0).length,[1,0]],[t.collideAllMulti(e,0,-t.height).length,[0,-1]],[t.collideAllMulti(e,0,t.height).length,[0,1]]];a.sort(function(t,e){return k.Calc.cmp(t[0],e[0])}),o=a[0][1]}else if(r instanceof b.Hitbox){var s=[Math.abs(i.x-r.sceneLeft),[-1,0]],u=[Math.abs(i.x-r.sceneRight),[1,0]],l=[Math.abs(i.x-r.sceneTop),[0,-1]],c=[Math.abs(i.x-r.sceneBottom),[0,1]],h=[s,u,l,c];h.sort(function(t,e){return k.Calc.cmp(t[0],e[0])}),o=h[0][1]}t.entity.position.add(k.Vector.temp1.set(o[0],o[1]))}}},{key:"update",value:function(){(0,s.default)(TopDownControls.prototype.__proto__||Object.getPrototypeOf(TopDownControls.prototype),"update",this).call(this);var t=this.maxSpeed,e=285*m.Engine.delta,n=this.addedSpeed.set(0,0);if(this.movingEnabled){n.set((w.Keyboard.check(S.Game.KEYS.LEFT)?-e:0)+(w.Keyboard.check(S.Game.KEYS.RIGHT)?e:0),(w.Keyboard.check(S.Game.KEYS.UP)?-e:0)+(w.Keyboard.check(S.Game.KEYS.DOWN)?e:0));var i=this.entity.find(TopDownDirection);0===n.x&&0===n.y||(Math.abs(n.x)>Math.abs(n.y)?i.direction.set(n.x>0?1:-1,0):i.direction.set(0,n.y>0?1:-1))}this.physics.speed.add(n),this.physics.friction(0===n.x?245:0,0===n.y?245:0),this.physics.circularMaxspeed(t);var r=k.Calc.sign(this.physics.speed.x);0!==r&&(this.sprite.scale.x=r,this.sprite.x=r>0?0:this.sprite.width),this.movingEnabled&&this.sprite.play(this.physics.speed.length>0?"walk":"idle"),this.unstick()}}]),TopDownControls}(m.Component);v([m.Component.require,g("design:type",_.Physics)],TopDownControls.prototype,"physics",void 0),v([m.Component.require,g("design:type",x.Sprite)],TopDownControls.prototype,"sprite",void 0),v([m.Component.require,g("design:type",TopDownDirection)],TopDownControls.prototype,"topDownDirection",void 0),TopDownControls=v([m.Component.register,g("design:paramtypes",[Object])],TopDownControls),e.TopDownControls=TopDownControls},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a),u=n(2),l=i(u),c=n(6),h=i(c),f=n(3),d=i(f),p=n(4),y=i(p);Object.defineProperty(e,"__esModule",{value:!0});var v=n(10),g=n(9),m=n(7),_=n(35),StaticGraphic=function(t){function StaticGraphic(){return(0,o.default)(this,StaticGraphic),(0,l.default)(this,(StaticGraphic.__proto__||Object.getPrototypeOf(StaticGraphic)).apply(this,arguments))}return(0,d.default)(StaticGraphic,t),(0,s.default)(StaticGraphic,[{key:"addedToScene",value:function(){(0,h.default)(StaticGraphic.prototype.__proto__||Object.getPrototypeOf(StaticGraphic.prototype),"addedToScene",this).call(this);var t="string"==typeof this.opts.texture?_.Assets.atlases.sprites.get(this.opts.texture):this.opts.texture;this.entity.add(new g.Graphic(t,new m.Vector(this.opts.x,this.opts.y)))}}]),StaticGraphic}(v.AutoComponent);StaticGraphic=function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===("undefined"==typeof Reflect?"undefined":(0,y.default)(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a}([v.AutoComponent.register],StaticGraphic),e.StaticGraphic=StaticGraphic},function(t,e,n){"use strict";var i=n(60),r=n(27),o=n(83),a=n(33),s=n(30),u=n(32),l=n(133),c=n(68),h=n(86),f=n(19)("iterator"),d=!([].keys&&"next"in[].keys()),p=function(){return this};t.exports=function(t,e,n,y,v,g,m){l(n,e,y);var _,b,x,w=function(t){if(!d&&t in E)return E[t];switch(t){case"keys":case"values":return function(){return new n(this,t)}}return function(){return new n(this,t)}},k=e+" Iterator",O="values"==v,S=!1,E=t.prototype,T=E[f]||E["@@iterator"]||v&&E[v],P=T||w(v),C=v?O?w("entries"):P:void 0,R="Array"==e?E.entries||T:T;if(R&&(x=h(R.call(new t)))!==Object.prototype&&(c(x,k,!0),i||s(x,f)||a(x,f,p)),O&&T&&"values"!==T.name&&(S=!0,P=function(){return T.call(this)}),i&&!m||!d&&!S&&E[f]||a(E,f,P),u[e]=P,u[k]=p,v)if(_={values:O?P:w("values"),keys:g?P:w("keys"),entries:C},m)for(b in _)b in E||o(E,b,_[b]);else r(r.P+r.F*(d||S),e,_);return _}},function(t,e,n){t.exports=!n(29)&&!n(38)(function(){return 7!=Object.defineProperty(n(82)("div"),"a",{get:function(){return 7}}).a})},function(t,e,n){var i=n(37),r=n(24).document,o=i(r)&&i(r.createElement);t.exports=function(t){return o?r.createElement(t):{}}},function(t,e,n){t.exports=n(33)},function(t,e,n){var i=n(30),r=n(23),o=n(135)(!1),a=n(65)("IE_PROTO");t.exports=function(t,e){var n,s=r(t),u=0,l=[];for(n in s)n!=a&&i(s,n)&&l.push(n);for(;e.length>u;)i(s,n=e[u++])&&(~o(l,n)||l.push(n));return l}},function(t,e,n){var i=n(64),r=Math.min;t.exports=function(t){return t>0?r(i(t),9007199254740991):0}},function(t,e,n){var i=n(30),r=n(69),o=n(65)("IE_PROTO"),a=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=r(t),i(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?a:null}},function(t,e,n){var i=n(58),r=n(19)("toStringTag"),o="Arguments"==i(function(){return arguments}()),a=function(t,e){try{return t[e]}catch(t){}};t.exports=function(t){var e,n,s;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=a(e=Object(t),r))?n:o?i(e):"Object"==(s=i(e))&&"function"==typeof e.callee?"Arguments":s}},function(t,e,n){var i=n(87),r=n(19)("iterator"),o=n(32);t.exports=n(18).getIteratorMethod=function(t){if(void 0!=t)return t[r]||t["@@iterator"]||o[i(t)]}},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,n){var i=n(84),r=n(67).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return i(t,r)}},function(t,e){function n(){throw Error("setTimeout has not been defined")}function i(){throw Error("clearTimeout has not been defined")}function r(t){if(c===setTimeout)return setTimeout(t,0);if((c===n||!c)&&setTimeout)return c=setTimeout,setTimeout(t,0);try{return c(t,0)}catch(e){try{return c.call(null,t,0)}catch(e){return c.call(this,t,0)}}}function o(t){if(h===clearTimeout)return clearTimeout(t);if((h===i||!h)&&clearTimeout)return h=clearTimeout,clearTimeout(t);try{return h(t)}catch(e){try{return h.call(null,t)}catch(e){return h.call(this,t)}}}function a(){y&&d&&(y=!1,d.length?p=d.concat(p):v=-1,p.length&&s())}function s(){if(!y){var t=r(a);y=!0;for(var e=p.length;e;){for(d=p,p=[];++v<e;)d&&d[v].run();v=-1,e=p.length}d=null,y=!1,o(t)}}function u(t,e){this.fun=t,this.array=e}function l(){}var c,h,f=t.exports={};!function(){try{c="function"==typeof setTimeout?setTimeout:n}catch(t){c=n}try{h="function"==typeof clearTimeout?clearTimeout:i}catch(t){h=i}}();var d,p=[],y=!1,v=-1;f.nextTick=function(t){var e=Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];p.push(new u(t,e)),1!==p.length||y||r(s)},u.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=l,f.addListener=l,f.once=l,f.off=l,f.removeListener=l,f.removeAllListeners=l,f.emit=l,f.prependListener=l,f.prependOnceListener=l,f.listeners=function(t){return[]},f.binding=function(t){throw Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(t){throw Error("process.chdir is not supported")},f.umask=function(){return 0}},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a);Object.defineProperty(e,"__esModule",{value:!0});var u=n(8),l=n(7),c=n(48),h=n(161),f=function(){function t(e,n){if((0,o.default)(this,t),this.sound=null,this.started=!1,this.groups=[],this.fadePercent=1,this.fadeDuration=1,this._loop=!1,this._paused=!1,this._muted=!1,this._volume=1,this.source=c.Assets.sounds[e],n&&n.length>0){var i=!0,r=!1,a=void 0;try{for(var s,u=n[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var l=s.value;this.group(l)}}catch(t){r=!0,a=t}finally{try{!i&&u.return&&u.return()}finally{if(r)throw a}}}}return(0,s.default)(t,[{key:"play",value:function(t){if(this.loop=t,null!=this.sound&&this.started)this.sound.currentTime=0,this._paused&&this.resume();else if(this.sound=this.source.requestSound(),null!=this.sound)if(this.sound.readyState<3){var e=this;e.loadedEvent=function(){null!=e.sound&&e.internalPlay(),e.sound.removeEventListener("loadeddata",e.loadedEvent),e.loadedEvent=null},this.sound.addEventListener("loadeddata",e.loadedEvent)}else this.internalPlay();return this}},{key:"resume",value:function(){return this.started&&this._paused&&this.sound.play(),this._paused=!1,this}},{key:"pause",value:function(){return this.started&&!this._paused&&this.sound.pause(),this._paused=!0,this}},{key:"stop",value:function(){if(null!=this.sound){this.source.returnSound(this.sound),this.started&&(this.sound.pause(),this.sound.currentTime=0,this.sound.volume=1,this.sound.muted=!1,this.sound.removeEventListener("ended",this.endEvent),null!=this.loadedEvent&&this.sound.removeEventListener("loadeddata",this.loadedEvent)),this.sound=null,this.started=!1,this._paused=!1,this.fadePercent=1;var e=t.active.indexOf(this);e>=0&&t.active.splice(e,1)}return this}},{key:"group",value:function(t){return this.groups.push(t),this.internalUpdateVolume(),this.internalUpdateMuted(),this}},{key:"ungroup",value:function(t){var e=this.groups.indexOf(t);return e>=0&&(this.groups.splice(e,1),this.internalUpdateVolume(),this.internalUpdateMuted()),this}},{key:"ungroupAll",value:function(){return this.groups=[],this.internalUpdateVolume(),this.internalUpdateMuted(),this}},{key:"ingroup",value:function(t){return this.groups.indexOf(t)>=0}},{key:"internalPlay",value:function(){this.started=!0,t.active.push(this);var e=this;this.endEvent=function(){e.stop()},this.sound.addEventListener("ended",this.endEvent),this.sound.loop=this.loop,this.internalUpdateVolume(),this.internalUpdateMuted(),this._paused||this.sound.play()}},{key:"internalUpdateVolume",value:function(){if(this.started){var t=1,e=!0,n=!1,i=void 0;try{for(var r,o=this.groups[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var a=r.value;t*=h.AudioGroup.volume(a)}}catch(t){n=!0,i=t}finally{try{!e&&o.return&&o.return()}finally{if(n)throw i}}this.sound.volume=this._volume*t*u.Engine.volume}}},{key:"internalUpdateMuted",value:function(){if(this.started){for(var t=!1,e=0;e<this.groups.length&&!t;e++)t=t||h.AudioGroup.muted(this.groups[e]);this.sound.muted=u.Engine.muted||this._muted||t}}},{key:"update",value:function(){this.fadePercent<1&&(this.fadePercent=l.Calc.approach(this.fadePercent,1,u.Engine.delta/this.fadeDuration),this.volume=this.fadeFrom+(this.fadeTo-this.fadeFrom)*this.fadeEase(this.fadePercent))}},{key:"fade",value:function(t,e,n){return this.fadeFrom=this.volume,this.fadeTo=t,this.fadeDuration=Math.max(.001,e),this.fadeEase=void 0!=n?n:function(t){return t},this.fadePercent=0,this}},{key:"playing",get:function(){return this.started&&!this._paused}},{key:"loop",get:function(){return this._loop},set:function(t){this._loop=t,this.started&&(this.sound.loop=this._loop)}},{key:"paused",get:function(){return this._paused}},{key:"muted",get:function(){return this._muted},set:function(t){this._muted=t,this.internalUpdateMuted()}},{key:"volume",get:function(){return this._volume},set:function(t){this._volume=t,this.internalUpdateVolume()}}]),t}();f.active=[],e.Sound=f},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a);Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(){(0,o.default)(this,t)}return(0,s.default)(t,null,[{key:"linear",value:function(t){return t}},{key:"quadIn",value:function(t){return t*t}},{key:"quadOut",value:function(e){return 1-t.quadIn(1-e)}},{key:"quadInOut",value:function(e){return e<=.5?t.quadIn(2*e)/2:t.quadOut(2*e-1)/2+.5}},{key:"cubeIn",value:function(t){return t*t*t}},{key:"cubeOut",value:function(e){return 1-t.cubeIn(1-e)}},{key:"cubeInOut",value:function(e){return e<=.5?t.cubeIn(2*e)/2:t.cubeOut(2*e-1)/2+.5}},{key:"backIn",value:function(t){return t*t*(2.70158*t-1.70158)}},{key:"backOut",value:function(e){return 1-t.backIn(1-e)}},{key:"backInOut",value:function(e){return e<=.5?t.backIn(2*e)/2:t.backOut(2*e-1)/2+.5}},{key:"expoIn",value:function(t){return Math.pow(2,10*(t-1))}},{key:"expoOut",value:function(e){return 1-t.expoIn(e)}},{key:"expoInOut",value:function(e){return e<.5?t.expoIn(2*e)/2:t.expoOut(2*e)/2}},{key:"sineIn",value:function(t){return 1-Math.cos(Math.PI/2*t)}},{key:"sineOut",value:function(t){return Math.sin(Math.PI/2*t)}},{key:"sineInOut",value:function(t){return-Math.cos(Math.PI*t)/2+.5}},{key:"elasticInOut",value:function(t){if(2==(t/=.5))return 1;var e=.3*1.5,n=e/4;return t<1?Math.pow(2,10*(t-=1))*Math.sin((t-n)*(2*Math.PI)/e)*-.5:Math.pow(2,-10*(t-=1))*Math.sin((t-n)*(2*Math.PI)/e)*.5+1}},{key:"arc",value:function(t,e){return t<.5?1-e(1-2*t):1-e(2*(t-.5))}}]),t}();e.Ease=u},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a),u=n(2),l=i(u),c=n(3),h=i(c);Object.defineProperty(e,"__esModule",{value:!0});var f=n(8),d=n(20),p=n(22),y=n(13),v=n(40),g=new y.Vector,Hitbox=function(t){function Hitbox(t){var e=t.left,n=t.top,i=t.width,r=t.height,a=t.tags;(0,o.default)(this,Hitbox);var s=(0,l.default)(this,(Hitbox.__proto__||Object.getPrototypeOf(Hitbox)).call(this));if(s.debugColor=new d.Color(1,0,0,.6),s.type=Hitbox.name,s.left=e,s.top=n,s.width=i,s.height=r,void 0!==a){var u=!0,c=!1,h=void 0;try{for(var f,p=a[Symbol.iterator]();!(u=(f=p.next()).done);u=!0){var y=f.value;s.tag(y)}}catch(t){c=!0,h=t}finally{try{!u&&p.return&&p.return()}finally{if(c)throw h}}}return s}return(0,h.default)(Hitbox,t),(0,s.default)(Hitbox,[{key:"setTop",value:function(t){var e=this.top+this.height;this.top=t,this.height=e-this.top}},{key:"setLeft",value:function(t){var e=this.left+this.width;this.left=t,this.width=e-this.left}},{key:"getSceneBounds",value:function(t){return t.set(this.sceneLeft,this.sceneTop,this.width,this.height),t}},{key:"debugRender",value:function(){this.debugColor&&this.active&&f.Engine.graphics.hollowRect(this.sceneLeft,this.sceneTop,this.width,this.height,1,this.debugColor)}},{key:"sceneCenterX",get:function(){return this.getScenePosition(g).x+this.left+this.width/2}},{key:"sceneCenterY",get:function(){return this.getScenePosition(g).y+this.top+this.height/2}},{key:"sceneLeft",get:function(){return this.sceneX+this.left}},{key:"sceneRight",get:function(){return this.sceneX+this.left+this.width}},{key:"sceneTop",get:function(){return this.sceneY+this.top}},{key:"sceneBottom",get:function(){return this.sceneY+this.top+this.height}},{key:"sceneBounds",get:function(){return new p.Rectangle(this.sceneLeft,this.sceneTop,this.width,this.height)}}]),Hitbox}(v.Collider);e.Hitbox=Hitbox},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(52),o=i(r),a=n(0),s=i(a),u=n(1),l=i(u),c=n(2),h=i(c),f=n(3),d=i(f);Object.defineProperty(e,"__esModule",{value:!0});var p=(n(8),n(20)),y=n(40),Hitgrid=function(t){function Hitgrid(t,e,n){(0,s.default)(this,Hitgrid);var i=(0,h.default)(this,(Hitgrid.__proto__||Object.getPrototypeOf(Hitgrid)).call(this));if(i.map={},i.debugSub=new p.Color(200,200,200,.5),i.lineColor=new p.Color(1,0,0,.5),i.type=Hitgrid.name,i.tileWidth=t,i.tileHeight=e,void 0!==n){var r=!0,o=!1,a=void 0;try{for(var u,l=n[Symbol.iterator]();!(r=(u=l.next()).done);r=!0){var c=u.value;i.tag(c)}}catch(t){o=!0,a=t}finally{try{!r&&l.return&&l.return()}finally{if(o)throw a}}}return i}return(0,d.default)(Hitgrid,t),(0,l.default)(Hitgrid,[{key:"tiles",value:o.default.mark(function t(){var e,n;return o.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=o.default.keys(this.map);case 1:if((t.t1=t.t0()).done){t.next=13;break}e=t.t1.value,t.t2=o.default.keys(this.map[e]);case 4:if((t.t3=t.t2()).done){t.next=11;break}if(n=t.t3.value,!this.map[e][n]){t.next=9;break}return t.next=9,[parseInt(e,10),parseInt(n,10)];case 9:t.next=4;break;case 11:t.next=1;break;case 13:case"end":return t.stop()}},t,this)})},{key:"set",value:function(t,e,n,i,r){for(var o=e;o<e+(i||1);o++){void 0===this.map[o]&&(this.map[o]={});for(var a=n;a<n+(r||1);a++)t?this.map[o][a]=t:delete this.map[o][a]}}},{key:"has",value:function(t,e,n,i){for(var r=t;r<t+(n||1);r++)if(void 0!==this.map[r])for(var o=e;o<e+(i||1);o++)if(1==this.map[r][o])return!0;return!1}},{key:"debugRender",value:function(t){}}]),Hitgrid}(y.Collider);e.Hitgrid=Hitgrid},function(t,e,n){(function(e){var i=n(97),r=n(98),o=r.join(e,"path.txt");if(!i.existsSync(o))throw Error("Electron failed to install correctly, please delete node_modules/electron and try installing again");t.exports=r.join(e,i.readFileSync(o,"utf-8"))}).call(e,"/")},function(t,e){},function(t,e,n){(function(t){function n(t,e){for(var n=0,i=t.length-1;i>=0;i--){var r=t[i];"."===r?t.splice(i,1):".."===r?(t.splice(i,1),n++):n&&(t.splice(i,1),n--)}if(e)for(;n--;n)t.unshift("..");return t}function i(t,e){if(t.filter)return t.filter(e);for(var n=[],i=0;i<t.length;i++)e(t[i],i,t)&&n.push(t[i]);return n}var r=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,o=function(t){return r.exec(t).slice(1)};e.resolve=function(){for(var e="",r=!1,o=arguments.length-1;o>=-1&&!r;o--){var a=o>=0?arguments[o]:t.cwd();if("string"!=typeof a)throw new TypeError("Arguments to path.resolve must be strings");a&&(e=a+"/"+e,r="/"===a.charAt(0))}return e=n(i(e.split("/"),function(t){return!!t}),!r).join("/"),(r?"/":"")+e||"."},e.normalize=function(t){var r=e.isAbsolute(t),o="/"===a(t,-1);return t=n(i(t.split("/"),function(t){return!!t}),!r).join("/"),t||r||(t="."),t&&o&&(t+="/"),(r?"/":"")+t},e.isAbsolute=function(t){return"/"===t.charAt(0)},e.join=function(){var t=Array.prototype.slice.call(arguments,0);return e.normalize(i(t,function(t,e){if("string"!=typeof t)throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))},e.relative=function(t,n){function i(t){for(var e=0;e<t.length&&""===t[e];e++);for(var n=t.length-1;n>=0&&""===t[n];n--);return e>n?[]:t.slice(e,n-e+1)}t=e.resolve(t).substr(1),n=e.resolve(n).substr(1);for(var r=i(t.split("/")),o=i(n.split("/")),a=Math.min(r.length,o.length),s=a,u=0;u<a;u++)if(r[u]!==o[u]){s=u;break}for(var l=[],u=s;u<r.length;u++)l.push("..");return l=l.concat(o.slice(s)),l.join("/")},e.sep="/",e.delimiter=":",e.dirname=function(t){var e=o(t),n=e[0],i=e[1];return n||i?(i&&(i=i.substr(0,i.length-1)),n+i):"."},e.basename=function(t,e){var n=o(t)[2];return e&&n.substr(-1*e.length)===e&&(n=n.substr(0,n.length-e.length)),n},e.extname=function(t){return o(t)[3]};var a="b"==="ab".substr(-1)?function(t,e,n){return t.substr(e,n)}:function(t,e,n){return e<0&&(e=t.length+e),t.substr(e,n)}}).call(e,n(91))},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a);Object.defineProperty(e,"__esModule",{value:!0});var u=n(8),l=n(100),c=function(){function t(e,n,i,r,a){(0,o.default)(this,t),this.texture=n,this.frameBuffer=e,this.vertexBuffer=i,this.colorBuffer=r,this.texcoordBuffer=a}return(0,s.default)(t,[{key:"width",get:function(){return this.texture.width}},{key:"height",get:function(){return this.texture.height}}]),(0,s.default)(t,[{key:"dispose",value:function(){this.texture.dispose(),this.texture=null;var t=u.Engine.graphics.gl;t.deleteFramebuffer(this.frameBuffer),t.deleteBuffer(this.vertexBuffer),t.deleteBuffer(this.texcoordBuffer),t.deleteBuffer(this.colorBuffer),this.frameBuffer=null,this.vertexBuffer=null,this.texcoordBuffer=null,this.colorBuffer=null}}],[{key:"create",value:function(e,n){var i=u.Engine.graphics.gl,r=i.createFramebuffer(),o=i.createTexture();i.bindFramebuffer(i.FRAMEBUFFER,r),i.bindTexture(i.TEXTURE_2D,o),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,e,n,0,i.RGBA,i.UNSIGNED_BYTE,null),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,o,0);var a=i.createBuffer(),s=i.createBuffer(),c=i.createBuffer();return i.bindTexture(i.TEXTURE_2D,null),i.bindFramebuffer(i.FRAMEBUFFER,null),new t(r,new l.FosterWebGLTexture(o,e,n),a,c,s)}}]),t}();e.RenderTarget=c},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a);Object.defineProperty(e,"__esModule",{value:!0});var u=n(8),l=function(){function t(e,n,i){(0,o.default)(this,t),this.disposed=!1,this.webGLTexture=e,this.width=n,this.height=i}return(0,s.default)(t,[{key:"dispose",value:function(){this.disposed||(u.Engine.graphics.gl.deleteTexture(this.webGLTexture),this.path="",this.webGLTexture=null,this.width=1,this.height=1,this.disposed=!0)}}]),t}();e.FosterWebGLTexture=l},function(t,e,n){"use strict";(function(t){function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a);Object.defineProperty(e,"__esModule",{value:!0});var u=n(8),l=function(){function e(){(0,o.default)(this,e)}return(0,s.default)(e,null,[{key:"init",value:function(){null===e.fs&&u.Engine.client===u.Client.Desktop&&(e.fs=n(97),e.path=n(98))}},{key:"read",value:function(n,i){if(u.Engine.client===u.Client.Desktop)e.fs.readFile(e.path.join(t,n),"utf8",function(t,e){if(t)throw t;i(e)});else{var r=new XMLHttpRequest;r.onreadystatechange=function(t){if(r.readyState===XMLHttpRequest.DONE){if(200!==r.status)throw Error("Unable to read file "+n);i(r.responseText)}},r.open("GET",n),r.send()}}},{key:"join",value:function(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];if(n.length<=0)return".";if(u.Engine.client===u.Client.Desktop){for(var r=n[0],o=1;o<n.length;o++)r=e.path.join(r,n[o]);return r}var a=[],s=!0,l=!1,c=void 0;try{for(var h,f=n[Symbol.iterator]();!(s=(h=f.next()).done);s=!0){var d=h.value,p=d.split("/"),y=!0,v=!1,g=void 0;try{for(var m,_=p[Symbol.iterator]();!(y=(m=_.next()).done);y=!0){var b=m.value;a.push(b)}}catch(t){v=!0,g=t}finally{try{!y&&_.return&&_.return()}finally{if(v)throw g}}}}catch(t){l=!0,c=t}finally{try{!s&&f.return&&f.return()}finally{if(l)throw c}}return a.length>0?a.join("/"):"."}},{key:"extension",value:function(t){var e="",n=/(?:\.([^.]+))?$/.exec(t);return n.length>1&&(e=n[1]),e}}]),e}();l.fs=null,l.path=null,e.FosterIO=l}).call(e,"/")},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(2),s=i(a),u=n(3),l=i(u);Object.defineProperty(e,"__esModule",{value:!0});var c=n(103),h=n(51),f=function(t){function e(){(0,o.default)(this,e);var t=(0,s.default)(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.shader=h.Shaders.texture,t.shaderCameraUniformName="matrix",t}return(0,l.default)(e,t),e}(c.Renderer);e.SpriteRenderer=f},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a);Object.defineProperty(e,"__esModule",{value:!0});var u=n(8),l=n(20),c=function(){function t(){(0,o.default)(this,t),this.sortOrder=0,this.visible=!0,this.target=null,this.clearTargetColor=new l.Color(0,0,0,0),this.scene=null,this.groupsMask=[]}return(0,s.default)(t,[{key:"update",value:function(){}},{key:"preRender",value:function(){}},{key:"render",value:function(){return this.drawBegin(),this.drawEntities()}},{key:"drawBegin",value:function(){null!=this.target?(u.Engine.graphics.setRenderTarget(this.target),u.Engine.graphics.clear(this.clearTargetColor)):u.Engine.graphics.setRenderTarget(u.Engine.graphics.buffer),u.Engine.graphics.shader=this.shader,u.Engine.graphics.shader.set(this.shaderCameraUniformName,this.getActiveCamera().matrix)}},{key:"getEntitiesToRender",value:function(){return this.groupsMask.length>0?this.scene.allInGroups(this.groupsMask):this.scene.entities}},{key:"drawEntities",value:function(){var t=this.getActiveCamera(),e=0;return this.getEntitiesToRender().each(function(n){n.visible&&(n.render(t),++e)}),e}},{key:"getActiveCamera",value:function(){return this.camera||this.scene.camera}},{key:"postRender",value:function(){}},{key:"dispose",value:function(){null!=this.target&&this.target.dispose(),this.target=null}}]),t}();e.Renderer=c},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(17),o=i(r),a=n(34),s=i(a),u=n(0),l=i(u),c=n(1),h=i(c);Object.defineProperty(e,"__esModule",{value:!0});var f=n(22),d=n(53),p=function(){function t(e,n,i,r){(0,l.default)(this,t),this.metadata={},this.subtextures={},this.name=e,this.texture=n,this.reader=r,this.data=i,this.reader(i,this)}return(0,h.default)(t,[{key:"get",value:function(t){var e=this.subtextures[t];if(!e)throw Error("no texture "+t);return e}},{key:"has",value:function(t){return void 0!==this.subtextures[t]}},{key:"list",value:function(t,e){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var u=a.value;n.push(this.get(t+u))}}catch(t){r=!0,o=t}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}return n}},{key:"find",value:function(t){var e=(arguments.length>1&&void 0!==arguments[1]&&arguments[1],[]);for(var n in this.subtextures)0===n.indexOf(t)&&e.push({name:n,tex:this.subtextures[n]});e.sort(function(t,e){return t.name<e.name?-1:t.name>e.name?1:0});var i=[],r=!0,o=!1,a=void 0;try{for(var s,u=e[Symbol.iterator]();!(r=(s=u.next()).done);r=!0){var l=s.value.tex;i.push(l)}}catch(t){o=!0,a=t}finally{try{!r&&u.return&&u.return()}finally{if(o)throw a}}return i}}]),t}();e.Atlas=p;var y=function(){function t(){(0,l.default)(this,t)}return(0,h.default)(t,null,[{key:"DoodleStudio",value:function(t,e){var n=JSON.parse(t),i="once"!==n.playbackMode,r=n.frames,o=0;"loopbackandforth"===n.playbackMode&&r.push.apply(r,(0,s.default)(r.slice(0,r.length-1).reverse()));var a=!0,u=!1,l=void 0;try{for(var c,h=r[Symbol.iterator]();!(a=(c=h.next()).done);a=!0){var p=c.value,y=p.rect,v=new f.Rectangle(y.x,y.y,y.width,y.height),g=new d.Texture(e.texture.texture,v);g.metadata.duration=p.duration,g.metadata.loops=i,e.subtextures["main "+o]=g,++o}}catch(t){u=!0,l=t}finally{try{!a&&h.return&&h.return()}finally{if(u)throw l}}}},{key:"Aseprite",value:function(t,e){var n=JSON.parse(t),i=n.frames,r=!0,a=!1,s=void 0;try{for(var u,l=Object.entries(i)[Symbol.iterator]();!(r=(u=l.next()).done);r=!0){var c=(0,o.default)(u.value,2),h=c[0],p=c[1],y=h.replace(".ase","").replace(".png",""),v=p.frame,g=void 0;if(p.trimmed){var m=p.spriteSourceSize,_=p.sourceSize;g=new d.Texture(e.texture.texture,new f.Rectangle(v.x,v.y,v.w,v.h),new f.Rectangle(-m.x,-m.y,_.w,_.h))}else g=new d.Texture(e.texture.texture,new f.Rectangle(v.x,v.y,v.w,v.h));void 0!==p.duration&&(g.metadata.duration=parseInt(p.duration,10)),e.subtextures[y]=g}}catch(t){a=!0,s=t}finally{try{!r&&l.return&&l.return()}finally{if(a)throw s}}e.metadata=n.meta}}]),t}();e.AtlasReaders=y},function(t,e,n){"use strict";function i(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),i(n(104)),i(n(99)),i(n(53))},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a);Object.defineProperty(e,"__esModule",{value:!0});var u=n(107),l=function(){function t(){(0,o.default)(this,t)}return(0,s.default)(t,null,[{key:"create",value:function(e){var n=new u.SpriteTemplate(e);return t.bank[e]=n,n}},{key:"get",value:function(e){return t.bank[e]}},{key:"has",value:function(e){return void 0!=t.bank[e]}}]),t}();l.bank={},e.SpriteBank=l},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a);Object.defineProperty(e,"__esModule",{value:!0});var u=n(22),l=n(108),c=function(){function t(e){(0,o.default)(this,t),this.animations={},this.name=e}return(0,s.default)(t,[{key:"toString",value:function(){return"<SpriteTemplate '"+this.name+"'>"}},{key:"add",value:function(t,e,n,i,r,o){var a=new l.SpriteAnimationTemplate(t,e,n,i,r,o);return this.animations[t]=a,null==this.first&&(this.first=a),this}},{key:"addFrameAnimation",value:function(t,e,n,i,r,o,a,s,c){for(var h=Math.floor(n.width/i),f=[],d=0;d<o.length;d++){var p=o[d],y=p%h*i,v=Math.floor(p/h)*i;f.push(n.getSubtexture(new u.Rectangle(y,v,i,r)))}var g=new l.SpriteAnimationTemplate(t,e,f,a,s,c);return this.animations[t]=g,null==this.first&&(this.first=g),this}},{key:"get",value:function(t){return this.animations[t]}},{key:"has",value:function(t){return void 0!==this.animations[t]}}]),t}();e.SpriteTemplate=c},function(t,e,n){"use strict";var i=n(0),r=function(t){return t&&t.__esModule?t:{default:t}}(i);Object.defineProperty(e,"__esModule",{value:!0});var o=n(13),a=function t(e,n,i,a,s,u){(0,r.default)(this,t),this.loops=!1,this.goto=null,this.name=e,this.speed=n,this.frames=i,this.loops=a||!1,this.position=s||new o.Vector(0,0),this.origin=u||new o.Vector(0,0)};e.SpriteAnimationTemplate=a},function(t,e,n){var i=n(27),r=n(18),o=n(38);t.exports=function(t,e){var n=(r.Object||{})[t]||Object[t],a={};a[t]=e(n),i(i.S+i.F*o(function(){n(1)}),"Object",a)}},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a),u=n(2),l=i(u),c=n(3),h=i(c);Object.defineProperty(e,"__esModule",{value:!0});var f=n(21),d=n(8),p=n(20),y=n(22),v=n(13),Graphic=function(t){function Graphic(t,e){(0,o.default)(this,Graphic);var n=(0,l.default)(this,(Graphic.__proto__||Object.getPrototypeOf(Graphic)).call(this));return n.scale=new v.Vector(1,1),n.origin=new v.Vector(0,0),n.rotation=0,n.flipX=!1,n.flipY=!1,n.color=p.Color.white.clone(),n.alpha=1,null!=t&&(n.texture=t,n.crop=new y.Rectangle(0,0,t.width,t.height)),e&&n.position.copy(e),n}return(0,h.default)(Graphic,t),(0,s.default)(Graphic,[{key:"toString",value:function(){return"<Graphic "+this.texture.bounds+" of "+this.texture.texture.path+">"}},{key:"center",value:function(){this.justify(.5,.5)}},{key:"justify",value:function(t,e){this.origin.set(this.width*t,this.height*e)}},{key:"render",value:function(t){d.Engine.graphics.texture(this.texture,this.scenePosition.x,this.scenePosition.y,this.crop,p.Color.temp.copy(this.color).mult(this.alpha),this.origin,this.scale,this.rotation,this.flipX,this.flipY,this.overrideWidth,this.overrideHeight)}},{key:"width",get:function(){return this.crop?this.crop.width:this.texture?this.texture.width:0}},{key:"height",get:function(){return this.crop?this.crop.height:this.texture?this.texture.height:0}},{key:"sceneCenterX",get:function(){return this.getScenePosition(Graphic.sp).x+this.width/2}},{key:"sceneCenterY",get:function(){return this.getScenePosition(Graphic.sp).y+this.height/2}}]),Graphic}(f.Component);Graphic.sp=new v.Vector,e.Graphic=Graphic},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){var n,i,r,o,a,s,l;return u.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:n=e.scenePosition,i=Math.floor((t.sceneLeft-n.x)/e.tileWidth),r=Math.floor((t.sceneTop-n.y)/e.tileHeight),o=Math.ceil((t.sceneRight-n.x)/e.tileWidth),a=Math.ceil((t.sceneBottom-n.y)/e.tileHeight),s=i;case 6:if(!(s<o)){u.next=18;break}l=r;case 8:if(!(l<a)){u.next=15;break}if(!e.has(s,l)){u.next=12;break}return u.next=12,new E.Hitbox({left:s*e.tileWidth+n.x,width:e.tileWidth,top:l*e.tileHeight+n.y,height:e.tileHeight});case 12:l++,u.next=8;break;case 15:s++,u.next=6;break;case 18:case"end":return u.stop()}},k[0],this)}function o(t,e){var n=[],i=!0,o=!1,a=void 0;try{for(var s,u=e[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var l=s.value;if(l instanceof E.Hitgrid){var c=!0,h=!1,f=void 0;try{for(var d,p=r(t,l)[Symbol.iterator]();!(c=(d=p.next()).done);c=!0){var y=d.value;n.push(y)}}catch(t){h=!0,f=t}finally{try{!c&&p.return&&p.return()}finally{if(h)throw f}}}else n.push(l)}}catch(t){o=!0,a=t}finally{try{!i&&u.return&&u.return()}finally{if(o)throw a}}return n}function a(t,e){switch(t){case"left":e.sort(function(t,e){return-S.Calc.cmp(t.sceneRight,e.sceneRight)});break;case"right":e.sort(function(t,e){return S.Calc.cmp(t.sceneLeft,e.sceneLeft)});break;case"up":e.sort(function(t,e){return-S.Calc.cmp(t.sceneBottom,e.sceneBottom)});break;case"down":e.sort(function(t,e){return S.Calc.cmp(t.sceneTop,e.sceneTop)});break;default:throw Error(t)}return e}var s=n(52),u=i(s),l=n(17),c=i(l),h=n(0),f=i(h),d=n(1),p=i(d),y=n(2),v=i(y),g=n(6),m=i(g),_=n(3),b=i(_),x=n(4),w=i(x),k=[r].map(u.default.mark);Object.defineProperty(e,"__esModule",{value:!0});var O=n(10),S=n(7),E=n(12);n(11);var T=["player","enemy_solid","solid","mimic_orb"],Awareness=function(t){function Awareness(){(0,f.default)(this,Awareness);var t=(0,v.default)(this,(Awareness.__proto__||Object.getPrototypeOf(Awareness)).apply(this,arguments));return t.xrayGroups=[],t.lookingFor="player",t.killing=[],t.wouldKill=!1,t.sightboxes={},t.killboxes={},t}return(0,b.default)(Awareness,t),(0,p.default)(Awareness,[{key:"update",value:function(){var t=this;this.killing.length=0,this.wouldKill=!1;var e=!0,n=!1,i=void 0;try{for(var r,s=Object.entries(this.killboxes)[Symbol.iterator]();!(e=(r=s.next()).done);e=!0){var u=(0,c.default)(r.value,2),l=u[0],h=u[1],f=a(l,o(h,h.collideAllMulti(T).filter(function(e){return e.entity!==t.entity})));if(f.length>0){var d=f[0];if(d.entity&&-1!==d.entity.groups.indexOf(this.lookingFor)){this.killing.push(d),this.wouldKill=!0;break}var p=!0,y=!1,v=void 0;try{for(var g,m=f[Symbol.iterator]();!(p=(g=m.next()).done);p=!0){var _=g.value;_.entity&&-1!==_.entity.groups.indexOf(this.lookingFor)&&(this.wouldKill=!0)}}catch(t){y=!0,v=t}finally{try{!p&&m.return&&m.return()}finally{if(y)throw v}}}}}catch(t){n=!0,i=t}finally{try{!e&&s.return&&s.return()}finally{if(n)throw i}}this.xrayGroups.length=0;var b=!0,x=!1,w=void 0;try{for(var k,O=Object.entries(this.sightboxes)[Symbol.iterator]();!(b=(k=O.next()).done);b=!0){var S=(0,c.default)(k.value,2),l=S[0],h=S[1],E=!0,P=!1,C=void 0;try{for(var R,j=h.collideAllMulti(T)[Symbol.iterator]();!(E=(R=j.next()).done);E=!0){var M=R.value,A=!0,L=!1,F=void 0;try{for(var B,D=M.entity.groups[Symbol.iterator]();!(A=(B=D.next()).done);A=!0){var G=B.value;this.xrayGroups.push(G)}}catch(t){L=!0,F=t}finally{try{!A&&D.return&&D.return()}finally{if(L)throw F}}}}catch(t){P=!0,C=t}finally{try{!E&&j.return&&j.return()}finally{if(P)throw C}}}}catch(t){x=!0,w=t}finally{try{!b&&O.return&&O.return()}finally{if(x)throw w}}}},{key:"addedToScene",value:function(){function t(t,n){t.down=d.add(new E.Hitbox({left:u-n/2+h/2,top:o,width:n,height:e})),t.up=d.add(new E.Hitbox({left:u-n/2+h/2,top:o-e,width:n,height:e})),t.left=d.add(new E.Hitbox({left:r-e,top:s-n/2+f/2,width:e,height:n})),t.right=d.add(new E.Hitbox({left:u,top:s-n/2+f/2,width:e,height:n}))}(0,m.default)(Awareness.prototype.__proto__||Object.getPrototypeOf(Awareness.prototype),"addedToScene",this).call(this),this.mainHitbox=this.entity.find(E.Hitbox);var e=330,n=this.getLookCenter(),i=(0,c.default)(n,2),r=i[0],o=i[1],a=[this.mainHitbox.top,this.mainHitbox.left],s=a[0],u=a[1],l=[this.mainHitbox.width,this.mainHitbox.height],h=l[0],f=l[1],d=this.entity;t(this.sightboxes,34),t(this.killboxes,4)}},{key:"getLookCenter",value:function(){var t=this.mainHitbox;return[t.left+t.width/2,t.top+t.height/2]}}]),Awareness}(O.AutoComponent);Awareness=function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===("undefined"==typeof Reflect?"undefined":(0,w.default)(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a}([O.AutoComponent.register],Awareness),e.Awareness=Awareness},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){return void 0===t?e:t}var o=n(0),a=i(o),s=n(1),u=i(s),l=n(2),c=i(l),h=n(6),f=i(h),d=n(3),p=i(d),y=n(4),v=i(y);Object.defineProperty(e,"__esModule",{value:!0});var g=n(5),m=n(10),_=n(42);n(11);var Burst=function(t){function Burst(){(0,a.default)(this,Burst);var t=(0,c.default)(this,(Burst.__proto__||Object.getPrototypeOf(Burst)).apply(this,arguments));return t.loop=!1,t}return(0,p.default)(Burst,t),(0,u.default)(Burst,[{key:"addedToScene",value:function(){(0,f.default)(Burst.prototype.__proto__||Object.getPrototypeOf(Burst.prototype),"addedToScene",this).call(this),this.pSys=this.entity.find(_.ParticleSystem),this.pSys||(this.pSys=this.entity.add(new _.ParticleSystem(this.opts.template))),this.opts.template&&(this.pSys.template.name,this.opts.template),r(this.opts.autoPlay,!0)&&this.trigger()}},{key:"update",value:function(){if(void 0===this.opts.rate){if(this.pSys.numActiveParticles>0)return;this.loop&&this.pSys.active?this.trigger():r(this.opts.autoRemove,!0)&&this.entity.scene.remove(this.entity)}else this.trigger()}},{key:"trigger",value:function(){var t=this.opts,e=t.x,n=t.y,i=t.direction,r=t.rangeX,o=t.rangeY,a=t.count,s=t.rate;void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),void 0!==s&&(a=s*g.Engine.delta),this.pSys.numActiveParticles<this.maxParticles&&this.pSys.burst(e,n,i,r,o,a)}},{key:"maxParticles",get:function(){return this.opts.maxParticles||400}}]),Burst}(m.AutoComponent);Burst=function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===("undefined"==typeof Reflect?"undefined":(0,v.default)(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a}([m.AutoComponent.register],Burst),e.Burst=Burst},function(t,e,n){"use strict";var i=n(0),r=function(t){return t&&t.__esModule?t:{default:t}}(i);Object.defineProperty(e,"__esModule",{value:!0});var o=function t(){(0,r.default)(this,t)};e.Particle=o},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a);Object.defineProperty(e,"__esModule",{value:!0});var u=n(20),l=n(93),c=function(){function t(e){(0,o.default)(this,t),this.texture=null,this.speedBase=0,this.speedRange=0,this.accelBaseX=0,this.accelRangeX=0,this.accelBaseY=0,this.accelRangeY=0,this.frictionBaseX=0,this.frictionRangeX=0,this.frictionBaseY=0,this.frictionRangeY=0,this.colorsFrom=[u.Color.white],this.colorsTo=[u.Color.white],this.colorEaser=l.Ease.linear,this.alphaFromBase=1,this.alphaFromRange=0,this.alphaToBase=1,this.alphaToRange=0,this.alphaEaser=l.Ease.linear,this.rotationFromBase=0,this.rotationFromRange=0,this.rotationToBase=0,this.rotationToRange=0,this.rotationEaser=l.Ease.linear,this.scaleFromBaseX=1,this.scaleFromRangeX=0,this.scaleToBaseX=1,this.scaleToRangeX=0,this.scaleXEaser=l.Ease.linear,this.scaleFromBaseY=1,this.scaleFromRangeY=0,this.scaleToBaseY=1,this.scaleToRangeY=0,this.scaleYEaser=l.Ease.linear,this.durationBase=1,this.durationRange=1,this.name=e,t.templates[e]=this}return(0,s.default)(t,[{key:"tex",value:function(t){return this.texture=t,this}},{key:"speed",value:function(t,e){return this.speedBase=t,this.speedRange=e||0,this}},{key:"accelX",value:function(t,e){return this.accelBaseX=t,this.accelRangeX=e||0,this}},{key:"accelY",value:function(t,e){return this.accelBaseY=t,this.accelRangeY=e||0,this}},{key:"frictionX",value:function(t,e){return this.frictionBaseX=t,this.frictionRangeX=e||0,this}},{key:"frictionY",value:function(t,e){return this.frictionBaseY=t,this.frictionRangeY=e||0,this}},{key:"colors",value:function(t,e){return this.colorsFrom=t,this.colorsTo=e||t,this}},{key:"colorEase",value:function(t){return this.colorEaser=t,this}},{key:"alpha",value:function(t,e){return this.alphaFrom(t,e),this.alphaTo(t,e),this}},{key:"alphaFrom",value:function(t,e){return this.alphaFromBase=t,this.alphaFromRange=e||0,this}},{key:"alphaTo",value:function(t,e){return this.alphaToBase=t,this.alphaToRange=e||0,this}},{key:"alphaEase",value:function(t){return this.alphaEaser=t,this}},{key:"rotation",value:function(t,e){return this.rotationFrom(t,e),this.rotationTo(t,e),this}},{key:"rotationFrom",value:function(t,e){return this.rotationFromBase=t,this.rotationFromRange=e||0,this}},{key:"rotationTo",value:function(t,e){return this.rotationToBase=t,this.rotationToRange=e||0,this}},{key:"rotationEase",value:function(t){return this.rotationEaser=t,this}},{key:"scale",value:function(t,e){return this.scaleFrom(t,e),this.scaleTo(t,e),this}},{key:"scaleFrom",value:function(t,e){return this.scaleFromX(t,e),this.scaleFromY(t,e),this}},{key:"scaleTo",value:function(t,e){return this.scaleToX(t,e),this.scaleToY(t,e),this}},{key:"scaleEase",value:function(t){return this.scaleXEaser=t,this.scaleYEaser=t,this}},{key:"scaleX",value:function(t,e){return this.scaleFromX(t,e),this.scaleToX(t,e),this}},{key:"scaleFromX",value:function(t,e){return this.scaleFromBaseX=t,this.scaleFromRangeX=e||0,this}},{key:"scaleToX",value:function(t,e){return this.scaleToBaseX=t,this.scaleToRangeX=e||0,this}},{key:"scaleY",value:function(t,e){return this.scaleFromY(t,e),this.scaleToY(t,e),this}},{key:"scaleXEase",value:function(t){return this.scaleXEaser=t,this}},{key:"scaleFromY",value:function(t,e){return this.scaleFromBaseY=t,this.scaleFromRangeY=e||0,this}},{key:"scaleToY",value:function(t,e){return this.scaleToBaseY=t,this.scaleToRangeY=e||0,this}},{key:"scaleYEase",value:function(t){return this.scaleYEaser=t,this}},{key:"duration",value:function(t,e){return this.durationBase=t,this.durationRange=e||0,this}}]),t}();c.templates={},e.ParticleTemplate=c},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a),u=n(2),l=i(u),c=n(6),h=i(c),f=n(3),d=i(f),p=n(4),y=i(p);Object.defineProperty(e,"__esModule",{value:!0});var v=n(14),g=n(7),m=n(12),_=n(15),b=n(16),x=n(55),w=n(10),CausesDamage=function(t){function CausesDamage(){(0,o.default)(this,CausesDamage);var t=(0,l.default)(this,(CausesDamage.__proto__||Object.getPrototypeOf(CausesDamage)).apply(this,arguments));return t.amount=1,t}return(0,d.default)(CausesDamage,t),(0,s.default)(CausesDamage,[{key:"addedToScene",value:function(){(0,h.default)(CausesDamage.prototype.__proto__||Object.getPrototypeOf(CausesDamage.prototype),"addedToScene",this).call(this),this.hitbox=this.entity.find(m.Hitbox)}},{key:"update",value:function(){var t=this;(0,h.default)(CausesDamage.prototype.__proto__||Object.getPrototypeOf(CausesDamage.prototype),"update",this).call(this);var e=!0,n=!1,i=void 0;try{for(var r,o=this.hitbox.collideAll(_.Game.TAGS.PLAYER)[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var a=r.value,s=a.entity.find(x.Health);if(s){if(s.tryApplyDamage(this),this.opts.damageParticles){var u=this.hitbox.getSceneBounds(g.Rectangle.temp0).getCenter(g.Vector.temp0);this.scene.add(b.instantiatePrefab(this.opts.damageParticles,null,u.x,u.y))}this.opts.diesOnCollision&&v.Alarm.create(this.entity).start(.01,function(){t.entity.scene.remove(t.entity),t.active=!1})}}}catch(t){n=!0,i=t}finally{try{!e&&o.return&&o.return()}finally{if(n)throw i}}}}]),CausesDamage}(w.AutoComponent);CausesDamage=function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===("undefined"==typeof Reflect?"undefined":(0,y.default)(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a}([w.AutoComponent.register],CausesDamage),e.CausesDamage=CausesDamage},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a),u=n(2),l=i(u),c=n(3),h=i(c),f=n(4),d=i(f);Object.defineProperty(e,"__esModule",{value:!0});var p=n(10),y=n(12),v=n(56),g=n(9),Flip=function(t){function Flip(){(0,o.default)(this,Flip);var t=(0,l.default)(this,(Flip.__proto__||Object.getPrototypeOf(Flip)).apply(this,arguments));return t.flipX=!1,t}return(0,h.default)(Flip,t),(0,s.default)(Flip,[{key:"addedToScene",value:function(){var t=this,e=this.entity.getComponentByName(this.opts.bodyName),n=e.x+e.width/2,i=(e.y,e.height,["solid","enemy_solid"]);if(0!==e.collideAllMulti(i,-24,0).filter(function(e){return e.entity!==t.entity}).length){this.flipX=!0;var r=!0,o=!1,a=void 0;try{for(var s,u=this.entity.findAll(g.Sprite)[Symbol.iterator]();!(r=(s=u.next()).done);r=!0)s.value.flipX=!0}catch(t){o=!0,a=t}finally{try{!r&&u.return&&u.return()}finally{if(o)throw a}}var l=!0,c=!1,h=void 0;try{for(var f,d=this.entity.findAll(y.Hitbox)[Symbol.iterator]();!(l=(f=d.next()).done);l=!0){var p=f.value;p!==e&&(p.left+=p.width+2*n-(p.left+p.width))}}catch(t){c=!0,h=t}finally{try{!l&&d.return&&d.return()}finally{if(c)throw h}}var m=!0,_=!1,b=void 0;try{for(var x,w=this.entity.findAll(v.ChildEntity)[Symbol.iterator]();!(m=(x=w.next()).done);m=!0){var k=x.value,O=!0,S=!1,E=void 0;try{for(var T,P=k.child.findAll(g.Sprite)[Symbol.iterator]();!(O=(T=P.next()).done);O=!0){var C=T.value;C.flipX=!C.flipX,C.x+=C.width+2*n-(C.x+C.width)}}catch(t){S=!0,E=t}finally{try{!O&&P.return&&P.return()}finally{if(S)throw E}}}}catch(t){_=!0,b=t}finally{try{!m&&w.return&&w.return()}finally{if(_)throw b}}}}}]),Flip}(p.AutoComponent);Flip=function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===("undefined"==typeof Reflect?"undefined":(0,d.default)(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a}([p.AutoComponent.register],Flip),e.Flip=Flip},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a),u=n(2),l=i(u),c=n(6),h=i(c),f=n(3),d=i(f),p=n(4),y=i(p),v=function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===("undefined"==typeof Reflect?"undefined":(0,y.default)(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(e,"__esModule",{value:!0});var g=n(5),m=n(14),_=n(9),b=n(7),x=n(36),w=n(56),k=n(16),O=n(118),S=n(10);n(11);var E=n(43),Freezable=T=function(t){function Freezable(){(0,o.default)(this,Freezable);var t=(0,l.default)(this,(Freezable.__proto__||Object.getPrototypeOf(Freezable)).apply(this,arguments));return t.totalFreezeTime=12,t.freezeTime=1/0,t.frozenLastFrame=!1,t}return(0,d.default)(Freezable,t),(0,s.default)(Freezable,[{key:"addedToScene",value:function(){(0,h.default)(Freezable.prototype.__proto__||Object.getPrototypeOf(Freezable.prototype),"addedToScene",this).call(this),this.onFreezeDelegate=new E.EventDelegate(this.opts.onFreeze,this.entity),this.onThawDelegate=new E.EventDelegate(this.opts.onThaw,this.entity)}},{key:"update",value:function(){if(void 0===this.trackedComponents){this.trackedComponents=[],this.physics=this.entity.find(m.Physics);var t=!0,e=!1,n=void 0;try{for(var i,r=T.frozenComponents[Symbol.iterator]();!(t=(i=r.next()).done);t=!0){var o=i.value,a=x.getComponentByName(o),s=this.entity.find(a);s&&this.trackedComponents.push(s)}}catch(t){e=!0,n=t}finally{try{!t&&r.return&&r.return()}finally{if(e)throw n}}}var u=g.Engine.elapsed;this.pushable&&u-this.pushable.lastFloatingTime<.5&&(this.freezeTime+=g.Engine.delta);var l=u-this.freezeTime,c=this.isFrozen,h=b.Calc.clamp(l<0?0:(this.totalFreezeTime-l)/this.totalFreezeTime,0,1);if(this.graphic.color.set(1-h,1-h,1,1),c&&!this.frozenLastFrame){var f=!0,d=!1,p=void 0;try{for(var y,v=this.trackedComponents[Symbol.iterator]();!(f=(y=v.next()).done);f=!0)y.value.active=!1}catch(t){d=!0,p=t}finally{try{!f&&v.return&&v.return()}finally{if(d)throw p}}this.physics&&this.physics.stop(),this.pushable=this.entity.add(new O.Pushable({threshold:.2})),this.frozenGraphic=this.entity.add(new w.ChildEntity({prefabName:"icecube"})),this.onFreezeDelegate.invoke()}else if(!c&&this.frozenLastFrame){var _=!0,k=!1,S=void 0;try{for(var E,P=this.trackedComponents[Symbol.iterator]();!(_=(E=P.next()).done);_=!0){var C=E.value;C.active=!0}}catch(t){k=!0,S=t}finally{try{!_&&P.return&&P.return()}finally{if(k)throw S}}this.entity.remove(this.pushable),this.pushable=void 0,this.frozenGraphic.entity.remove(this.frozenGraphic),this.frozenGraphic=void 0,this.onThawDelegate.invoke()}this.frozenLastFrame=c}},{key:"freeze",value:function(){this.isFrozen?this.shatter():this.freezeTime=g.Engine.elapsed}},{key:"shatter",value:function(){var t=b.Vector.temp0.set(this.graphic.sceneCenterX,this.graphic.sceneCenterY);this.scene.add(k.instantiatePrefab("ice_burst"),t),this.scene.remove(this.entity)}},{key:"isFrozen",get:function(){var t=g.Engine.elapsed-this.freezeTime;return t>0&&t<=this.totalFreezeTime}}]),Freezable}(S.AutoComponent);Freezable.frozenComponents=["Mover","Sprite","Wonder","Emitter","Facing"],v([S.AutoComponent.require,function(t,e){if("object"===("undefined"==typeof Reflect?"undefined":(0,y.default)(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:type",_.Graphic)],Freezable.prototype,"graphic",void 0),Freezable=T=v([S.AutoComponent.register],Freezable),e.Freezable=Freezable;var T},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(17),o=i(r),a=n(0),s=i(a),u=n(1),l=i(u),c=n(2),h=i(c),f=n(6),d=i(f),p=n(3),y=i(p),v=n(4),g=i(v);Object.defineProperty(e,"__esModule",{value:!0});var m=n(5),_=n(14),b=n(12),x=n(7),w=n(15),k=n(78),O=n(10),S=n(31),Pushable=function(t){function Pushable(){(0,s.default)(this,Pushable);var t=(0,h.default)(this,(Pushable.__proto__||Object.getPrototypeOf(Pushable)).apply(this,arguments));return t.tileWidth=24,t.tileHeight=24,t.pushCounter=new x.Vector,t.lastFloatingTime=-100,t}return(0,y.default)(Pushable,t),(0,l.default)(Pushable,[{key:"addedToScene",value:function(){(0,d.default)(Pushable.prototype.__proto__||Object.getPrototypeOf(Pushable.prototype),"addedToScene",this).call(this),w.Game.TAGS.SOLID,w.Game.TAGS.PLAYER,this.physics=this.entity.find(_.Physics),this.physics,this.entity.add(this.hitbox=new b.Hitbox({left:-1,top:-1,width:this.tileWidth+2,height:this.tileHeight+2,tags:[]}))}},{key:"play_sound",value:function(){}},{key:"updatePushCounterFromWater",value:function(){var t=this.scene.waterFlow,e=t.trackObject(this.physics);if(e){this.lastFloatingTime=m.Engine.elapsed;var n=(0,o.default)(e,2),i=n[0],r=n[1],a=t.currentStrength*m.Engine.delta;i*=a,r*=a;var s=this.physics.collide("player",0,0);s&&s.entity.find(_.Physics).move(i,r),this.physics.move(i,r)}}},{key:"updatePushCounterFromPlayer",value:function(){var t=this.hitbox.collide(w.Game.TAGS.PLAYER,void 0,void 0);if(!(t&&t.entity instanceof S.Player))return void this.pushCounter.set(0,0);var e=t.entity.find(_.Physics),n=t.entity.find(k.TopDownControls),i=n.addedSpeed,r=Math.sign(i.x),o=Math.sign(i.y),a=e.sceneBounds,s=this.physics.sceneBounds;(r>0&&a.centerX>s.centerX||r<0&&a.centerX<s.centerX)&&(r=0),(o>0&&a.centerY>s.centerY||o<0&&a.centerY<s.centerY)&&(o=0),0===r||s.overlapsVertically(a)||(r=0),0===o||s.overlapsHorizontally(a)||(o=0),this.pushCounter.set(0===r?0:this.pushCounter.x+m.Engine.delta*r,0===o?0:this.pushCounter.y+m.Engine.delta*o)}},{key:"update",value:function(){var t=this;if((0,d.default)(Pushable.prototype.__proto__||Object.getPrototypeOf(Pushable.prototype),"update",this).call(this),!this.activeTween&&this.physics){this.physics.check("water")?this.updatePushCounterFromWater():this.updatePushCounterFromPlayer();var e=x.Ease.sineInOut,n=this.scenePosition,i=[w.Game.TAGS.SOLID,"enemy_solid"];if(Math.abs(this.pushCounter.x)>this.threshold){var r=Math.sign(this.pushCounter.x)*this.tileWidth,o=this.physics.collideAllMulti(i,r,0);this.isBlocked(o)||(this.play_sound(),this.activeTween=_.Tween.create(this.entity).start(.42,n.x,n.x+r,e,function(e){t.physics.moveX(e-t.scenePosition.x)},!0).setOnComplete(function(){t.activeTween=void 0}).restart(),this.pushCounter.x=0)}if(Math.abs(this.pushCounter.y)>this.threshold){var a=Math.sign(this.pushCounter.y)*this.tileHeight,s=this.physics.collideAllMulti(i,0,a);this.isBlocked(s)||(this.play_sound(),this.activeTween=_.Tween.create(this.entity).start(.42,n.y,n.y+a,e,function(e){t.physics.moveY(e-t.scenePosition.y)},!0).setOnComplete(function(){t.activeTween=void 0}).restart(),this.pushCounter.y=0)}}}},{key:"isBlocked",value:function(t){var e=!0,n=!1,i=void 0;try{for(var r,o=t[Symbol.iterator]();!(e=(r=o.next()).done);e=!0)if(r.value.entity!==this.entity)return!0}catch(t){n=!0,i=t}finally{try{!e&&o.return&&o.return()}finally{if(n)throw i}}return!1}},{key:"threshold",get:function(){return void 0===this.opts.threshold?.5:this.opts.threshold}}]),Pushable}(O.AutoComponent);Pushable=function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===("undefined"==typeof Reflect?"undefined":(0,g.default)(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a}([m.Component.register],Pushable),e.Pushable=Pushable},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a),u=n(2),l=i(u),c=n(6),h=i(c),f=n(3),d=i(f),p=n(4),y=i(p);Object.defineProperty(e,"__esModule",{value:!0});var v=n(10),g=n(9),m=n(7),Shadow=function(t){function Shadow(){return(0,o.default)(this,Shadow),(0,l.default)(this,(Shadow.__proto__||Object.getPrototypeOf(Shadow)).apply(this,arguments))}return(0,d.default)(Shadow,t),(0,s.default)(Shadow,[{key:"addedToScene",value:function(){if((0,h.default)(Shadow.prototype.__proto__||Object.getPrototypeOf(Shadow.prototype),"addedToScene",this).call(this),this.level){var t=void 0;if(this.opts.graphicName&&(t=this.entity.getComponentByName(this.opts.graphicName)),t=t||this.entity.find(g.Graphic)){var e=t.y+t.height-23,n=this.level.getShadow(0),i=this.graphic=this.entity.add(new g.Graphic(n,m.Vector.temp0.set(0,3)));i.y=e;var r=this.opts.offset?this.opts.offset:m.Vector.zero,o=r.x,a=r.y;void 0!==o&&(i.x+=o),void 0!==a&&(i.y+=a),i.alpha=void 0===this.opts.alpha?.6:this.opts.alpha}}}}]),Shadow}(v.AutoComponent);Shadow=function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===("undefined"==typeof Reflect?"undefined":(0,y.default)(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a}([v.AutoComponent.register],Shadow),e.Shadow=Shadow},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a),u=n(2),l=i(u),c=n(3),h=i(c),f=n(4),d=i(f),p=function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===("undefined"==typeof Reflect?"undefined":(0,d.default)(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},y=function(t,e){if("object"===("undefined"==typeof Reflect?"undefined":(0,d.default)(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var v=n(14),g=n(7),m=n(9),_=n(12),b=n(16),x=n(10),w=n(31);n(11);var Pickup=k=function(t){function Pickup(){(0,o.default)(this,Pickup);var t=(0,l.default)(this,(Pickup.__proto__||Object.getPrototypeOf(Pickup)).apply(this,arguments));return t.pickedUp=!1,t}return(0,h.default)(Pickup,t),(0,s.default)(Pickup,[{key:"didPickup",value:function(t){}},{key:"update",value:function(){var t=this.hitbox.collide("player",0,0);if(t&&t.entity instanceof w.Player){this.active=!1,this.didPickup(t.entity);var e=g.Vector.temp0.set(this.graphic.sceneCenterX,this.graphic.sceneCenterY),n=this.opts.burstName||"pickup_burst";this.entity.scene.add(b.instantiatePrefab(n),e),k.fadeOutAllGraphicsAndRemoveEntity(this.entity)}}}],[{key:"fadeOutAllGraphicsAndRemoveEntity",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.3,n=t.findAll(m.Graphic),i=n.map(function(t){return t.alpha}),r=v.Tween.create(t).start(e,1,0,g.Ease.linear,function(t){for(var e=0;e<n.length;++e)n[e].alpha=t*i[e]},!0);r.setOnComplete(function(){return t.scene.remove(t)}),r.restart()}}]),Pickup}(x.AutoComponent);p([x.AutoComponent.require,y("design:type",m.Graphic)],Pickup.prototype,"graphic",void 0),p([x.AutoComponent.require,y("design:type",_.Hitbox)],Pickup.prototype,"hitbox",void 0),Pickup=k=p([x.AutoComponent.register],Pickup),e.Pickup=Pickup;var k},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t){t.top=-1e3,t.left=-1e3,t.width=0,t.height=0}function o(t){if(!t||"object"!==(void 0===t?"undefined":(0,s.default)(t)))return t;if(Array.isArray(t))return t.map(o);var e={};return Object.keys(t).forEach(function(n){e[n]=o(t[n])}),e}var a=n(4),s=i(a),u=n(17),l=i(u),c=n(0),h=i(c),f=n(1),d=i(f),p=n(2),y=i(p),v=n(6),g=i(v),m=n(3),_=i(m);Object.defineProperty(e,"__esModule",{value:!0});var b=n(12),x=n(7),w=n(5),k=n(44),O=n(9),HitgridWithHoles=function(t){function HitgridWithHoles(){(0,h.default)(this,HitgridWithHoles);var t=(0,y.default)(this,(HitgridWithHoles.__proto__||Object.getPrototypeOf(HitgridWithHoles)).apply(this,arguments));return t.lastFrameObjs=[],t.thisFrameObjs=[],t.colors=[new x.Color(1,0,1,1),new x.Color(0,1,0,1),new x.Color(0,0,1,1),new x.Color(1,1,0,1)],t.splits={},t}return(0,_.default)(HitgridWithHoles,t),(0,d.default)(HitgridWithHoles,[{key:"addedToScene",value:function(){var t=this;(0,g.default)(HitgridWithHoles.prototype.__proto__||Object.getPrototypeOf(HitgridWithHoles.prototype),"addedToScene",this).call(this),this.originalCopy=new b.Hitgrid(this.tileWidth,this.tileHeight),this.originalCopy.map=o(this.map),this.scene.earlyUpdate.push(function(){t.earlyUpdate()})}},{key:"copy",value:function(t){this.tileWidth=t.tileWidth,this.tileHeight=t.tileHeight,this.type=t.type,this.map=o(t.map)}},{key:"trackObject",value:function(t){this.thisFrameObjs.push(t),t.untag("solid"),t.untag("enemy_solid"),t.solids=t.solids.filter(function(t){return"player"!==t})}},{key:"earlyUpdate",value:function(){this.thisFrameObjs.length=0}},{key:"makeHitboxes",value:function(t,e){if(HitgridWithHoles.pool.length>=t){var n=HitgridWithHoles.pool.splice(0,t),i=!0,r=!1,o=void 0;try{for(var a,s=n[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var u=a.value;u.left=e.x,u.top=e.y,u.width=e.width,u.height=e.height}}catch(t){r=!0,o=t}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}return n}for(var l=[],c=0;c<t;++c){var h=this.entity.add(new b.Hitbox({left:e.x,top:e.y,width:e.width,height:e.height,tags:this.tags}));h.debugColor=this.colors[c],l.push(h)}return l}},{key:"returnHitboxes",value:function(t){var e=!0,n=!1,i=void 0;try{for(var o,a=t[Symbol.iterator]();!(e=(o=a.next()).done);e=!0){var s=o.value;r(s),HitgridWithHoles.pool.push(s)}}catch(t){n=!0,i=t}finally{try{!e&&a.return&&a.return()}finally{if(n)throw i}}}},{key:"lateUpdate",value:function(){var t=[],e=!0,n=!1,i=void 0;try{for(var r,a=this.lastFrameObjs[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){var s=r.value;-1===this.thisFrameObjs.indexOf(s)&&t.push(s)}}catch(t){n=!0,i=t}finally{try{!e&&a.return&&a.return()}finally{if(n)throw i}}var u=[],c=!0,h=!1,f=void 0;try{for(var d,p=this.thisFrameObjs[Symbol.iterator]();!(c=(d=p.next()).done);c=!0){var y=d.value;-1===this.lastFrameObjs.indexOf(y)&&u.push(y)}}catch(t){h=!0,f=t}finally{try{!c&&p.return&&p.return()}finally{if(h)throw f}}this.map=o(this.originalCopy.map);var v=!0,g=!1,m=void 0;try{for(var _,b=Object.entries(this.splits)[Symbol.iterator]();!(v=(_=b.next()).done);v=!0){var x=(0,l.default)(_.value,2),w=(x[0],x[1]);this.returnHitboxes(w)}}catch(t){g=!0,m=t}finally{try{!v&&b.return&&b.return()}finally{if(g)throw m}}this.splits={};var k=!0,O=!1,S=void 0;try{for(var E,T=this.thisFrameObjs[Symbol.iterator]();!(k=(E=T.next()).done);k=!0){var P=E.value;this.carve(P.sceneBounds)}}catch(t){O=!0,S=t}finally{try{!k&&T.return&&T.return()}finally{if(O)throw S}}var C=this.scene.firstColliderInTag("player"),R=this.tags[0];if(C&&C.check(R))for(var j=0;j<3;++j){if(!C.check(R,0,-j)){C.move(0,-j);break}if(!C.check(R,0,j)){C.move(0,j);break}if(!C.check(R,j,0)){C.move(j,0);break}if(!C.check(R,-j,0)){C.move(-j,0);break}}}},{key:"carve",value:function(t){window.hg=this;var e=this.scenePosition,n=this.tileWidth,i=this.tileHeight,r=!0,o=!1,a=void 0;try{for(var s,u=this.tiles()[Symbol.iterator]();!(r=(s=u.next()).done);r=!0){var c=(0,l.default)(s.value,2),h=c[0],f=c[1],d=new x.Rectangle(e.x+h*n,e.y+f*i,n,i);if(d.intersectsRect(t)){var p=h+"_"+f,y=void 0;this.splits[p]?y=this.splits[p]:(y=this.splits[p]=this.makeHitboxes(4,d),this.set(!1,h,f)),y[0].width=Math.min(d.right,t.left)-d.left,y[1].height=Math.min(d.bottom,t.top)-d.top,y[2].setTop(Math.min(d.bottom,t.bottom)),y[3].setLeft(Math.min(d.right,t.right)),y[0].active=y[0].width>0&&y[0].height>0,y[1].active=y[1].width>0&&y[1].height>0,y[2].active=y[2].width>1&&y[2].height>1,y[3].active=y[3].width>1&&y[3].height>1}}}catch(t){o=!0,a=t}finally{try{!r&&u.return&&u.return()}finally{if(o)throw a}}}},{key:"worldToMap",value:function(t){var e=this.scenePosition;t.x=Math.floor((t.x-e.x)/this.tileWidth),t.y=Math.floor((t.y-e.y)/this.tileHeight)}}]),HitgridWithHoles}(b.Hitgrid);HitgridWithHoles.pool=[],e.HitgridWithHoles=HitgridWithHoles;var S=function(t){function e(){return(0,h.default)(this,e),(0,y.default)(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return(0,_.default)(e,t),(0,d.default)(e,[{key:"begin",value:function(){(0,g.default)(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"begin",this).call(this),this.camera.origin.set(w.Engine.width/2,w.Engine.height/2);var t=this.add(new w.Entity);t.name="test terrain";for(var n=t.add(new HitgridWithHoles(24,24,["water_solid"])),i=0;i<5;++i)for(var r=0;r<5;++r)n.set(!0,r,i);this.add(new w.Entity).add(new O.Sprite({animation:"guy"}))}}]),e}(k.EditableScene);e.HitgridHolesTestScene=S},function(t,e,n){"use strict";function i(t){}Object.defineProperty(e,"__esModule",{value:!0}),n(220),e.editJSON=i},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a),u=n(2),l=i(u),c=n(6),h=i(c),f=n(3),d=i(f);Object.defineProperty(e,"__esModule",{value:!0});var p=n(5),y=n(35),v=n(79),g=n(9),m=n(31),_=n(26),b=n(7),x=n(16),w=n(15),k=n(44),O=function(t){function e(){(0,o.default)(this,e);var t=(0,l.default)(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.sliderEnabled=!1,t.scene="title",t}return(0,d.default)(e,t),(0,s.default)(e,[{key:"begin",value:function(){(0,h.default)(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"begin",this).call(this);var t=new p.Entity,n=new b.Color(0,0,0,.3),i=t.add(new g.Rectsprite(1e3,70,n));i.x=-50,i.rotation=-.1;var r=t.add(new g.Rectsprite(1e3,80,n));r.x=-50,r.y=260,r.rotation=-.1,this.add(t);var o=(this.add(x.instantiatePrefab("title")),this.add(new p.Entity)),a=y.Assets.atlases.sprites;o.add(new v.StaticGraphic({texture:a.get("demo"),x:199,y:120})),o.add(new v.StaticGraphic({texture:a.get("instructions"),x:45,y:130}));var s=w.Game.hasLevelsCompleted?a.get("newgame"):a.get("startgame");o.add(new v.StaticGraphic({texture:s,x:45,y:190})),this.player=this.add(new m.Player,new b.Vector(220,169)),this.loaded=!0}},{key:"update",value:function(){(0,h.default)(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),_.Keyboard.pressed(_.Key.enter)?this.nextLevel():_.Keyboard.pressed(_.Key.n)&&this.newGame()}}]),e}(k.EditableScene);e.TitleScreen=O},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a),u=n(2),l=i(u),c=n(6),h=i(c),f=n(3),d=i(f),p=n(4),y=i(p),v=function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===("undefined"==typeof Reflect?"undefined":(0,y.default)(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},g=function(t,e){if("object"===("undefined"==typeof Reflect?"undefined":(0,y.default)(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var m=n(5),_=n(14),b=n(7);n(11);var Wonder=function(t){function Wonder(t){var e=t.speed;(0,o.default)(this,Wonder);var n=(0,l.default)(this,(Wonder.__proto__||Object.getPrototypeOf(Wonder)).call(this));return n.speed=15,n.speed=e,n}return(0,d.default)(Wonder,t),(0,s.default)(Wonder,[{key:"addedToScene",value:function(){(0,h.default)(Wonder.prototype.__proto__||Object.getPrototypeOf(Wonder.prototype),"addedToScene",this).call(this),this.dir="right"}},{key:"onCollide",value:function(t){t.entity!==this.entity&&("right"===this.dir?this.dir="up":"left"===this.dir?this.dir="down":"down"===this.dir?this.dir="right":"up"===this.dir&&(this.dir="left"))}},{key:"update",value:function(){var t=this;(0,h.default)(Wonder.prototype.__proto__||Object.getPrototypeOf(Wonder.prototype),"update",this).call(this),this.physics.onCollideX=function(e){t.onCollide(e)},this.physics.onCollideY=function(e){t.onCollide(e)};var e=b.Vector[this.dir];this.physics.speed.set(this.speed*e.x,this.speed*e.y)}}]),Wonder}(m.Component);v([m.Component.require,g("design:type",_.Physics)],Wonder.prototype,"physics",void 0),Wonder=v([m.Component.register,g("design:paramtypes",[Object])],Wonder),e.Wonder=Wonder},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(15);n(122),i.Game.start()},function(t,e,n){t.exports={default:n(127),__esModule:!0}},function(t,e,n){n(57),n(47),t.exports=n(139)},function(t,e,n){"use strict";var i=n(129),r=n(130),o=n(32),a=n(23);t.exports=n(80)(Array,"Array",function(t,e){this._t=a(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,r(1)):"keys"==e?r(0,n):"values"==e?r(0,t[n]):r(0,[n,t[n]])},"values"),o.Arguments=o.Array,i("keys"),i("values"),i("entries")},function(t,e){t.exports=function(){}},function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},function(t,e,n){var i=n(58);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==i(t)?t.split(""):Object(t)}},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e,n){"use strict";var i=n(63),r=n(39),o=n(68),a={};n(33)(a,n(19)("iterator"),function(){return this}),t.exports=function(t,e,n){t.prototype=i(a,{next:r(1,n)}),o(t,e+" Iterator")}},function(t,e,n){var i=n(25),r=n(28),o=n(45);t.exports=n(29)?Object.defineProperties:function(t,e){r(t);for(var n,a=o(e),s=a.length,u=0;s>u;)i.f(t,n=a[u++],e[n]);return t}},function(t,e,n){var i=n(23),r=n(85),o=n(136);t.exports=function(t){return function(e,n,a){var s,u=i(e),l=r(u.length),c=o(a,l);if(t&&n!=n){for(;l>c;)if((s=u[c++])!=s)return!0}else for(;l>c;c++)if((t||c in u)&&u[c]===n)return t||c||0;return!t&&-1}}},function(t,e,n){var i=n(64),r=Math.max,o=Math.min;t.exports=function(t,e){return t=i(t),t<0?r(t+e,0):o(t,e)}},function(t,e,n){t.exports=n(24).document&&document.documentElement},function(t,e,n){var i=n(64),r=n(59);t.exports=function(t){return function(e,n){var o,a,s=r(e)+"",u=i(n),l=s.length;return u<0||u>=l?t?"":void 0:(o=s.charCodeAt(u),o<55296||o>56319||u+1===l||(a=s.charCodeAt(u+1))<56320||a>57343?t?s.charAt(u):o:t?s.slice(u,u+2):a-56320+(o-55296<<10)+65536)}}},function(t,e,n){var i=n(87),r=n(19)("iterator"),o=n(32);t.exports=n(18).isIterable=function(t){var e=Object(t);return void 0!==e[r]||"@@iterator"in e||o.hasOwnProperty(i(e))}},function(t,e,n){t.exports={default:n(141),__esModule:!0}},function(t,e,n){n(57),n(47),t.exports=n(142)},function(t,e,n){var i=n(28),r=n(88);t.exports=n(18).getIterator=function(t){var e=r(t);if("function"!=typeof e)throw TypeError(t+" is not iterable!");return i(e.call(t))}},function(t,e,n){t.exports={default:n(144),__esModule:!0}},function(t,e,n){n(145);var i=n(18).Object;t.exports=function(t,e,n){return i.defineProperty(t,e,n)}},function(t,e,n){var i=n(27);i(i.S+i.F*!n(29),"Object",{defineProperty:n(25).f})},function(t,e,n){t.exports={default:n(147),__esModule:!0}},function(t,e,n){n(47),n(57),t.exports=n(70).f("iterator")},function(t,e,n){t.exports={default:n(149),__esModule:!0}},function(t,e,n){n(150),n(156),n(157),n(158),t.exports=n(18).Symbol},function(t,e,n){"use strict";var i=n(24),r=n(30),o=n(29),a=n(27),s=n(83),u=n(151).KEY,l=n(38),c=n(66),h=n(68),f=n(46),d=n(19),p=n(70),y=n(71),v=n(152),g=n(153),m=n(154),_=n(28),b=n(23),x=n(62),w=n(39),k=n(63),O=n(155),S=n(73),E=n(25),T=n(45),P=S.f,C=E.f,R=O.f,j=i.Symbol,M=i.JSON,A=M&&M.stringify,L=d("_hidden"),F=d("toPrimitive"),B={}.propertyIsEnumerable,D=c("symbol-registry"),G=c("symbols"),U=c("op-symbols"),N=Object.prototype,I="function"==typeof j,V=i.QObject,X=!V||!V.prototype||!V.prototype.findChild,Y=o&&l(function(){return 7!=k(C({},"a",{get:function(){return C(this,"a",{value:7}).a}})).a})?function(t,e,n){var i=P(N,e);i&&delete N[e],C(t,e,n),i&&t!==N&&C(N,e,i)}:C,H=function(t){var e=G[t]=k(j.prototype);return e._k=t,e},W=I&&"symbol"==typeof j.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof j},K=function(t,e,n){return t===N&&K(U,e,n),_(t),e=x(e,!0),_(n),r(G,e)?(n.enumerable?(r(t,L)&&t[L][e]&&(t[L][e]=!1),n=k(n,{enumerable:w(0,!1)})):(r(t,L)||C(t,L,w(1,{})),t[L][e]=!0),Y(t,e,n)):C(t,e,n)},z=function(t,e){_(t);for(var n,i=g(e=b(e)),r=0,o=i.length;o>r;)K(t,n=i[r++],e[n]);return t},q=function(t,e){return void 0===e?k(t):z(k(t),e)},J=function(t){var e=B.call(this,t=x(t,!0));return!(this===N&&r(G,t)&&!r(U,t))&&(!(e||!r(this,t)||!r(G,t)||r(this,L)&&this[L][t])||e)},$=function(t,e){if(t=b(t),e=x(e,!0),t!==N||!r(G,e)||r(U,e)){var n=P(t,e);return!n||!r(G,e)||r(t,L)&&t[L][e]||(n.enumerable=!0),n}},Q=function(t){for(var e,n=R(b(t)),i=[],o=0;n.length>o;)r(G,e=n[o++])||e==L||e==u||i.push(e);return i},Z=function(t){for(var e,n=t===N,i=R(n?U:b(t)),o=[],a=0;i.length>a;)!r(G,e=i[a++])||n&&!r(N,e)||o.push(G[e]);return o};I||(j=function(){if(this instanceof j)throw TypeError("Symbol is not a constructor!");var t=f(arguments.length>0?arguments[0]:void 0),e=function(n){this===N&&e.call(U,n),r(this,L)&&r(this[L],t)&&(this[L][t]=!1),Y(this,t,w(1,n))};return o&&X&&Y(N,t,{configurable:!0,set:e}),H(t)},s(j.prototype,"toString",function(){return this._k}),S.f=$,E.f=K,n(90).f=O.f=Q,n(72).f=J,n(89).f=Z,o&&!n(60)&&s(N,"propertyIsEnumerable",J,!0),p.f=function(t){return H(d(t))}),a(a.G+a.W+a.F*!I,{Symbol:j});for(var tt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),et=0;tt.length>et;)d(tt[et++]);for(var tt=T(d.store),et=0;tt.length>et;)y(tt[et++]);a(a.S+a.F*!I,"Symbol",{for:function(t){return r(D,t+="")?D[t]:D[t]=j(t)},keyFor:function(t){if(W(t))return v(D,t);throw TypeError(t+" is not a symbol!")},useSetter:function(){X=!0},useSimple:function(){X=!1}}),a(a.S+a.F*!I,"Object",{create:q,defineProperty:K,defineProperties:z,getOwnPropertyDescriptor:$,getOwnPropertyNames:Q,getOwnPropertySymbols:Z}),M&&a(a.S+a.F*(!I||l(function(){var t=j();return"[null]"!=A([t])||"{}"!=A({a:t})||"{}"!=A(Object(t))})),"JSON",{stringify:function(t){if(void 0!==t&&!W(t)){for(var e,n,i=[t],r=1;arguments.length>r;)i.push(arguments[r++]);return e=i[1],"function"==typeof e&&(n=e),!n&&m(e)||(e=function(t,e){if(n&&(e=n.call(this,t,e)),!W(e))return e}),i[1]=e,A.apply(M,i)}}}),j.prototype[F]||n(33)(j.prototype,F,j.prototype.valueOf),h(j,"Symbol"),h(Math,"Math",!0),h(i.JSON,"JSON",!0)},function(t,e,n){var i=n(46)("meta"),r=n(37),o=n(30),a=n(25).f,s=0,u=Object.isExtensible||function(){return!0},l=!n(38)(function(){return u(Object.preventExtensions({}))}),c=function(t){a(t,i,{value:{i:"O"+ ++s,w:{}}})},h=function(t,e){if(!r(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,i)){if(!u(t))return"F";if(!e)return"E";c(t)}return t[i].i},f=function(t,e){if(!o(t,i)){if(!u(t))return!0;if(!e)return!1;c(t)}return t[i].w},d=function(t){return l&&p.NEED&&u(t)&&!o(t,i)&&c(t),t},p=t.exports={KEY:i,NEED:!1,fastKey:h,getWeak:f,onFreeze:d}},function(t,e,n){var i=n(45),r=n(23);t.exports=function(t,e){for(var n,o=r(t),a=i(o),s=a.length,u=0;s>u;)if(o[n=a[u++]]===e)return n}},function(t,e,n){var i=n(45),r=n(89),o=n(72);t.exports=function(t){var e=i(t),n=r.f;if(n)for(var a,s=n(t),u=o.f,l=0;s.length>l;)u.call(t,a=s[l++])&&e.push(a);return e}},function(t,e,n){var i=n(58);t.exports=Array.isArray||function(t){return"Array"==i(t)}},function(t,e,n){var i=n(23),r=n(90).f,o={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],s=function(t){try{return r(t)}catch(t){return a.slice()}};t.exports.f=function(t){return a&&"[object Window]"==o.call(t)?s(t):r(i(t))}},function(t,e){},function(t,e,n){n(71)("asyncIterator")},function(t,e,n){n(71)("observable")},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a);Object.defineProperty(e,"__esModule",{value:!0});var u=n(8),l=n(75),c=n(22),h=n(49),f=n(13),d=function(){function t(){(0,o.default)(this,t),this.position=new f.Vector(0,0),this.origin=new f.Vector(0,0),this.scale=new f.Vector(1,1),this.rotation=0,this._matrix=new h.Matrix,this._internal=new h.Matrix,this._mouse=new f.Vector,this._worldMouse=new f.Vector,this.extentsA=new f.Vector,this.extentsB=new f.Vector,this.extentsC=new f.Vector,this.extentsD=new f.Vector,this.extentsRect=new c.Rectangle}return(0,s.default)(t,[{key:"getExtents",value:function(){var t=this.internal.invert();this.extentsA.set(0,0).transform(t),this.extentsB.set(u.Engine.width,0).transform(t),this.extentsC.set(0,u.Engine.height).transform(t),this.extentsD.set(u.Engine.width,u.Engine.height).transform(t)}},{key:"x",get:function(){return this.position.x},set:function(t){this.position.x=t}},{key:"y",get:function(){return this.position.y},set:function(t){this.position.y=t}},{key:"internal",get:function(){return this._internal.identity().translate(this.origin.x,this.origin.y).rotate(this.rotation).scale(this.scale.x,this.scale.y).translate(-this.position.x,-this.position.y)}},{key:"matrix",get:function(){return this._matrix.copy(u.Engine.graphics.orthographic).multiply(this.internal)}},{key:"mouse",get:function(){return this._mouse.set(l.Mouse.x+this.position.x-this.origin.x,l.Mouse.y+this.position.y-this.origin.y).transform(this.internal.invert())}},{key:"worldMouse",get:function(){var t=this.extents;return this._worldMouse.copy(l.Mouse.position).add(f.Vector.temp0.set(t.x,t.y))}},{key:"extents",get:function(){this.getExtents();var t=this.extentsRect;return t.x=Math.min(this.extentsA.x,this.extentsB.x,this.extentsC.x,this.extentsD.x),t.y=Math.min(this.extentsA.y,this.extentsB.y,this.extentsC.y,this.extentsD.y),t.width=Math.max(this.extentsA.x,this.extentsB.x,this.extentsC.x,this.extentsD.x)-t.x,t.height=Math.max(this.extentsA.y,this.extentsB.y,this.extentsC.y,this.extentsD.y)-t.y,t}}]),t}();e.Camera=d},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(17),o=i(r),a=n(0),s=i(a),u=n(1),l=i(u);Object.defineProperty(e,"__esModule",{value:!0});var c=function(){function t(){(0,s.default)(this,t),this.objects=[],this._count=0,this._iterating=!1,this._moveAfters=[]}return(0,l.default)(t,[{key:"add",value:function(t){return this.objects.push(t),this._count++,this.unsorted=!0,t}},{key:"contains",value:function(t){return null!=t&&this.objects.indexOf(t)>=0}},{key:"first",value:function(){for(var t=null,e=0;e<this.objects.length&&null==t;e++)t=this.objects[e];return t}},{key:"map",value:function(t){for(var e=this.objects.length,n=[],i=0;i<e;++i)n.push(t(this.objects[i]));return n}},{key:"each",value:function(t){var e=this.objects.length;this._iterating=!0;for(var n=0;n<e&&(null==this.objects[n]||!1!==t(this.objects[n]));n++);if(this._iterating=!1,this._moveAfters.length>0){var i=!0,r=!1,a=void 0;try{for(var s,u=this._moveAfters[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var l=(0,o.default)(s.value,2),c=l[0],h=l[1];this.remove(c)&&this.objects.splice(h,0,c)}}catch(t){r=!0,a=t}finally{try{!i&&u.return&&u.return()}finally{if(r)throw a}}this._moveAfters=[],this.dirty=!0,this.clean()}}},{key:"moveAfter",value:function(t,e){this._iterating?this._moveAfters.push([t,e]):this.remove(t)&&this.objects.splice(e,0,t)}},{key:"at",value:function(t){for(var e=t;e<this.objects.length;e++)if(null!=this.objects[e])return this.objects[e];return null}},{key:"sort",value:function(t){if(this.unsorted){for(var e=0;e<this.objects.length-1;++e)for(var n=e+1;n>0&&null!=this.objects[n-1]&&null!=this.objects[n]&&t(this.objects[n-1],this.objects[n])>0;){var i=this.objects[n-1];this.objects[n-1]=this.objects[n],this.objects[n--]=i}this.unsorted=!1}}},{key:"remove",value:function(t){var e=this.objects.indexOf(t);return e>=0&&(this.objects[e]=null,this._count--,this.dirty=!0,!0)}},{key:"clear",value:function(){for(var t=0;t<this.objects.length;t++)this.objects[t]=null;this._count=0,this.dirty=!0}},{key:"clean",value:function(){if(this.dirty)if(this.count<=0)this.objects=[];else for(var t=this.objects.length-1;t>=0;t--)null==this.objects[t]&&this.objects.splice(t,1)}},{key:"count",get:function(){return this._count}}]),t}();e.ObjectList=c},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a);Object.defineProperty(e,"__esModule",{value:!0});var u=n(92),l=function(){function t(){(0,o.default)(this,t)}return(0,s.default)(t,null,[{key:"volume",value:function(e,n){if(void 0!==n&&t.volumes[e]!==n){t.volumes[e]=n;for(var i=0;i<u.Sound.active.length;i++)u.Sound.active[i].ingroup(e)&&(u.Sound.active[i].volume=u.Sound.active[i].volume)}return void 0!=t.volumes[e]?t.volumes[e]:1}},{key:"muted",value:function(e,n){if(void 0!=n&&t.mutes[e]!=n){t.mutes[e]=n;for(var i=0;i<u.Sound.active.length;i++)u.Sound.active[i].ingroup(e)&&(u.Sound.active[i].muted=u.Sound.active[i].muted)}return void 0!=t.mutes[e]&&t.mutes[e]}}]),t}();l.volumes={},l.mutes={},e.AudioGroup=l},function(t,e,n){"use strict";function i(){function t(t,e){return t.sceneRight>e.sceneLeft&&t.sceneBottom>e.sceneTop&&t.sceneLeft<e.sceneRight&&t.sceneTop<e.sceneBottom}function e(t,e){for(var n=e.scenePosition,i=Math.floor((t.sceneLeft-n.x)/e.tileWidth),r=Math.floor((t.sceneTop-n.y)/e.tileHeight),o=Math.ceil((t.sceneRight-n.x)/e.tileWidth),a=Math.ceil((t.sceneBottom-n.y)/e.tileHeight),s=i;s<o;s++)for(var u=r;u<a;u++)if(e.has(s,u))return!0;return!1}r.Collider.registerOverlapTest(o.Hitbox,o.Hitbox,t),r.Collider.registerOverlapTest(o.Hitbox,a.Hitgrid,e)}Object.defineProperty(e,"__esModule",{value:!0});var r=n(40),o=n(94),a=n(95);e.registerDefaultOverlapTests=i},function(t,e,n){t.exports={default:n(164),__esModule:!0}},function(t,e,n){n(47),n(165),t.exports=n(18).Array.from},function(t,e,n){"use strict";var i=n(61),r=n(27),o=n(69),a=n(166),s=n(167),u=n(85),l=n(168),c=n(88);r(r.S+r.F*!n(169)(function(t){Array.from(t)}),"Array",{from:function(t){var e,n,r,h,f=o(t),d="function"==typeof this?this:Array,p=arguments.length,y=p>1?arguments[1]:void 0,v=void 0!==y,g=0,m=c(f);if(v&&(y=i(y,p>2?arguments[2]:void 0,2)),void 0==m||d==Array&&s(m))for(e=u(f.length),n=new d(e);e>g;g++)l(n,g,v?y(f[g],g):f[g]);else for(h=m.call(f),n=new d;!(r=h.next()).done;g++)l(n,g,v?a(h,y,[r.value,g],!0):r.value);return n.length=g,n}})},function(t,e,n){var i=n(28);t.exports=function(t,e,n,r){try{return r?e(i(n)[0],n[1]):e(n)}catch(e){var o=t.return;throw void 0!==o&&i(o.call(t)),e}}},function(t,e,n){var i=n(32),r=n(19)("iterator"),o=Array.prototype;t.exports=function(t){return void 0!==t&&(i.Array===t||o[r]===t)}},function(t,e,n){"use strict";var i=n(25),r=n(39);t.exports=function(t,e,n){e in t?i.f(t,e,r(0,n)):t[e]=n}},function(t,e,n){var i=n(19)("iterator"),r=!1;try{var o=[7][i]();o.return=function(){r=!0},Array.from(o,function(){throw 2})}catch(t){}t.exports=function(t,e){if(!e&&!r)return!1;var n=!1;try{var o=[7],a=o[i]();a.next=function(){return{done:n=!0}},o[i]=function(){return a},t(o)}catch(t){}return n}},function(t,e,n){t.exports={default:n(171),__esModule:!0}},function(t,e,n){n(172),t.exports=n(18).Object.setPrototypeOf},function(t,e,n){var i=n(27);i(i.S,"Object",{setPrototypeOf:n(173).set})},function(t,e,n){var i=n(37),r=n(28),o=function(t,e){if(r(t),!i(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,i){try{i=n(61)(Function.call,n(73).f(Object.prototype,"__proto__").set,2),i(t,[]),e=!(t instanceof Array)}catch(t){e=!0}return function(t,n){return o(t,n),e?t.__proto__=n:i(t,n),t}}({},!1):void 0),check:o}},function(t,e,n){t.exports={default:n(175),__esModule:!0}},function(t,e,n){n(176);var i=n(18).Object;t.exports=function(t,e){return i.create(t,e)}},function(t,e,n){var i=n(27);i(i.S,"Object",{create:n(63)})},function(t,e,n){(function(e){var i="object"==typeof e?e:"object"==typeof window?window:"object"==typeof self?self:this,r=i.regeneratorRuntime&&Object.getOwnPropertyNames(i).indexOf("regeneratorRuntime")>=0,o=r&&i.regeneratorRuntime;if(i.regeneratorRuntime=void 0,t.exports=n(178),r)i.regeneratorRuntime=o;else try{delete i.regeneratorRuntime}catch(t){i.regeneratorRuntime=void 0}}).call(e,n(74))},function(t,e,n){(function(e){!function(e){"use strict";function n(t,e,n,i){var o=e&&e.prototype instanceof r?e:r,a=Object.create(o.prototype),s=new d(i||[]);return a._invoke=l(t,n,s),a}function i(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}function r(){}function o(){}function a(){}function s(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function u(t){function n(e,r,o,a){var s=i(t[e],t,r);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==typeof l&&m.call(l,"__await")?Promise.resolve(l.__await).then(function(t){n("next",t,o,a)},function(t){n("throw",t,o,a)}):Promise.resolve(l).then(function(t){u.value=t,o(u)},a)}a(s.arg)}function r(t,e){function i(){return new Promise(function(i,r){n(t,e,i,r)})}return o=o?o.then(i,i):i()}"object"==typeof e.process&&e.process.domain&&(n=e.process.domain.bind(n));var o;this._invoke=r}function l(t,e,n){var r=S;return function(o,a){if(r===T)throw Error("Generator is already running");if(r===P){if("throw"===o)throw a;return y()}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=c(s,n);if(u){if(u===C)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===S)throw r=P,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=T;var l=i(t,e,n);if("normal"===l.type){if(r=n.done?P:E,l.arg===C)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r=P,n.method="throw",n.arg=l.arg)}}}function c(t,e){var n=t.iterator[e.method];if(n===v){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=v,c(t,e),"throw"===e.method))return C;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return C}var r=i(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,C;var o=r.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=v),e.delegate=null,C):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,C)}function h(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function f(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function d(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(h,this),this.reset(!0)}function p(t){if(t){var e=t[b];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function e(){for(;++n<t.length;)if(m.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=v,e.done=!0,e};return i.next=i}}return{next:y}}function y(){return{value:v,done:!0}}var v,g=Object.prototype,m=g.hasOwnProperty,_="function"==typeof Symbol?Symbol:{},b=_.iterator||"@@iterator",x=_.asyncIterator||"@@asyncIterator",w=_.toStringTag||"@@toStringTag",k="object"==typeof t,O=e.regeneratorRuntime;if(O)return void(k&&(t.exports=O));O=e.regeneratorRuntime=k?t.exports:{},O.wrap=n;var S="suspendedStart",E="suspendedYield",T="executing",P="completed",C={},R={};R[b]=function(){return this};var j=Object.getPrototypeOf,M=j&&j(j(p([])));M&&M!==g&&m.call(M,b)&&(R=M);var A=a.prototype=r.prototype=Object.create(R);o.prototype=A.constructor=a,a.constructor=o,a[w]=o.displayName="GeneratorFunction",O.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===o||"GeneratorFunction"===(e.displayName||e.name))},O.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,a):(t.__proto__=a,w in t||(t[w]="GeneratorFunction")),t.prototype=Object.create(A),t},O.awrap=function(t){return{__await:t}},s(u.prototype),u.prototype[x]=function(){return this},O.AsyncIterator=u,O.async=function(t,e,i,r){var o=new u(n(t,e,i,r));return O.isGeneratorFunction(e)?o:o.next().then(function(t){return t.done?t.value:o.next()})},s(A),A[w]="Generator",A[b]=function(){return this},A.toString=function(){return"[object Generator]"},O.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var i=e.pop();if(i in t)return n.value=i,n.done=!1,n}return n.done=!0,n}},O.values=p,d.prototype={constructor:d,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=v,this.done=!1,this.delegate=null,this.method="next",this.arg=v,this.tryEntries.forEach(f),!t)for(var e in this)"t"===e.charAt(0)&&m.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=v)},stop:function(){this.done=!0;var t=this.tryEntries[0],e=t.completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){function e(e,i){return o.type="throw",o.arg=t,n.next=e,i&&(n.method="next",n.arg=v),!!i}if(this.done)throw t;for(var n=this,i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i],o=r.completion;if("root"===r.tryLoc)return e("end");if(r.tryLoc<=this.prev){var a=m.call(r,"catchLoc"),s=m.call(r,"finallyLoc");if(a&&s){if(this.prev<r.catchLoc)return e(r.catchLoc,!0);if(this.prev<r.finallyLoc)return e(r.finallyLoc)}else if(a){if(this.prev<r.catchLoc)return e(r.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return e(r.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&m.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var o=r?r.completion:{};return o.type=t,o.arg=e,r?(this.method="next",this.next=r.finallyLoc,C):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),C},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),f(n),C}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;f(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:p(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=v),C}}}("object"==typeof e?e:"object"==typeof window?window:"object"==typeof self?self:this)}).call(e,n(74))},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a);Object.defineProperty(e,"__esModule",{value:!0});var u=n(8),l=n(75),c=n(13),h=function(){function t(){if((0,o.default)(this,t),u.Engine.client===u.Client.Desktop){var e=n(96).remote;t.browserWindow=e.getCurrentWindow(),t.screen=e.screen}}return(0,s.default)(t,null,[{key:"resize",value:function(e,n){u.Engine.client===u.Client.Desktop&&t.browserWindow.setContentSize(e,n)}},{key:"center",value:function(){u.Engine.client===u.Client.Desktop&&t.browserWindow.center()}},{key:"toggleDevTools",value:function(){u.Engine.client===u.Client.Desktop&&t.browserWindow.toggleDevTools()}},{key:"title",get:function(){return t.titleName},set:function(e){t.titleName=e,u.Engine.client===u.Client.Desktop?t.browserWindow.setTitle(e):document.title=e}},{key:"fullscreen",get:function(){return u.Engine.client===u.Client.Desktop&&t.browserWindow.isFullScreen()},set:function(e){u.Engine.client===u.Client.Desktop&&t.browserWindow.setFullScreen(e)}},{key:"screenLeft",get:function(){return u.Engine.client===u.Client.Desktop?t.browserWindow.getPosition()[0]:u.Engine.graphics.canvas.getBoundingClientRect().left}},{key:"screenTop",get:function(){return u.Engine.client===u.Client.Desktop?t.browserWindow.getPosition()[1]:u.Engine.graphics.canvas.getBoundingClientRect().top}},{key:"screenWidth",get:function(){return u.Engine.client===u.Client.Desktop?t.browserWindow.getContentSize()[0]:u.Engine.graphics.canvas.getBoundingClientRect().width}},{key:"screenHeight",get:function(){return u.Engine.client===u.Client.Desktop?t.browserWindow.getContentSize()[1]:u.Engine.graphics.canvas.getBoundingClientRect().height}},{key:"screenMouse",get:function(){if(u.Engine.client===u.Client.Desktop){var e=t.screen.getCursorScreenPoint();return new c.Vector(e.x,e.y)}return l.Mouse.absolute}}]),t}();e.GameWindow=h},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(1),o=i(r),a=n(0),s=i(a);Object.defineProperty(e,"__esModule",{value:!0});var u,l=n(99),c=n(53),h=n(8),f=n(20),d=n(49),p=n(22),y=n(76),v=n(51),g=n(13);!function(t){t[t.None=0]="None",t[t.Exact=1]="Exact",t[t.Contain=2]="Contain",t[t.ContainInteger=3]="ContainInteger",t[t.Fill=4]="Fill",t[t.FillInteger=5]="FillInteger"}(u=e.ResolutionStyle||(e.ResolutionStyle={}));var m=function t(e,n){(0,s.default)(this,t),this.source=e,this.dest=n};e.BlendMode=m;var _=function t(){(0,s.default)(this,t)};e.BlendModes=_;var b=function(){function t(e){(0,s.default)(this,t),this.resolutionStyle=u.Contain,this.borderColor=f.Color.black.clone(),this.clearColor=new f.Color(.1,.1,.3,1),this.vertices=[],this.texcoords=[],this.colors=[],this.currentTarget=null,this.currentShader=null,this.nextShader=null,this.currentBlendmode=null,this.nextBlendmode=null,this.orthographic=new d.Matrix,this.toscreen=new d.Matrix,this._pixel=null,this._pixelUVs=[new g.Vector(0,0),new g.Vector(1,0),new g.Vector(1,1),new g.Vector(0,1)],this._defaultPixel=null,this.drawCalls=0,this._texts=[],this.topleft=new g.Vector,this.topright=new g.Vector,this.botleft=new g.Vector,this.botright=new g.Vector,this.texToDraw=new c.Texture(null,new p.Rectangle,new p.Rectangle),this.engine=e,this.canvas=document.createElement("canvas"),this.gl=this.canvas.getContext("experimental-webgl",{alpha:!1,antialias:!1}),t._initCanvas(this.canvas),this.gl.enable(this.gl.BLEND),this.gl.disable(this.gl.DEPTH_TEST),this.gl.disable(this.gl.CULL_FACE),this.gl.blendFunc(this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA),_.normal=new m(this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA),_.add=new m(this.gl.ONE,this.gl.DST_ALPHA),_.multiply=new m(this.gl.DST_COLOR,this.gl.ONE_MINUS_SRC_ALPHA),_.screen=new m(this.gl.ONE,this.gl.ONE_MINUS_SRC_COLOR),this.currentBlendmode=_.normal,this.vertexBuffer=this.gl.createBuffer(),this.texcoordBuffer=this.gl.createBuffer(),this.colorBuffer=this.gl.createBuffer()}return(0,o.default)(t,[{key:"load",value:function(){this.pixel=this._defaultPixel=c.Texture.createFromData([1,1,1,1],1,1)}},{key:"unload",value:function(){this._defaultPixel.dispose(),this.gl.deleteBuffer(this.vertexBuffer),this.gl.deleteBuffer(this.colorBuffer),this.gl.deleteBuffer(this.texcoordBuffer),this.buffer.dispose(),this.buffer=null,this.canvas.remove(),this.canvas=null}},{key:"resize",value:function(){null!=this.buffer&&this.buffer.dispose(),this.buffer=l.RenderTarget.create(h.Engine.width,h.Engine.height),this.orthographic.identity().translate(-1,1).scale(1/this.buffer.width*2,-1/this.buffer.height*2)}},{key:"update",value:function(){t.checkCanvasSize(this.canvas),this.textCanvas&&t.checkCanvasSize(this.textCanvas)}},{key:"getOutputBounds",value:function(){var t=1,e=1;this.resolutionStyle===u.Exact?(t=this.canvas.width/this.buffer.width,e=this.canvas.height/this.buffer.height):this.resolutionStyle===u.Contain?t=e=Math.min(this.canvas.width/this.buffer.width,this.canvas.height/this.buffer.height):this.resolutionStyle===u.ContainInteger?t=e=Math.floor(Math.min(this.canvas.width/this.buffer.width,this.canvas.height/this.buffer.height)):this.resolutionStyle===u.Fill?t=e=Math.max(this.canvas.width/this.buffer.width,this.canvas.height/this.buffer.height):this.resolutionStyle===u.FillInteger&&(t=e=Math.ceil(Math.max(this.canvas.width/this.buffer.width,this.canvas.height/this.buffer.height)));var n=this.buffer.width*t,i=this.buffer.height*e;return new p.Rectangle((this.canvas.width-n)/2,(this.canvas.height-i)/2,n,i)}},{key:"clear",value:function(t){this.textContext&&this.textContext.clearRect(0,0,this.textContext.canvas.width,this.textContext.canvas.height),this.gl.clearColor(t.r,t.g,t.b,t.a),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT)}},{key:"fillText",value:function(t,e,n,i){}},{key:"reset",value:function(){this.drawCalls=0,this.currentShader=null,this.nextShader=null,this.vertices=[],this.colors=[],this.texcoords=[],this.setRenderTarget(this.buffer),this.clear(this.clearColor)}},{key:"setRenderTarget",value:function(t){this.currentTarget!=t&&(this.flush(),null==t?(this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this.gl.viewport(0,0,this.canvas.width,this.canvas.height)):(this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,t.frameBuffer),this.gl.viewport(0,0,t.width,t.height)),this.currentTarget=t)}},{key:"setShaderTexture",value:function(t){h.Engine.assert(null!=this.shader.sampler2d,"This shader has no Sampler2D to set the texture to")&&(this.shader.sampler2d.value=t.texture.webGLTexture)}},{key:"checkState",value:function(){if(null!=this.nextShader||this.currentShader.dirty||null!=this.nextBlendmode){null!=this.currentShader&&this.flush();var t=null!=this.nextShader;if(t){if(null!=this.currentShader)for(var e=0;e<this.currentShader.attributes.length;e++)this.gl.disableVertexAttribArray(this.currentShader.attributes[e].attribute);this.currentShader=this.nextShader,this.nextShader=null,this.gl.useProgram(this.currentShader.program);for(var n=0;n<this.currentShader.attributes.length;n++)this.gl.enableVertexAttribArray(this.currentShader.attributes[n].attribute)}null!=this.nextBlendmode&&(this.currentBlendmode=this.nextBlendmode,this.nextBlendmode=null,this.gl.blendFunc(this.currentBlendmode.source,this.currentBlendmode.dest));var i=0,r=!0,o=!1,a=void 0;try{for(var s,u=this.currentShader.uniforms[Symbol.iterator]();!(r=(s=u.next()).done);r=!0){var h=s.value;if(t||h.dirty){var f=h.uniform;h.type===y.ShaderUniformType.sampler2D?(this.gl.activeTexture(this.gl["TEXTURE"+i]),h.value instanceof c.Texture?this.gl.bindTexture(this.gl.TEXTURE_2D,h.value.texture.webGLTexture):h.value instanceof l.RenderTarget?this.gl.bindTexture(this.gl.TEXTURE_2D,h.value.texture.webGLTexture):this.gl.bindTexture(this.gl.TEXTURE_2D,h.value),this.gl.uniform1i(f,i),i+=1):y.setGLUniformValue[h.type](this.gl,h.uniform,h.value),h.dirty=!1}}}catch(t){o=!0,a=t}finally{try{!r&&u.return&&u.return()}finally{if(o)throw a}}this.currentShader.dirty=!1}}},{key:"flush",value:function(){if(0!==this.vertices.length){var t=!0,e=!1,n=void 0;try{for(var i,r=this.currentShader.attributes[Symbol.iterator]();!(t=(i=r.next()).done);t=!0){var o=i.value;o.type===y.ShaderAttributeType.Position?(this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null==this.currentTarget?this.vertexBuffer:this.currentTarget.vertexBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(this.vertices),this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(o.attribute,2,this.gl.FLOAT,!1,0,0)):o.type===y.ShaderAttributeType.Texcoord?(this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null==this.currentTarget?this.texcoordBuffer:this.currentTarget.texcoordBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(this.texcoords),this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(o.attribute,2,this.gl.FLOAT,!1,0,0)):o.type===y.ShaderAttributeType.Color&&(this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null==this.currentTarget?this.colorBuffer:this.currentTarget.colorBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(this.colors),this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(o.attribute,4,this.gl.FLOAT,!1,0,0))}}catch(t){e=!0,n=t}finally{try{!t&&r.return&&r.return()}finally{if(e)throw n}}this.gl.drawArrays(this.gl.TRIANGLES,0,this.vertices.length/2),this.drawCalls++,this.vertices=[],this.texcoords=[],this.colors=[]}}},{key:"finalize",value:function(){this.setRenderTarget(null),this.clear(this.borderColor),this.toscreen.identity().translate(-1,-1).scale(1/this.canvas.width*2,1/this.canvas.height*2),this.shader=v.Shaders.texture,this.shader.sampler2d.value=this.buffer.texture.webGLTexture,this.shader.set("matrix",this.toscreen);var t=this.getOutputBounds();this.push(t.left,t.top,0,0,f.Color.white),this.pushUnsafe(t.right,t.top,1,0,f.Color.white),this.pushUnsafe(t.right,t.bottom,1,1,f.Color.white),this.pushUnsafe(t.left,t.top,0,0,f.Color.white),this.pushUnsafe(t.right,t.bottom,1,1,f.Color.white),this.pushUnsafe(t.left,t.bottom,0,1,f.Color.white),this.flush()}},{key:"push",value:function(t,e,n,i,r){this.checkState(),this.vertices.push(t,e),this.texcoords.push(n,i),void 0!==r&&null!==r&&this.colors.push(r.r,r.g,r.b,r.a)}},{key:"pushUnsafe",value:function(t,e,n,i,r){this.vertices.push(t,e),this.texcoords.push(n,i),void 0!==r&&null!==r&&this.colors.push(r.r,r.g,r.b,r.a)}},{key:"pushList",value:function(t,e,n){this.checkState();for(var i=0;i<t.length;i++)if(this.vertices.push(t[i].x,t[i].y),void 0!==e&&null!==e&&this.texcoords.push(e[i].x,e[i].y),void 0!==n&&null!==n){var r=n[i];this.colors.push(r.r,r.g,r.b,r.a)}}},{key:"texture",value:function(t,e,n,i,r,o,a,s,u,l,c,h){this.setShaderTexture(t);var d=null;d=void 0===i||null===i?t:t.getSubtexture(i,this.texToDraw);var p=-d.frame.x,y=-d.frame.y;if(void 0===c&&(c=d.bounds.width),void 0===h&&(h=d.bounds.height),this.topleft.set(p,y),this.topright.set(p+c,y),this.botleft.set(p,y+h),this.botright.set(p+c,y+h),!o||0===o.x&&0===o.y||(this.topleft.sub(o),this.topright.sub(o),this.botleft.sub(o),this.botright.sub(o)),!a||1===a.x&&1===a.y||(this.topleft.mult(a),this.topright.mult(a),this.botleft.mult(a),this.botright.mult(a)),s&&0!==s){var v=Math.sin(s),g=Math.cos(s);this.topleft.rotate(v,g),this.topright.rotate(v,g),this.botleft.rotate(v,g),this.botright.rotate(v,g)}var m=d.bounds.x/d.texture.width,_=d.bounds.y/d.texture.height,b=m+c/d.texture.width,x=_+h/d.texture.height;if(u){var w=m;m=b,b=w}if(l){var k=_;_=x,x=k}var O=r||f.Color.white;this.push(e+this.topleft.x,n+this.topleft.y,m,_,O),this.pushUnsafe(e+this.topright.x,n+this.topright.y,b,_,O),this.pushUnsafe(e+this.botright.x,n+this.botright.y,b,x,O),this.pushUnsafe(e+this.topleft.x,n+this.topleft.y,m,_,O),this.pushUnsafe(e+this.botright.x,n+this.botright.y,b,x,O),this.pushUnsafe(e+this.botleft.x,n+this.botleft.y,m,x,O)}},{key:"quad",value:function(t,e,n,i,r,o,a,s){if(this.topleft.set(0,0),this.topright.set(0+n,0),this.botleft.set(0,0+i),this.botright.set(0+n,0+i),!o||0===o.x&&0===o.y||(this.topleft.sub(o),this.topright.sub(o),this.botleft.sub(o),this.botright.sub(o)),!a||1===a.x&&1===a.y||(this.topleft.mult(a),this.topright.mult(a),this.botleft.mult(a),this.botright.mult(a)),s&&0!==s){var u=Math.sin(s),l=Math.cos(s);this.topleft.rotate(u,l),this.topright.rotate(u,l),this.botleft.rotate(u,l),this.botright.rotate(u,l)}r||f.Color.white,this.push(t+this.topleft.x,e+this.topleft.y,0,0,r),this.pushUnsafe(t+this.topright.x,e+this.topright.y,0,0,r),this.pushUnsafe(t+this.botright.x,e+this.botright.y,0,0,r),this.pushUnsafe(t+this.topleft.x,e+this.topleft.y,0,0,r),this.pushUnsafe(t+this.botright.x,e+this.botright.y,0,0,r),this.pushUnsafe(t+this.botleft.x,e+this.botleft.y,0,0,r)}},{key:"rect",value:function(t,e,n,i,r){null!=this.shader.sampler2d&&this.setShaderTexture(this._pixel);var o=this._pixelUVs;this.push(t,e,o[0].x,o[0].y,r),this.pushUnsafe(t+n,e,o[1].x,o[1].y,r),this.pushUnsafe(t+n,e+i,o[2].x,o[2].y,r),this.pushUnsafe(t,e,o[0].x,o[0].y,r),this.pushUnsafe(t,e+i,o[3].x,o[3].y,r),this.pushUnsafe(t+n,e+i,o[2].x,o[2].y,r)}},{key:"triangle",value:function(t,e,n,i,r,o){null!=this.shader.sampler2d&&this.setShaderTexture(this._pixel),void 0===r&&(r=i),void 0===o&&(o=i);var a=this._pixelUVs;this.push(t.x,t.y,a[0].x,a[0].y,i),this.pushUnsafe(e.x,e.y,a[1].x,a[1].y,r),this.pushUnsafe(n.x,n.y,a[2].x,a[2].y,o)}},{key:"circle",value:function(t,e,n,i,r){null!=this.shader.sampler2d&&this.setShaderTexture(this._pixel),void 0===r&&(r=i),this.checkState();for(var o=this._pixelUVs,a=new g.Vector(t.x+e,t.y),s=1;s<=n;s++){var u=s/n*Math.PI*2,l=new g.Vector(t.x+Math.cos(u),t.y+Math.sin(u));this.pushUnsafe(t.x,t.y,o[0].x,o[0].y,i),this.pushUnsafe(a.x,a.y,o[1].x,o[1].y,r),this.pushUnsafe(l.x,l.y,o[2].x,o[2].y,r),a=l}}},{key:"hollowRect",value:function(t,e,n,i,r,o){this.rect(t,e,n,r,o),this.rect(t,e+r,r,i-2*r,o),this.rect(t+n-r,e+r,r,i-2*r,o),this.rect(t,e+i-r,n,r,o)}},{key:"shader",get:function(){return null!=this.nextShader?this.nextShader:this.currentShader},set:function(t){this.shader!=t&&null!=t&&(this.nextShader=t)}},{key:"blendmode",get:function(){return null!=this.nextBlendmode?this.nextBlendmode:this.currentBlendmode},set:function(t){this.currentBlendmode!=t&&null!=t&&(this.nextBlendmode=t)}},{key:"pixel",set:function(t){null==t&&(t=this._defaultPixel);var e=t.bounds.left/t.texture.width,n=t.bounds.top/t.texture.height,i=t.bounds.right/t.texture.width,r=t.bounds.bottom/t.texture.height;this._pixel=t,this._pixelUVs=[new g.Vector(e,n),new g.Vector(i,n),new g.Vector(i,r),new g.Vector(e,r)]},get:function(){return this._pixel}}],[{key:"_initCanvas",value:function(t){t.onselectstart=function(){return!1},h.Engine.root.appendChild(t)}},{key:"checkCanvasSize",value:function(t){t.width===h.Engine.root.clientWidth&&t.height===h.Engine.root.clientHeight||(t.width=h.Engine.root.clientWidth,t.height=h.Engine.root.clientHeight)}}]),t}();e.Graphics=b},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(2),o=i(r),a=n(3),s=i(a),u=n(0),l=i(u),c=n(1),h=i(c);Object.defineProperty(e,"__esModule",{value:!0});var f=n(21),d=n(13),p=function(){function t(){(0,l.default)(this,t)}return(0,h.default)(t,null,[{key:"init",value:function(){window.addEventListener("gamepadconnected",t.onAddController,!1),window.addEventListener("gamepaddisconnected",t.onRemoveController,!1)}},{key:"onAddController",value:function(e){var n=!0,i=!1,r=void 0;try{for(var o,a=t.controllers[Symbol.iterator]();!(n=(o=a.next()).done);n=!0)if(o.value.gamepad===e.gamepad)return}catch(t){i=!0,r=t}finally{try{!n&&a.return&&a.return()}finally{if(i)throw r}}e.gamepad.id.includes("Unknown Gamepad")||t.controllers.push(new ControllerInput(e.gamepad))}},{key:"onRemoveController",value:function(t){}},{key:"getController",value:function(e){return t.controllers[e]}},{key:"numControllers",value:function(){return t.controllers.length}},{key:"setRemoveControllerBehavior",value:function(e){t.onRemoveController=e}}]),t}();p.defaultDeadzone=.3,p.controllers=[],e.GamepadManager=p;var ControllerInput=function(t){function ControllerInput(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:p.defaultDeadzone;(0,l.default)(this,ControllerInput);var n=(0,o.default)(this,(ControllerInput.__proto__||Object.getPrototypeOf(ControllerInput)).call(this));n.leftStick=new d.Vector,n.rightStick=new d.Vector,n.buttons=[],n.gamepad=t,n.deadzone=e;for(var i=0;i<t.buttons.length;i++)n.buttons.push(new y);return n}return(0,s.default)(ControllerInput,t),(0,h.default)(ControllerInput,[{key:"update",value:function(){var t=this.queryGamepad();this.leftStick.x=t.axes[0],this.leftStick.y=t.axes[1],this.rightStick.x=t.axes[2],this.rightStick.y=t.axes[3];for(var e=0;e<this.buttons.length;e++)this.buttons[e].update(t.buttons[e].pressed)}},{key:"getButton",value:function(t){return this.buttons[t]}},{key:"getLeftStick",value:function(){return this.leftStick.length>this.deadzone?this.leftStick.clone():d.Vector.zero}},{key:"getRightStick",value:function(){return this.rightStick.length>this.deadzone?this.rightStick.clone():d.Vector.zero}},{key:"getRawLeftStick",value:function(){return this.leftStick.clone()}},{key:"getRawRightStick",value:function(){return this.rightStick.clone()}},{key:"queryGamepad",value:function(){return navigator.getGamepads()[this.gamepad.index]}}]),ControllerInput}(f.Component),y=function(){function t(){(0,l.default)(this,t),this._last=!1,this._next=!1}return(0,h.default)(t,[{key:"update",value:function(t){this._last=this._next,this._next=t}},{key:"down",value:function(){return this._next}},{key:"pressed",value:function(){return this._next&&!this._last}},{key:"released",value:function(){return this._last&&!this._next}}]),t}()},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a);Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(){(0,o.default)(this,t)}return(0,s.default)(t,null,[{key:"init",value:function(){window.addEventListener("keydown",function(e){t._next[e.keyCode]=!0}),window.addEventListener("keyup",function(e){t._next[e.keyCode]=!1})}},{key:"update",value:function(){for(var e=0;e<256;e++)t._last[e]=t._down[e],t._down[e]=t._next[e]}},{key:"check",value:function(e){return isNaN(e)?t.mapCheck(e):1==t._down[e]}},{key:"pressed",value:function(e){return isNaN(e)?t.mapPressed(e):1==t._down[e]&&!t._last[e]}},{key:"released",value:function(e){return isNaN(e)?t.mapReleased(e):!t._down[e]&&1==t._last[e]}},{key:"map",value:function(e,n){t._map[e]||(t._map[e]=[]);for(var i=0;i<n.length;i++)t._map[e].push(n[i])}},{key:"maps",value:function(e){for(var n in e)t.map(n,e[n])}},{key:"mapCheck",value:function(e){if(void 0!=t._map[e])for(var n=0;n<t._map[e].length;n++)if(t.check(t._map[e][n]))return!0;return!1}},{key:"mapPressed",value:function(e){if(void 0!=t._map[e])for(var n=0;n<t._map[e].length;n++)if(t.pressed(t._map[e][n]))return!0;return!1}},{key:"mapReleased",value:function(e){if(void 0!=t._map[e])for(var n=0;n<t._map[e].length;n++)if(t.released(t._map[e][n]))return!0;return!1}}]),t}();u._down=[],u._last=[],u._next=[],u._map={},e.Keyboard=u,function(t){t[t.backspace=8]="backspace",t[t.tab=9]="tab",t[t.enter=13]="enter",t[t.shift=16]="shift",t[t.ctrl=17]="ctrl",t[t.alt=18]="alt",t[t.pause=19]="pause",t[t.capslock=20]="capslock",t[t.escape=27]="escape",t[t.space=32]="space",t[t.pageUp=33]="pageUp",t[t.pageDown=34]="pageDown",t[t.end=35]="end",t[t.home=36]="home",t[t.left=37]="left",t[t.up=38]="up",t[t.right=39]="right",t[t.down=40]="down",t[t.insert=45]="insert",t[t.del=46]="del",t[t.zero=48]="zero",t[t.one=49]="one",t[t.two=50]="two",t[t.three=51]="three",t[t.four=52]="four",t[t.five=53]="five",t[t.six=54]="six",t[t.seven=55]="seven",t[t.eight=56]="eight",t[t.nine=57]="nine",t[t.a=65]="a",t[t.b=66]="b",t[t.c=67]="c",t[t.d=68]="d",t[t.e=69]="e",t[t.f=70]="f",t[t.g=71]="g",t[t.h=72]="h",t[t.i=73]="i",t[t.j=74]="j",t[t.k=75]="k",t[t.l=76]="l",t[t.m=77]="m",t[t.n=78]="n",t[t.o=79]="o",t[t.p=80]="p",t[t.q=81]="q",t[t.r=82]="r",t[t.s=83]="s",t[t.t=84]="t",t[t.u=85]="u",t[t.v=86]="v",t[t.w=87]="w",t[t.x=88]="x",t[t.y=89]="y",t[t.z=90]="z",t[t.leftWindow=91]="leftWindow",t[t.rightWindow=92]="rightWindow",t[t.select=93]="select",t[t.numpad0=96]="numpad0",t[t.numpad1=97]="numpad1",t[t.numpad2=98]="numpad2",t[t.numpad3=99]="numpad3",t[t.numpad4=100]="numpad4",t[t.numpad5=101]="numpad5",t[t.numpad6=102]="numpad6",t[t.numpad7=103]="numpad7",t[t.numpad8=104]="numpad8",t[t.numpad9=105]="numpad9",t[t.multiply=106]="multiply",t[t.add=107]="add",t[t.subtract=109]="subtract",t[t.decimal=110]="decimal",t[t.divide=111]="divide",t[t.f1=112]="f1",t[t.f2=113]="f2",t[t.f3=114]="f3",t[t.f4=115]="f4",t[t.f5=116]="f5",t[t.f6=117]="f6",t[t.f7=118]="f7",t[t.f8=119]="f8",t[t.f9=120]="f9",t[t.f10=121]="f10",t[t.f11=122]="f11",t[t.f12=123]="f12",t[t.numlock=144]="numlock",t[t.scrollLock=145]="scrollLock",t[t.semicolon=186]="semicolon",t[t.equal=187]="equal",t[t.comma=188]="comma",t[t.dash=189]="dash",t[t.period=190]="period",t[t.forwardSlash=191]="forwardSlash",t[t.graveAccent=192]="graveAccent",t[t.openBracket=219]="openBracket",t[t.backSlash=220]="backSlash",t[t.closeBraket=221]="closeBraket",t[t.singleQuote=222]="singleQuote"}(e.Key||(e.Key={}))},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(17),o=i(r),a=n(0),s=i(a),u=n(1),l=i(u);Object.defineProperty(e,"__esModule",{value:!0});var c=n(8),h=n(7),f=function(){function t(e,n){(0,s.default)(this,t),this.id=-1,this.position=new h.Vector(0,0),this.visible=!0,this.active=!0,this.isCreated=!1,this.isStarted=!1,this.components=new h.ObjectList,this.componentByName={},this.groups=[],this._depth=0,this.id=t._next_id++,void 0!==e&&(this.x=e),void 0!==n&&(this.y=n),this.group("sprite")}return(0,l.default)(t,[{key:"toString",value:function(){return"<Entity "+this.id+" '"+(this.name||"[noname]")+"'>"}},{key:"getComponentByName",value:function(t){var e=this.componentByName[t];if(!e)throw Error("no component named "+t);return e}},{key:"created",value:function(){}},{key:"added",value:function(){}},{key:"started",value:function(){}},{key:"removed",value:function(){}},{key:"recycled",value:function(){}},{key:"destroyed",value:function(){}},{key:"update",value:function(){this.components.each(function(t){t.active&&t.update()})}},{key:"lateUpdate",value:function(){this.components.each(function(t){t.active&&t.lateUpdate()})}},{key:"render",value:function(t){this.components.each(function(e){e.visible&&e.render(t)})}},{key:"debugRender",value:function(t){c.Engine.graphics.triangle(h.Vector.temp0.set(this.x+9,this.y),h.Vector.temp1.set(this.x+9-3,this.y-3),h.Vector.temp2.set(this.x+9-3,this.y+3),h.Color.red),c.Engine.graphics.rect(this.x,this.y,10,1,h.Color.red),c.Engine.graphics.triangle(h.Vector.temp0.set(this.x,this.y-9),h.Vector.temp1.set(this.x-3,this.y-9+3),h.Vector.temp2.set(this.x+3,this.y-9+3),h.Color.green),c.Engine.graphics.rect(this.x,this.y,1,-10,h.Color.green),this.components.each(function(e){e.visible&&e.debugRender(t)})}},{key:"add",value:function(t){return this.components.add(t),t.entity=this,t.addedToEntity(),null!=this.scene&&this.scene._trackComponent(t),t}},{key:"remove",value:function(t){return this.components.remove(t),t.removedFromEntity(),t.entity=null,null!=this.scene&&this.scene._untrackComponent(t),this._removeNamedComponent(t),t}},{key:"_removeNamedComponent",value:function(t){var e=[],n=!0,i=!1,r=void 0;try{for(var a,s=Object.entries(this.componentByName)[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var u=(0,o.default)(a.value,2),l=u[0];u[1]===t&&e.push(l)}}catch(t){i=!0,r=t}finally{try{!n&&s.return&&s.return()}finally{if(i)throw r}}var c=!0,h=!1,f=void 0;try{for(var d,p=e[Symbol.iterator]();!(c=(d=p.next()).done);c=!0){var l=d.value;delete this.componentByName[l]}}catch(t){h=!0,f=t}finally{try{!c&&p.return&&p.return()}finally{if(h)throw f}}}},{key:"removeAll",value:function(){for(var t=this.components.count-1;t>=0;t--)this.remove(this.components[t]);this.componentByName={}}},{key:"find",value:function(t){var e=null;return this.components.each(function(n){if(n instanceof t)return e=n,!1}),e}},{key:"findAll",value:function(t){var e=[];return this.components.each(function(n){n instanceof t&&e.push(n)}),e}},{key:"group",value:function(t){this.groups.push(t),null!=this.scene&&this.scene._groupEntity(this,t)}},{key:"ungroup",value:function(t){var e=this.groups.indexOf(t);e>=0&&(this.groups.splice(e,1),null!=this.scene&&this.scene._ungroupEntity(this,t))}},{key:"ingroup",value:function(t){return this.groups.indexOf(t)>=0}},{key:"x",get:function(){return this.position.x},set:function(t){this.position.x=t}},{key:"y",get:function(){return this.position.y},set:function(t){this.position.y=t}},{key:"depth",get:function(){return this._depth},set:function(t){if(null==this.scene)throw Error("Cannot set depth without being attached to a scene");if(this._depth!==t){this._depth=t,this.scene.entities.unsorted=!0;var e=!0,n=!1,i=void 0;try{for(var r,o=this.groups[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var a=r.value;this.scene.groups[a].unsorted=!0}}catch(t){n=!0,i=t}finally{try{!e&&o.return&&o.return()}finally{if(n)throw i}}}}}]),t}();f._next_id=1,e.Entity=f},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(34),o=i(r),a=n(0),s=i(a),u=n(1),l=i(u);Object.defineProperty(e,"__esModule",{value:!0});var c=n(40),h=n(8),f=n(102),d=n(7),p=function(){function t(){(0,s.default)(this,t),this.camera=new d.Camera,this.entities=new d.ObjectList,this.renderers=new d.ObjectList,this.groups={},this.colliders={},this.cache={},this.earlyUpdate=[],this._markedForDestruction=[],this.camera=new d.Camera,this.addRenderer(new f.SpriteRenderer)}return(0,l.default)(t,[{key:"begin",value:function(){}},{key:"ended",value:function(){}},{key:"dispose",value:function(){var t=this;this.renderers.each(function(t){return t.dispose()}),this.renderers.clear(),this.entities.each(function(e){return t.destroy(e)}),this.entities.clear(),this.colliders={},this.groups={},this.cache={}}},{key:"update",value:function(){var t=!0,e=!1,n=void 0;try{for(var i,r=this.earlyUpdate[Symbol.iterator]();!(t=(i=r.next()).done);t=!0)(0,i.value)()}catch(t){e=!0,n=t}finally{try{!t&&r.return&&r.return()}finally{if(e)throw n}}this.entities.each(function(t){t.isStarted||(t.isStarted=!0,t.started()),t.active&&t.isStarted&&t.update()}),this.entities.each(function(t){t.active&&t.isStarted&&t.lateUpdate()});var o=!0,a=!1,s=void 0;try{for(var u,l=this._markedForDestruction[Symbol.iterator]();!(o=(u=l.next()).done);o=!0){var c=u.value;this.destroy(c)}}catch(t){a=!0,s=t}finally{try{!o&&l.return&&l.return()}finally{if(a)throw s}}this.renderers.each(function(t){t.visible&&t.update()}),this.entities.clean(),this.renderers.clean();for(var h in this.groups)this.groups[h].clean()}},{key:"render",value:function(){var t=this;this.entities.sort(function(t,e){return e.depth-t.depth});for(var e in this.groups)this.groups[e].sort(function(t,e){return e.depth-t.depth});this.renderers.each(function(t){t.visible&&t.preRender()}),this.renderers.each(function(t){t.visible&&t.render()}),this.renderers.each(function(t){t.visible&&t.postRender()}),h.Engine.debugMode&&(h.Engine.graphics.setRenderTarget(h.Engine.graphics.buffer),h.Engine.graphics.shader=d.Shaders.primitive,h.Engine.graphics.shader.set("matrix",this.camera.matrix),this.debugRender(this.camera),this.entities.each(function(e){e.active&&e.debugRender(t.camera)}))}},{key:"debugRender",value:function(t){}},{key:"add",value:function(t,e){var n=this;t.scene=this,this.entities.add(t),void 0!==e&&t.position.set(e.x,e.y),t.isCreated||(t.isCreated=!0,t.created());var i=!0,r=!1,o=void 0;try{for(var a,s=t.groups[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var u=a.value;this._groupEntity(t,u)}}catch(t){r=!0,o=t}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}return t.components.each(function(t){return n._trackComponent(t)}),t.added(),t}},{key:"recreate",value:function(t){if(Array.isArray(this.cache[t])&&this.cache[t].length>0){var e=this.cache[t][0];return this.cache[t].splice(0,1),this.add(e)}return null}},{key:"recycle",value:function(t,e){this.remove(e),void 0===this.cache[t]&&(this.cache[t]=[]),this.cache[t].push(e),e.recycled()}},{key:"remove",value:function(t){var e=this;t.removed(),t.components.each(function(t){return e._untrackComponent(t)});var n=!0,i=!1,r=void 0;try{for(var o,a=t.groups[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;this._ungroupEntity(t,s)}}catch(t){i=!0,r=t}finally{try{!n&&a.return&&a.return()}finally{if(i)throw r}}t.isStarted=!1,t.scene=null,this.entities.remove(t)}},{key:"removeAll",value:function(){var t=this;this.entities.each(function(e){return t.remove(e)})}},{key:"destroy",value:function(t){null!=t.scene&&this.remove(t),t.destroyed(),t.isCreated=!1}},{key:"destroyLater",value:function(t){this._markedForDestruction.push(t)}},{key:"findAllComponents",value:function(t){var e=[];return this.entities.each(function(n){e.push.apply(e,(0,o.default)(n.findAll(t)))}),e}},{key:"find",value:function(t){var e=null;return this.entities.each(function(n){if(n instanceof t)return e=n,!1}),e}},{key:"findEach",value:function(t,e){this.entities.each(function(n){if(n instanceof t)return e(n)})}},{key:"findAll",value:function(t){var e=[];return this.entities.each(function(n){n instanceof t&&e.push(n)}),e}},{key:"firstInGroup",value:function(t){return void 0!==this.groups[t]&&this.groups[t].count>0?this.groups[t].first():null}},{key:"eachInGroup",value:function(t,e){void 0!==this.groups[t]&&this.groups[t].each(e)}},{key:"allInGroup",value:function(t){return void 0!==this.groups[t]?this.groups[t]:null}},{key:"eachInGroups",value:function(t,e){for(var n=!1,i=0;i<t.length&&!n;i++)this.eachInGroup(t[i],function(t){var i=e(t);return!1===i&&(n=!0),i})}},{key:"allInGroups",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;null!=e&&void 0!==e||(e=new d.ObjectList);var n=!0,i=!1,r=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,u=this.allInGroup(s);null!=u&&u.each(function(t){return e.add(t)})}}catch(t){i=!0,r=t}finally{try{!n&&a.return&&a.return()}finally{if(i)throw r}}return e}},{key:"firstColliderInTag",value:function(t){return void 0!==this.colliders[t]&&this.colliders[t].length>0?this.colliders[t][0]:null}},{key:"allCollidersInTag",value:function(t){return void 0!==this.colliders[t]?this.colliders[t]:[]}},{key:"addRenderer",value:function(t){return t.scene=this,this.renderers.add(t),this.renderers.sort(function(t,e){return d.Calc.cmp(t.sortOrder,e.sortOrder)}),t}},{key:"removeRenderer",value:function(t,e){return this.renderers.remove(t),e&&t.dispose(),t.scene=null,t}},{key:"_groupEntity",value:function(t,e){void 0===this.groups[e]&&(this.groups[e]=new d.ObjectList),this.groups[e].add(t)}},{key:"_ungroupEntity",value:function(t,e){void 0!==this.groups[e]&&this.groups[e].remove(t)}},{key:"_trackComponent",value:function(t){if(null==t.entity||t.entity.scene!==this)throw Error("Component must be added through an existing entity");if(t instanceof c.Collider){var e=!0,n=!1,i=void 0;try{for(var r,o=t.tags[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var a=r.value;this._trackCollider(t,a)}}catch(t){n=!0,i=t}finally{try{!e&&o.return&&o.return()}finally{if(n)throw i}}}t.scene=this,t.addedToScene()}},{key:"_untrackComponent",value:function(t){if(t.removedFromScene(),t instanceof c.Collider){var e=!0,n=!1,i=void 0;try{for(var r,o=t.tags[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var a=r.value;this._untrackCollider(t,a)}}catch(t){n=!0,i=t}finally{try{!e&&o.return&&o.return()}finally{if(n)throw i}}}t.scene=null}},{key:"_trackCollider",value:function(t,e){void 0===this.colliders[e]&&(this.colliders[e]=[]),this.colliders[e].push(t)}},{key:"_untrackCollider",value:function(t,e){if(void 0!==this.colliders[e]){var n=this.colliders[e].indexOf(t);n>=0&&(this.colliders[e].splice(n,1),this.colliders[e].length<=0&&delete this.colliders[e])}}}]),t}();e.Scene=p},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a);Object.defineProperty(e,"__esModule",{value:!0});var u=n(186),l=n(8),c=n(101),h=n(48),f=n(104),d=n(53),p=function(){function t(e){(0,o.default)(this,t),this.root="",this._loading=!1,this._loaded=!1,this.assets=0,this.assetsLoaded=0,this.textures=[],this.jsons=[],this.xmls=[],this.sounds=[],this.atlases=[],this.texts=[],this.pending={},this.root=e||""}return(0,s.default)(t,[{key:"checkLoading",value:function(){if(this.loading||this.loaded)throw Error("Cannot add more assets when already loaded")}},{key:"addTexture",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.checkLoading(),this.textures.push({path:t,colorKey:e}),this.assets++,this}},{key:"addJson",value:function(t){return this.checkLoading(),this.jsons.push(t),this.assets++,this}},{key:"addXml",value:function(t){return this.checkLoading(),this.xmls.push(t),this.assets++,this}},{key:"addText",value:function(t){return this.checkLoading(),this.texts.push(t),this.assets++,this}},{key:"addSound",value:function(t,e){return this.checkLoading(),this.sounds.push({handle:t,path:e}),this.assets++,this}},{key:"addAtlas",value:function(t,e,n,i){return this.checkLoading(),this.atlases.push({name:t,image:e,data:n,loader:i}),this.assets+=3,this}},{key:"load",value:function(t){this._loading=!0,this.callback=t;var e=!0,n=!1,i=void 0;try{for(var r,o=this.textures[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var a=r.value,s=c.FosterIO.join(this.root,a.path);this.loadTexture({path:s,colorKey:a.colorKey})}}catch(t){n=!0,i=t}finally{try{!e&&o.return&&o.return()}finally{if(n)throw i}}var u=!0,l=!1,h=void 0;try{for(var f,d=this.jsons[Symbol.iterator]();!(u=(f=d.next()).done);u=!0){var p=f.value;this.loadJson(c.FosterIO.join(this.root,p))}}catch(t){l=!0,h=t}finally{try{!u&&d.return&&d.return()}finally{if(l)throw h}}var y=!0,v=!1,g=void 0;try{for(var m,_=this.xmls[Symbol.iterator]();!(y=(m=_.next()).done);y=!0){var b=m.value;this.loadXml(c.FosterIO.join(this.root,b))}}catch(t){v=!0,g=t}finally{try{!y&&_.return&&_.return()}finally{if(v)throw g}}var x=!0,w=!1,k=void 0;try{for(var O,S=this.texts[Symbol.iterator]();!(x=(O=S.next()).done);x=!0){var E=O.value;this.loadText(c.FosterIO.join(this.root,E))}}catch(t){w=!0,k=t}finally{try{!x&&S.return&&S.return()}finally{if(w)throw k}}var T=!0,P=!1,C=void 0;try{for(var R,j=this.sounds[Symbol.iterator]();!(T=(R=j.next()).done);T=!0){var M=R.value;this.loadSound(M.handle,c.FosterIO.join(this.root,M.path))}}catch(t){P=!0,C=t}finally{try{!T&&j.return&&j.return()}finally{if(P)throw C}}var A=!0,L=!1,F=void 0;try{for(var B,D=this.atlases[Symbol.iterator]();!(A=(B=D.next()).done);A=!0){var G=B.value;this.loadAtlas(G)}}catch(t){L=!0,F=t}finally{try{!A&&D.return&&D.return()}finally{if(L)throw F}}}},{key:"unload",value:function(){if(this.loading)throw Error("Cannot unload until finished loading");if(!this.loaded)throw Error("Cannot unload before loading");throw Error("Asset Unloading not Implemented")}},{key:"markPending",value:function(t,e){var n=this,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];window.assetLoader=this;var r=this.pending[t]||(this.pending[t]=[]);i?r.push(e):r.splice(r.indexOf(e),1);var o=!1;return function(){o||(o=!0,n.markPending(t,e,!1))}}},{key:"loadTexture",value:function(t,e){var n=this,i=t.path,r=(l.Engine.graphics.gl,new Image),o=this.markPending("texture",i);r.addEventListener("load",function(){var a=d.Texture.create(r,t.colorKey);a.texture.path=i,h.Assets.textures[n.pathify(i)]=a,o(),void 0!==e&&e(a),n.incrementLoader()}),r.src=i}},{key:"loadJson",value:function(t,e){var n=this,i=this,r=this.markPending("json",t);c.FosterIO.read(t,function(o){var a=n.pathify(t);h.Assets.json[a]=JSON.parse(o),r(),void 0!==e&&e(h.Assets.json[a]),i.incrementLoader()})}},{key:"loadXml",value:function(t,e){var n=this,i=this.markPending("xml",t);c.FosterIO.read(t,function(r){var o=n.pathify(t);h.Assets.xml[o]=(new DOMParser).parseFromString(r,"text/xml"),i(),void 0!==e&&e(h.Assets.xml[o]),n.incrementLoader()})}},{key:"loadText",value:function(t,e){var n=this,i=this.markPending("text",t);c.FosterIO.read(t,function(r){var o=n.pathify(t);h.Assets.text[o]=r,i(),void 0!==e&&e(h.Assets.text[o]),n.incrementLoader()})}},{key:"loadSound",value:function(t,e,n){var i=this,r=new Audio,o=this.markPending("sound",e);r.addEventListener("canplaythrough",function(){h.Assets.sounds[t]=new u.AudioSource(e,r),o(),void 0!==n&&n(h.Assets.sounds[t]),i.incrementLoader()}),r.src=e}},{key:"loadAtlas",value:function(t){function e(){if(null!=i&&null!=r){var e=new f.Atlas(t.name,i,r,t.loader);h.Assets.atlases[e.name]=e,n.incrementLoader()}}var n=this,i=null,r=null;this.loadText(c.FosterIO.join(this.root,t.data),function(t){r=t,e()}),this.loadTexture({path:c.FosterIO.join(this.root,t.image),colorKey:null},function(t){i=t,e()})}},{key:"incrementLoader",value:function(){this.assetsLoaded++,this.progressCallback&&this.progressCallback(this.assetsLoaded/this.assets),this.assetsLoaded===this.assets&&(this._loaded=!0,this._loading=!1,void 0!==this.callback&&this.callback())}},{key:"pathify",value:function(t){for(;t.indexOf("\\")>=0;)t=t.replace("\\","/");return t}},{key:"loading",get:function(){return this._loading}},{key:"loaded",get:function(){return this._loaded}},{key:"percent",get:function(){return this.assetsLoaded/this.assets}}]),t}();e.AssetLoader=p},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a);Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(e,n){(0,o.default)(this,t),this.sounds=[],this.path=e,n&&this.sounds.push(n)}return(0,s.default)(t,[{key:"requestSound",value:function(){if(this.sounds.length>0){var e=this.sounds[0];return this.sounds.splice(0,1),e}if(this.sounds.length<t.maxInstances){var n=new Audio;return n.src=this.path,n}return null}},{key:"returnSound",value:function(t){this.sounds.push(t)}},{key:"dispose",value:function(){}}]),t}();u.maxInstances=50,e.AudioSource=u},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a);Object.defineProperty(e,"__esModule",{value:!0});var u=n(15),l=function(){function t(){(0,o.default)(this,t)}return(0,s.default)(t,null,[{key:"clearCompletedLevels",value:function(){this._setCompletedLevels([])}},{key:"markLevelCompleted",value:function(t){var e=this.completedLevels;-1===e.indexOf(t)&&e.push(t),this._setCompletedLevels(e)}},{key:"_setCompletedLevels",value:function(t){window.localStorage&&localStorage.setItem("completedLevels",JSON.stringify(t||[]))}},{key:"getNextLevelName",value:function(){var t=this.completedLevels,e=!0,n=!1,i=void 0;try{for(var r,o=u.Game.levels[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var a=r.value;if(-1===t.indexOf(a))return a}}catch(t){n=!0,i=t}finally{try{!e&&o.return&&o.return()}finally{if(n)throw i}}return null}},{key:"hasLevelsCompleted",get:function(){return this.completedLevels.length>0}},{key:"completedLevels",get:function(){return window.localStorage?JSON.parse(localStorage.getItem("completedLevels")||"[]"):[]}}]),t}();e.SaveGame=l},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(){var t=l.Assets.atlases.sprites,e={},n=!0,i=!1,r=void 0;try{for(var o,s=t.metadata.frameTags[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var f=o.value,d=f.name,p=f.direction;e[d]={direction:p}}}catch(t){i=!0,r=t}finally{try{!n&&s.return&&s.return()}finally{if(i)throw r}}var y=!0,v=!1,g=void 0;try{for(var m,_=Object.entries(t.subtextures)[Symbol.iterator]();!(y=(m=_.next()).done);y=!0){var b=(0,u.default)(m.value,2),d=b[0],x=b[1],w=d.split("_");if(!(w.length<2)){var k=(0,u.default)(w,2),O=k[0],S=k[1];S=S.replace(/\s+\d+$/,"");var E=c.SpriteBank.get(O)||c.SpriteBank.create(O),T=e[O+"_"+S];E.get(S)||E.add(S,h,[],!1);var P=E.get(S);if(P.frames.push(x),T&&(P.loops=!0,"pingpong"===T.direction)){var C=P.frames;C.push.apply(C,(0,a.default)(C.slice(0,C.length-1).reverse()))}}}}catch(t){v=!0,g=t}finally{try{!y&&_.return&&_.return()}finally{if(v)throw g}}}var o=n(34),a=i(o),s=n(17),u=i(s);Object.defineProperty(e,"__esModule",{value:!0});var l=n(35),c=n(54),h=10;e.loadAutoSprites=r},function(t,e,n){t.exports={default:n(190),__esModule:!0}},function(t,e,n){n(191),t.exports=n(18).Object.getPrototypeOf},function(t,e,n){var i=n(69),r=n(86);n(109)("getPrototypeOf",function(){return function(t){return r(i(t))}})},function(t,e,n){t.exports={default:n(193),__esModule:!0}},function(t,e,n){n(194);var i=n(18).Object;t.exports=function(t,e){return i.getOwnPropertyDescriptor(t,e)}},function(t,e,n){var i=n(23),r=n(73).f;n(109)("getOwnPropertyDescriptor",function(){return function(t,e){return r(i(t),e)}})},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a),u=n(2),l=i(u),c=n(3),h=i(c);Object.defineProperty(e,"__esModule",{value:!0});var f=n(21),d=n(8),Alarm=function(t){function Alarm(){(0,o.default)(this,Alarm);var t=(0,l.default)(this,(Alarm.__proto__||Object.getPrototypeOf(Alarm)).call(this));return t._percent=0,t.removeOnComplete=!1,t.active=t.visible=!1,t}return(0,h.default)(Alarm,t),(0,s.default)(Alarm,[{key:"start",value:function(t,e){return this._percent=0,this._duration=t,this.callback=e,this.active=!0,this}},{key:"restart",value:function(){return this._percent=0,this}},{key:"resume",value:function(){return this.percent<1&&(this.active=!0),this}},{key:"pause",value:function(){return this.active=!1,this}},{key:"update",value:function(){this.percent<1&&this.duration>0&&(this._percent+=d.Engine.delta/this.duration,this.percent>=1&&(this._percent=1,this.active=!1,this.callback(this),this.removeOnComplete&&this.entity.remove(this)))}},{key:"percent",get:function(){return this._percent}},{key:"duration",get:function(){return this._duration}}],[{key:"create",value:function(t){return t.add(new Alarm)}}]),Alarm}(f.Component);e.Alarm=Alarm},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a),u=n(2),l=i(u),c=n(3),h=i(c);Object.defineProperty(e,"__esModule",{value:!0});var f=n(8),d=n(50),p=n(13),y=n(12),Physics=function(t){function Physics(t){var e=t.left,n=t.top,i=t.width,r=t.height,a=t.tags,s=t.solids;(0,o.default)(this,Physics);var u=(0,l.default)(this,(Physics.__proto__||Object.getPrototypeOf(Physics)).call(this,{left:e,top:n,width:i,height:r,tags:a}));return u.solids=[],u.onCollide=[],u.speed=new p.Vector(0,0),u.remainder=new p.Vector(0,0),void 0!==s&&(u.solids=s),u}return(0,h.default)(Physics,t),(0,s.default)(Physics,[{key:"update",value:function(){0!==this.speed.x&&this.moveX(this.speed.x*f.Engine.delta),0!==this.speed.y&&this.moveY(this.speed.y*f.Engine.delta)}},{key:"moveBy",value:function(t){var e=this.moveX(t.x),n=this.moveY(t.y);return e&&n}},{key:"move",value:function(t,e){var n=this.moveX(t),i=this.moveY(e);return n&&i}},{key:"moveX",value:function(t){var e=t+this.remainder.x;return this.remainder.x=e%1,e-=this.remainder.x,this.moveXAbsolute(e)}},{key:"moveXAbsolute",value:function(t){var e=this.entity;if(this.solids.length<=0)e.x+=Math.round(t);else{var n=d.Calc.sign(t);for(t=Math.abs(Math.round(t));t>0;){var i=this.collides(this.solids,n,0),r=!(!i||!i.entity)&&i.entity===e;if(null!=i&&!r){this.remainder.x=0,null!=this.onCollideX&&this.onCollideX(i);var o=!0,a=!1,s=void 0;try{for(var u,l=this.onCollide[Symbol.iterator]();!(o=(u=l.next()).done);o=!0)(0,u.value)(!0,i)}catch(t){a=!0,s=t}finally{try{!o&&l.return&&l.return()}finally{if(a)throw s}}return!1}e.x+=n,t-=1}}return!0}},{key:"moveY",value:function(t){var e=t+this.remainder.y;return this.remainder.y=e%1,e-=this.remainder.y,this.moveYAbsolute(e)}},{key:"moveYAbsolute",value:function(t){var e=this.entity;if(this.solids.length<=0)e.y+=Math.round(t);else{var n=d.Calc.sign(t);for(t=Math.abs(Math.round(t));t>0;){var i=this.collides(this.solids,0,n),r=!(!i||!i.entity)&&i.entity===e;if(null!=i&&!r){this.remainder.y=0,null!=this.onCollideY&&this.onCollideY(i);var o=!0,a=!1,s=void 0;try{for(var u,l=this.onCollide[Symbol.iterator]();!(o=(u=l.next()).done);o=!0)(0,u.value)(!1,i)}catch(t){a=!0,s=t}finally{try{!o&&l.return&&l.return()}finally{if(a)throw s}}return!1}e.y+=n,t-=1}}return!0}},{key:"friction",value:function(t,e){return this.speed.x<0?this.speed.x=Math.min(0,this.speed.x+t*f.Engine.delta):this.speed.x>0&&(this.speed.x=Math.max(0,this.speed.x-t*f.Engine.delta)),this.speed.y<0?this.speed.y=Math.min(0,this.speed.y+e*f.Engine.delta):this.speed.y>0&&(this.speed.y=Math.max(0,this.speed.y-e*f.Engine.delta)),this}},{key:"maxspeed",value:function(t,e){return void 0!==t&&null!==t&&(this.speed.x=Math.max(-t,Math.min(t,this.speed.x))),void 0!==e&&null!==e&&(this.speed.y=Math.max(-e,Math.min(e,this.speed.y))),this}},{key:"circularMaxspeed",value:function(t){return this.speed.length>t&&this.speed.normalize().scale(t),this}},{key:"stop",value:function(){this.speed.x=this.speed.y=0,this.remainder.x=this.remainder.y=0}}]),Physics}(y.Hitbox);e.Physics=Physics},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a),u=n(2),l=i(u),c=n(3),h=i(c);Object.defineProperty(e,"__esModule",{value:!0});var f=n(21),d=n(8),Tween=function(t){function Tween(){(0,o.default)(this,Tween);var t=(0,l.default)(this,(Tween.__proto__||Object.getPrototypeOf(Tween)).call(this));return t._percent=0,t.from=0,t.to=0,t.ease=function(t){return t},t.removeOnComplete=!1,t.active=t.visible=!1,t}return(0,h.default)(Tween,t),(0,s.default)(Tween,[{key:"setOnComplete",value:function(t){return this.onComplete=t,this}},{key:"start",value:function(t,e,n,i,r,o){return this._percent=0,this._duration=t,this.from=e,this.to=n,this.ease=i,this.step=r,this.removeOnComplete=o,this}},{key:"restart",value:function(){return this._percent=0,this.active=!0,this}},{key:"resume",value:function(){return this.percent<1&&(this.active=!0),this}},{key:"pause",value:function(){return this.active=!1,this}},{key:"update",value:function(){this.percent<1&&this.duration>0&&(this._percent+=d.Engine.delta/this.duration,this.percent>=1?(this._percent=1,this.step(this.to),this.active=!1,this.onComplete&&this.onComplete(),this.removeOnComplete&&this.entity.remove(this)):this.step(this.value))}},{key:"percent",get:function(){return this._percent}},{key:"duration",get:function(){return this._duration}},{key:"value",get:function(){return this.from+(this.to-this.from)*this.ease(this.percent)}}],[{key:"create",value:function(t){var e=new Tween;return t.add(e),e}}]),Tween}(f.Component);e.Tween=Tween},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a),u=n(2),l=i(u),c=n(3),h=i(c);Object.defineProperty(e,"__esModule",{value:!0});var f=n(21),d=n(8),p=n(20),y=n(13),Rectsprite=function(t){function Rectsprite(t,e,n){(0,o.default)(this,Rectsprite);var i=(0,l.default)(this,(Rectsprite.__proto__||Object.getPrototypeOf(Rectsprite)).call(this));return i.size=new y.Vector(0,0),i.scale=new y.Vector(1,1),i.origin=new y.Vector(0,0),i.rotation=0,i.color=p.Color.white.clone(),i.alpha=1,i.size.x=t,i.size.y=e,i.color=n||p.Color.white,i}return(0,h.default)(Rectsprite,t),(0,s.default)(Rectsprite,[{key:"render",value:function(){null!=d.Engine.graphics.shader.sampler2d?d.Engine.graphics.texture(d.Engine.graphics.pixel,this.scenePosition.x,this.scenePosition.y,null,p.Color.temp.copy(this.color).mult(this.alpha),y.Vector.temp0.copy(this.origin).div(this.size),y.Vector.temp1.copy(this.size).mult(this.scale),this.rotation):d.Engine.graphics.quad(this.scenePosition.x,this.scenePosition.y,this.size.x,this.size.y,p.Color.temp.copy(this.color).mult(this.alpha),this.origin,this.scale,this.rotation)}},{key:"width",get:function(){return this.size.x},set:function(t){this.size.x=t}},{key:"height",get:function(){return this.size.y},set:function(t){this.size.y=t}}]),Rectsprite}(f.Component);e.Rectsprite=Rectsprite},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a),u=n(2),l=i(u),c=n(6),h=i(c),f=n(3),d=i(f);Object.defineProperty(e,"__esModule",{value:!0});var p=n(106),y=n(8),v=n(50),g=n(110),Sprite=function(t){function Sprite(t){var e=t.animation,n=t.origin,i=t.scale,r=t.play,a=t.flipX,s=t.x,u=t.y,c=t.rate,h=t.alpha,f=t.randomStartFrame;(0,o.default)(this,Sprite);var d=(0,l.default)(this,(Sprite.__proto__||Object.getPrototypeOf(Sprite)).call(this,null));return d._animation=null,d._playing=null,d._frame=0,d.verbose=!1,d.rate=1,void 0!==c&&(d.rate=c),void 0!==s&&(d.x=s),void 0!==u&&(d.y=u),void 0!==h&&(d.alpha=h),i&&void 0!==i.x&&d.scale.set(i.x,i.y),void 0!==a&&(d.flipX=a),y.Engine.assert(p.SpriteBank.has(e),"Missing animation '"+e+"'!"),d._animation=p.SpriteBank.get(e),d.texture=d._animation.first.frames[0],"center"===n&&d.justify(.5,.5),r&&d.play(r,!1,{randomFrame:f}),d}return(0,d.default)(Sprite,t),(0,s.default)(Sprite,[{key:"play",value:function(t,e,n){if(null!=this.animation){var i=this.animation.get(t);null==i||this.playing===i&&!e||(this._playing=i,this._frame=n&&n.randomFrame?Math.floor(v.Calc.range(0,this._playing.frames.length)):0,this.active=!0,this._playing.frames.length>0&&(this.texture=this._playing.frames[0]))}}},{key:"has",value:function(t){return null!=this.animation&&this.animation.has(t)}},{key:"update",value:function(){if(null!=this.playing){if(this._frame+=this.playing.speed*this.rate*y.Engine.delta,this.verbose,this.frame>=this.playing.frames.length||this.frame<0)if(this.playing.loops){for(;this._frame>=this.playing.frames.length;)this._frame-=this.playing.frames.length;for(;this._frame<0;)this._frame+=this.playing.frames.length}else if(null!=this.playing.goto&&this.playing.goto.length>0){var t=this.playing.goto[Math.floor(Math.random()*this.playing.goto.length)];this.play(t,!0)}else this.active=!1,this.frame>=this.playing.frames.length?this._frame=this.playing.frames.length-1:this._frame=0;null!=this.playing&&(this.texture=this.playing.frames[this.frame])}}},{key:"render",value:function(t){null!=this.texture&&(0,h.default)(Sprite.prototype.__proto__||Object.getPrototypeOf(Sprite.prototype),"render",this).call(this,t)}},{key:"animation",get:function(){return this._animation}},{key:"playing",get:function(){return this._playing}},{key:"frame",get:function(){return Math.floor(this._frame)},set:function(t){this._frame=t,null!=this.playing&&(this._frame=v.Calc.clamp(t,0,this.playing.frames.length),this.texture=this.playing.frames[this.frame])}}]),Sprite}(g.Graphic);e.Sprite=Sprite},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a),u=n(2),l=i(u),c=n(3),h=i(c);Object.defineProperty(e,"__esModule",{value:!0});var f=n(21),d=n(8),p=n(20),y=n(22),v=n(13),Tilemap=function(t){function Tilemap(t,e,n){(0,o.default)(this,Tilemap);var i=(0,l.default)(this,(Tilemap.__proto__||Object.getPrototypeOf(Tilemap)).call(this));return i.color=p.Color.white.clone(),i.alpha=1,i.map={},i.crop=new y.Rectangle,i._minTileX=0,i._minTileY=0,i._maxTileX=0,i._maxTileY=0,i._vec=new v.Vector,i.texture=t,i.tileWidth=e,i.tileHeight=n,i.tileColumns=Math.floor(i.texture.width/i.tileWidth),i}return(0,h.default)(Tilemap,t),(0,s.default)(Tilemap,[{key:"getSceneBounds",value:function(t){return t.set(this.sceneLeft,this.sceneTop,this.width,this.height)}},{key:"set",value:function(t,e,n,i,r,o){var a=t+e*this.tileColumns;return this.setIndex(a,n,i,r,o)}},{key:"setIndex",value:function(t,e,n,i,r){e>this._maxTileX&&(this._maxTileX=e),n>this._maxTileY&&(this._maxTileY=n);for(var o=e;o<e+(i||1);o++){void 0===this.map[o]&&(this.map[o]={});for(var a=n;a<n+(r||1);a++)this.map[o][a]=t}return this}},{key:"clear",value:function(t,e,n,i){for(var r=t;r<t+(n||1);r++)if(void 0!==this.map[r])for(var o=e;o<e+(i||1);o++)void 0!==this.map[r][o]&&delete this.map[r][o];return this}},{key:"has",value:function(t,e){return void 0!==this.map[t]&&void 0!==this.map[t][e]}},{key:"get",value:function(t,e){if(this.has(t,e)){var n=this.map[t][e];return new v.Vector(n%this.tileColumns,Math.floor(n/this.tileColumns))}return null}},{key:"getTileSubtexture",value:function(t,e){var n=Math.floor(t%this.tileColumns)*this.tileWidth,i=Math.floor(t/this.tileColumns)*this.tileHeight,r=new y.Rectangle(n,i,this.tileWidth,this.tileHeight);return this.texture.getSubtexture(r,e)}},{key:"render",value:function(t){var e=t.extents,n=this.scenePosition,i=Math.floor((e.left-n.x)/this.tileWidth)-1,r=Math.ceil((e.right-n.x)/this.tileWidth)+1,o=Math.floor((e.top-n.y)/this.tileHeight)-1,a=Math.ceil((e.bottom-n.y)/this.tileHeight)+1;this.crop.width=this.tileWidth,this.crop.height=this.tileHeight;for(var s=i;s<r;s++)if(void 0!==this.map[s])for(var u=o;u<a;u++){var l=this.map[s][u];void 0!==l&&(this.crop.x=l%this.tileColumns*this.tileWidth,this.crop.y=Math.floor(l/this.tileColumns)*this.tileHeight,d.Engine.graphics.texture(this.texture,n.x+s*this.tileWidth,n.y+u*this.tileHeight,this.crop,p.Color.temp.copy(this.color).mult(this.alpha)))}}},{key:"sceneLeft",get:function(){return this.getScenePosition(this._vec).x}},{key:"sceneTop",get:function(){return this.getScenePosition(this._vec).y}},{key:"width",get:function(){return(this._maxTileX-this._minTileX)*this.tileWidth}},{key:"height",get:function(){return(this._maxTileY-this._minTileY)*this.tileHeight}}]),Tilemap}(f.Component);e.Tilemap=Tilemap},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a),u=n(2),l=i(u),c=n(3),h=i(c);Object.defineProperty(e,"__esModule",{value:!0});var f=n(5),d=n(35),p=n(9),y=function(t){function e(t,n){(0,o.default)(this,e);var i=(0,l.default)(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return i.add(i.sprite=new p.Graphic(d.Assets.atlases.gfx.get("clouds "+t))),i.sprite.origin.set(i.sprite.width/2,i.sprite.height/2),i.depth=n,i.timerY=Math.random()*Math.PI*2,i.timerX=Math.random()*Math.PI*2,i}return(0,h.default)(e,t),(0,s.default)(e,[{key:"update",value:function(){this.timerY+=f.Engine.delta,this.timerX+=f.Engine.delta,this.sprite.x=4*Math.sin(2*this.timerX),this.sprite.y=2*Math.sin(this.timerY)}}]),e}(f.Entity);e.Clouds=y},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a),u=n(2),l=i(u),c=n(6),h=i(c),f=n(3),d=i(f),p=n(4),y=i(p);Object.defineProperty(e,"__esModule",{value:!0});var v=n(10),g=n(14),m=n(7),_=n(9),AutoTween=function(t){function AutoTween(){return(0,o.default)(this,AutoTween),(0,l.default)(this,(AutoTween.__proto__||Object.getPrototypeOf(AutoTween)).apply(this,arguments))}return(0,d.default)(AutoTween,t),(0,s.default)(AutoTween,[{key:"addedToScene",value:function(){var t=this;(0,h.default)(AutoTween.prototype.__proto__||Object.getPrototypeOf(AutoTween.prototype),"addedToScene",this).call(this);var e=m.Ease[this.opts.ease||"linear"],n=void 0;if("scale"!==this.opts.mode)throw Error("unimplemented "+this.opts.mode);var i=this.entity.find(_.Sprite);n=function(t){i.scale.set(t,t)};var r=void 0!==this.opts.from?this.opts.from:0,o=void 0!==this.opts.to?this.opts.to:0;n(r),this.activeTween=g.Tween.create(this.entity).start(this.opts.duration,r,o,e,n).setOnComplete(function(){t.activeTween=null}).restart()}}]),AutoTween}(v.AutoComponent);AutoTween=function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===("undefined"==typeof Reflect?"undefined":(0,y.default)(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a}([v.AutoComponent.register],AutoTween),e.AutoTween=AutoTween},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(4),o=i(r),a=n(0),s=i(a),u=n(1),l=i(u),c=n(2),h=i(c),f=n(3),d=i(f);Object.defineProperty(e,"__esModule",{value:!0});var p=n(21),y=n(8),v=n(50),g=n(20),m=n(13),_=n(113),b=n(114),ParticleSystem=function(t){function ParticleSystem(t){(0,s.default)(this,ParticleSystem);var e=(0,h.default)(this,(ParticleSystem.__proto__||Object.getPrototypeOf(ParticleSystem)).call(this));return e.renderRelativeToEntity=!1,e.particles=[],"object"===(void 0===t?"undefined":(0,o.default)(t))&&(t=t.template),e.templateName=t,e}return(0,d.default)(ParticleSystem,t),(0,l.default)(ParticleSystem,[{key:"update",value:function(){for(var t=y.Engine.delta,e=this.particles.length-1;e>=0;e--){var n=this.particles[e];n.percent>=1?(this.particles.splice(e,1),ParticleSystem.cache.push(n)):(n.percent=Math.min(1,n.percent+t/n.duration),n.x+=n.speedX*t,n.y+=n.speedY*t,n.speedX+=n.accelX*t,n.speedY+=n.accelY*t,n.speedX=v.Calc.approach(n.speedX,0,n.frictionX*t),n.speedY=v.Calc.approach(n.speedY,0,n.frictionY*t))}}},{key:"render",value:function(t){var e=this.template.texture;if(null==e&&(e=y.Engine.graphics.pixel),null==e)throw Error("Particle requires a Texture");var n=this.position;this.renderRelativeToEntity&&(n=this.scenePosition);var i=this.template,r=!0,o=!1,a=void 0;try{for(var s,u=this.particles[Symbol.iterator]();!(r=(s=u.next()).done);r=!0){var l=s.value,c=l.percent,h=n.x+l.x,f=n.y+l.y,d=l.scaleFromX+(l.scaleToX-l.scaleFromX)*i.scaleXEaser(c),p=l.scaleFromY+(l.scaleToY-l.scaleFromY)*i.scaleYEaser(c),v=l.rotationFrom+(l.rotationTo-l.rotationFrom)*i.rotationEaser(c),g=l.alphaFrom+(l.alphaTo-l.alphaFrom)*i.alphaEaser(c),m=ParticleSystem.color.lerp(l.colorFrom,l.colorTo,i.colorEaser(c)).mult(g);y.Engine.graphics.texture(e,h,f,null,m,ParticleSystem.origin,ParticleSystem.scale.set(d,p),v)}}catch(t){o=!0,a=t}finally{try{!r&&u.return&&u.return()}finally{if(o)throw a}}}},{key:"burst",value:function(t,e,n,i,r,o){var a=this.template;void 0!==i&&null!==i||(i=0),void 0!==r&&null!==r||(r=0),void 0===o&&(o=1);for(var s=0;s<o;s++){var u=a.durationBase+v.Calc.range(a.durationRange);if(!(u<=0)){var l=null;l=ParticleSystem.cache.length>0?ParticleSystem.cache.splice(0,1)[0]:new _.Particle;var c=a.speedBase+v.Calc.range(a.speedRange);l.percent=0,l.duration=u,l.x=this.scenePosition.x+t+v.Calc.range(i),l.y=this.scenePosition.y+e+v.Calc.range(r),l.colorFrom=v.Calc.choose(a.colorsFrom),l.colorTo=v.Calc.choose(a.colorsTo),l.speedX=Math.cos(n)*c,l.speedY=-Math.sin(n)*c,l.accelX=a.accelBaseX+v.Calc.range(a.accelRangeX),l.accelY=a.accelBaseY+v.Calc.range(a.accelRangeY),l.frictionX=a.frictionBaseX+v.Calc.range(a.frictionRangeX),l.frictionY=a.frictionBaseY+v.Calc.range(a.frictionRangeY),l.scaleFromX=a.scaleFromBaseX+v.Calc.range(a.scaleFromRangeX),l.scaleFromY=a.scaleFromBaseY+v.Calc.range(a.scaleFromRangeY),l.scaleToX=a.scaleToBaseX+v.Calc.range(a.scaleToRangeX),l.scaleToY=a.scaleToBaseY+v.Calc.range(a.scaleToRangeY),l.rotationFrom=a.rotationFromBase+v.Calc.range(a.rotationFromRange),l.rotationTo=a.rotationToBase+v.Calc.range(a.rotationToRange),l.alphaFrom=a.alphaFromBase+v.Calc.range(a.alphaFromRange),l.alphaTo=a.alphaToBase+v.Calc.range(a.alphaToRange),this.particles.push(l)}}}},{key:"template",get:function(){return b.ParticleTemplate.templates[this.templateName]}},{key:"numActiveParticles",get:function(){return this.particles.length}},{key:"activeParticles",get:function(){return this.particles}}]),ParticleSystem}(p.Component);ParticleSystem.cache=[],ParticleSystem.color=new g.Color,ParticleSystem.origin=new m.Vector(.5,.5),ParticleSystem.scale=new m.Vector(0,0),e.ParticleSystem=ParticleSystem},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a),u=n(2),l=i(u),c=n(6),h=i(c),f=n(3),d=i(f),p=n(4),y=i(p);Object.defineProperty(e,"__esModule",{value:!0});var v=n(5),g=n(16),m=n(77),_=n(116),b=n(43),Emitter=function(t){function Emitter(t){var e=t.prefab,n=void 0===e?"":e,i=t.flipFromBody,r=void 0===i?void 0:i,a=t.onEmit;(0,o.default)(this,Emitter);var s=(0,l.default)(this,(Emitter.__proto__||Object.getPrototypeOf(Emitter)).call(this));return s.prefab=n,s.onEmit=new b.EventDelegate(a),s.flipFromBody=r,s}return(0,d.default)(Emitter,t),(0,s.default)(Emitter,[{key:"addedToScene",value:function(){(0,h.default)(Emitter.prototype.__proto__||Object.getPrototypeOf(Emitter.prototype),"addedToScene",this).call(this),this.onEmit.bind(this.entity)}},{key:"emit",value:function(){if(this.active){var t=this.scenePosition,e=t.x,n=t.y,i=g.instantiatePrefab(this.prefab,new v.Entity(e,n)),r=this.entity.find(_.Flip),o=i.find(m.Mover);r&&r.flipX&&o&&(o.opts={x:-o.opts.x,y:o.opts.y}),this.scene.add(i),this.onEmit.invoke()}}}]),Emitter}(v.Component);Emitter=function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===("undefined"==typeof Reflect?"undefined":(0,y.default)(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a}([v.Component.register,function(t,e){if("object"===("undefined"==typeof Reflect?"undefined":(0,y.default)(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],Emitter),e.Emitter=Emitter},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a),u=n(2),l=i(u),c=n(6),h=i(c),f=n(3),d=i(f),p=n(4),y=i(p),v=function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===("undefined"==typeof Reflect?"undefined":(0,y.default)(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},g=function(t,e){if("object"===("undefined"==typeof Reflect?"undefined":(0,y.default)(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var m=n(5),_=n(12),b=n(9),x=n(10),w=n(15);n(11);var Exit=function(t){function Exit(){(0,o.default)(this,Exit);var t=(0,l.default)(this,(Exit.__proto__||Object.getPrototypeOf(Exit)).apply(this,arguments));return t.isOpen=!1,t.triggered=!1,t}return(0,d.default)(Exit,t),(0,s.default)(Exit,[{key:"addedToScene",value:function(){(0,h.default)(Exit.prototype.__proto__||Object.getPrototypeOf(Exit.prototype),"addedToScene",this).call(this),this.sprite.play("closed")}},{key:"update",value:function(){this.isOpen||0!==this.scene.allCollidersInTag("treasure").length?!this.triggered&&this.isOpen&&this.hitbox.check(w.Game.TAGS.PLAYER)&&(this.triggered=!0,this.level&&this.level.nextLevel()):(this.isOpen=!0,this.sprite.play("open"),this.hitbox.untag(w.Game.TAGS.SOLID))}}]),Exit}(x.AutoComponent);v([m.Component.require,g("design:type",b.Sprite)],Exit.prototype,"sprite",void 0),v([m.Component.require,g("design:type",_.Hitbox)],Exit.prototype,"hitbox",void 0),Exit=v([x.AutoComponent.register],Exit),e.Exit=Exit},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a),u=n(2),l=i(u),c=n(3),h=i(c),f=n(4),d=i(f),p=function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===("undefined"==typeof Reflect?"undefined":(0,d.default)(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(e,"__esModule",{value:!0});var y=n(10),v=n(9),g=n(7);n(11);var Facing=function(t){function Facing(){return(0,o.default)(this,Facing),(0,l.default)(this,(Facing.__proto__||Object.getPrototypeOf(Facing)).apply(this,arguments))}return(0,h.default)(Facing,t),(0,s.default)(Facing,[{key:"findClosestPlayerHitbox",value:function(){var t=this.scene.allCollidersInTag("player");if(g.Vector.temp0.set(this.sprite.sceneCenterX,this.sprite.sceneCenterY),0!==t.length)return t.sort(function(t,e){return g.Vector.distance(t.getScenePosition(g.Vector.temp1),e.getScenePosition(g.Vector.temp2))}),t[0]}},{key:"update",value:function(){var t=this.findClosestPlayerHitbox();t&&(this.sprite.flipX=t.sceneCenterX>this.sprite.sceneCenterX,this.sprite.play(Math.abs(t.sceneCenterX-this.sprite.sceneCenterX)<24?"face_in":"face_out"))}}]),Facing}(y.AutoComponent);p([y.AutoComponent.require,function(t,e){if("object"===("undefined"==typeof Reflect?"undefined":(0,d.default)(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:type",v.Sprite)],Facing.prototype,"sprite",void 0),Facing=p([y.AutoComponent.register],Facing),e.Facing=Facing},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a),u=n(2),l=i(u),c=n(6),h=i(c),f=n(3),d=i(f),p=n(4),y=i(p),v=function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===("undefined"==typeof Reflect?"undefined":(0,y.default)(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(e,"__esModule",{value:!0});var g=n(5),m=n(14),_=n(7);n(11);var Floats=function(t){function Floats(){(0,o.default)(this,Floats);var t=(0,l.default)(this,(Floats.__proto__||Object.getPrototypeOf(Floats)).apply(this,arguments));return t.floatTime=1.64,t.lastLeft=-1,t.lastTop=-1,t.timeToFloat=1e3,t}return(0,d.default)(Floats,t),(0,s.default)(Floats,[{key:"addedToScene",value:function(){(0,h.default)(Floats.prototype.__proto__||Object.getPrototypeOf(Floats.prototype),"addedToScene",this).call(this)}},{key:"updateOld",value:function(){var t=this;if(this.lastLeft===this.physics.sceneLeft&&this.lastTop===this.physics.sceneTop&&this.physics.check("water")?this.timeToFloat-=g.Engine.delta:this.timeToFloat=this.floatTime,this.timeToFloat<=0){this.timeToFloat=this.floatTime;var e=this.scenePosition,n=_.Ease.linear;m.Tween.create(this.entity).start(.5,e.x,e.x+24,n,function(e){t.physics.moveX(e-t.physics.scenePosition.x)},!0).restart()}this.lastLeft=this.physics.sceneLeft,this.lastTop=this.physics.sceneTop}}]),Floats}(g.Component);v([g.Component.require,function(t,e){if("object"===("undefined"==typeof Reflect?"undefined":(0,y.default)(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:type",m.Physics)],Floats.prototype,"physics",void 0),Floats=v([g.Component.register],Floats),e.Floats=Floats},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a),u=n(2),l=i(u),c=n(3),h=i(c),f=n(4),d=i(f),p=function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===("undefined"==typeof Reflect?"undefined":(0,d.default)(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},y=function(t,e){if("object"===("undefined"==typeof Reflect?"undefined":(0,d.default)(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var v=n(5),g=n(14),m=n(10),_=n(7),b=n(111),x=n(12),w=n(14),k=n(9),O=n(31);n(11);var Medusa=function(t){function Medusa(){(0,o.default)(this,Medusa);var t=(0,l.default)(this,(Medusa.__proto__||Object.getPrototypeOf(Medusa)).apply(this,arguments));return t.lastKillTime=-1e3,t.triggered=!1,t}return(0,h.default)(Medusa,t),(0,s.default)(Medusa,[{key:"update",value:function(){if(this.awareness.killing.length>0){this.lastKillTime=v.Engine.elapsed,this.sprite.play("fire");var t=!0,e=!1,n=void 0;try{for(var i,r=this.awareness.killing[Symbol.iterator]();!(t=(i=r.next()).done);t=!0){var o=i.value;this.triggerDeath(o)}}catch(t){e=!0,n=t}finally{try{!t&&r.return&&r.return()}finally{if(e)throw n}}}else this.awareness.wouldKill||v.Engine.elapsed-this.lastKillTime<1?this.sprite.play("fire"):-1!==this.awareness.xrayGroups.indexOf("player")?this.sprite.play("alert"):this.sprite.play("asleep")}},{key:"triggerDeath",value:function(t){var e=t.entity;if(e instanceof O.Player)e.kill();else if("grey_orb"===e.name){e.find(k.Sprite).play("disintegrate"),e.ungroup("player"),e.findAll(x.Collider).forEach(function(t){return t.untag("player")});var n=e.find(k.Sprite);w.Alarm.create(e).start(.31,function(){return e.scene.remove(e)}),g.Tween.create(e).start(.3,1,0,_.Ease.linear,function(t){n.alpha=t},!0).restart()}else e.scene.remove(e)}}]),Medusa}(m.AutoComponent);p([m.AutoComponent.require,y("design:type",k.Sprite)],Medusa.prototype,"sprite",void 0),p([m.AutoComponent.require,y("design:type",b.Awareness)],Medusa.prototype,"awareness",void 0),Medusa=p([m.AutoComponent.register],Medusa),e.Medusa=Medusa},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a),u=n(2),l=i(u),c=n(3),h=i(c),f=n(4),d=i(f),p=function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===("undefined"==typeof Reflect?"undefined":(0,d.default)(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},y=function(t,e){if("object"===("undefined"==typeof Reflect?"undefined":(0,d.default)(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var v=n(5),g=n(9),m=n(55);n(11);var GraphicHitEffect=function(t){function GraphicHitEffect(t){var e=t.deathAnim;(0,o.default)(this,GraphicHitEffect);var n=(0,l.default)(this,(GraphicHitEffect.__proto__||Object.getPrototypeOf(GraphicHitEffect)).call(this));return n.playedDead=!1,n.deathAnim=e,n}return(0,h.default)(GraphicHitEffect,t),(0,s.default)(GraphicHitEffect,[{key:"update",value:function(){var t=!0;this.health.invincible&&(t=v.Engine.frameCount%2==0),!this.playedDead&&this.deathAnim&&this.health.dead&&(this.playedDead=!0,this.graphic.play(this.deathAnim)),this.graphic.visible=t}}]),GraphicHitEffect}(v.Component);p([v.Component.require,y("design:type",g.Graphic)],GraphicHitEffect.prototype,"graphic",void 0),p([v.Component.require,y("design:type",m.Health)],GraphicHitEffect.prototype,"health",void 0),GraphicHitEffect=p([v.Component.register,y("design:paramtypes",[Object])],GraphicHitEffect),e.GraphicHitEffect=GraphicHitEffect},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a),u=n(2),l=i(u),c=n(6),h=i(c),f=n(3),d=i(f),p=n(4),y=i(p),v=function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===("undefined"==typeof Reflect?"undefined":(0,y.default)(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},g=function(t,e){if("object"===("undefined"==typeof Reflect?"undefined":(0,y.default)(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var m=n(5),_=n(14),b=n(12),x=n(7),w=n(55);n(11);var KnockBack=function(t){function KnockBack(){(0,o.default)(this,KnockBack);var t=(0,l.default)(this,(KnockBack.__proto__||Object.getPrototypeOf(KnockBack)).apply(this,arguments));return t.factor=3.4,t.speed=new x.Vector,t}return(0,d.default)(KnockBack,t),(0,s.default)(KnockBack,[{key:"addedToScene",value:function(){var t=this;(0,h.default)(KnockBack.prototype.__proto__||Object.getPrototypeOf(KnockBack.prototype),"addedToScene",this).call(this),this.health.onDamage.push(function(e){if(t.speed.set(0,0),e){var n=e.entity.find(b.Hitbox);if(n){var i=x.Vector.temp0.set(n.sceneLeft+n.width/2,n.sceneTop+n.height/2);t.speed.copy(t.entity.position).sub(i).normalize().mult(100).mult(t.factor)}t.physics.speed.add(t.speed)}})}}]),KnockBack}(m.Component);v([m.Component.require,g("design:type",w.Health)],KnockBack.prototype,"health",void 0),v([m.Component.require,g("design:type",_.Physics)],KnockBack.prototype,"physics",void 0),KnockBack=v([m.Component.register],KnockBack),e.KnockBack=KnockBack},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(2),s=i(a),u=n(3),l=i(u),c=n(4),h=i(c);Object.defineProperty(e,"__esModule",{value:!0});var f=n(10),ParentEntity=function(t){function ParentEntity(t){(0,o.default)(this,ParentEntity);var e=(0,s.default)(this,(ParentEntity.__proto__||Object.getPrototypeOf(ParentEntity)).call(this,t));return e.parent=t.parent,e}return(0,l.default)(ParentEntity,t),ParentEntity}(f.AutoComponent);ParentEntity=function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===("undefined"==typeof Reflect?"undefined":(0,h.default)(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a}([f.AutoComponent.register,function(t,e){if("object"===("undefined"==typeof Reflect?"undefined":(0,h.default)(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],ParentEntity),e.ParentEntity=ParentEntity},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a),u=n(2),l=i(u),c=n(6),h=i(c),f=n(3),d=i(f),p=n(4),y=i(p);Object.defineProperty(e,"__esModule",{value:!0});var v=n(10),g=n(5),m=n(42);n(11);var ParticleLoop=function(t){function ParticleLoop(){return(0,o.default)(this,ParticleLoop),(0,l.default)(this,(ParticleLoop.__proto__||Object.getPrototypeOf(ParticleLoop)).apply(this,arguments))}return(0,d.default)(ParticleLoop,t),(0,s.default)(ParticleLoop,[{key:"addedToScene",value:function(){(0,h.default)(ParticleLoop.prototype.__proto__||Object.getPrototypeOf(ParticleLoop.prototype),"addedToScene",this).call(this),this.pSys=this.entity.find(m.ParticleSystem),this.pSys||(this.pSys=this.entity.add(new m.ParticleSystem(this.opts.template))),this.pSys.template.name,this.opts.template}},{key:"update",value:function(){g.Engine.elapsed,this.rate}},{key:"rate",get:function(){return void 0===this.opts.rate?50:this.opts.rate}}]),ParticleLoop}(v.AutoComponent);ParticleLoop=function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===("undefined"==typeof Reflect?"undefined":(0,y.default)(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a}([v.AutoComponent.register],ParticleLoop),e.ParticleLoop=ParticleLoop},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a),u=n(2),l=i(u),c=n(6),h=i(c),f=n(3),d=i(f),p=n(4),y=i(p),v=function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===("undefined"==typeof Reflect?"undefined":(0,y.default)(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(e,"__esModule",{value:!0});var g=n(10),m=n(5),_=n(9),b=n(7);n(11);var Shake=function(t){function Shake(){(0,o.default)(this,Shake);var t=(0,l.default)(this,(Shake.__proto__||Object.getPrototypeOf(Shake)).apply(this,arguments));return t.startTime=Number.POSITIVE_INFINITY,t.startPos=new b.Vector,t}return(0,d.default)(Shake,t),(0,s.default)(Shake,[{key:"addedToScene",value:function(){(0,h.default)(Shake.prototype.__proto__||Object.getPrototypeOf(Shake.prototype),"addedToScene",this).call(this),this.opts.autoPlay&&this.play()}},{key:"play",value:function(){this.startTime=m.Engine.elapsed,this.startPos.copy(this.graphic.position)}},{key:"update",value:function(){(0,h.default)(Shake.prototype.__proto__||Object.getPrototypeOf(Shake.prototype),"update",this).call(this);var t=m.Engine.elapsed-this.startTime;t<0||(this.graphic.position.copy(this.startPos),t<this.opts.time?this.graphic.position.add(b.Vector.temp1.set(b.Calc.range(this.opts.amount),b.Calc.range(this.opts.amount))):this.startTime=Number.POSITIVE_INFINITY)}}]),Shake}(g.AutoComponent);v([g.AutoComponent.require,function(t,e){if("object"===("undefined"==typeof Reflect?"undefined":(0,y.default)(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:type",_.Graphic)],Shake.prototype,"graphic",void 0),Shake=v([g.AutoComponent.register],Shake),e.Shake=Shake},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a),u=n(2),l=i(u),c=n(6),h=i(c),f=n(3),d=i(f),p=n(4),y=i(p),v=function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===("undefined"==typeof Reflect?"undefined":(0,y.default)(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},g=function(t,e){if("object"===("undefined"==typeof Reflect?"undefined":(0,y.default)(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var m=n(5),_=n(12),b=n(115),x=n(15);n(11);var Spikes=function(t){function Spikes(t){var e=t.delay,n=void 0===e?.6:e,i=t.spikeUpTime,r=void 0===i?2.2:i;(0,o.default)(this,Spikes);var a=(0,l.default)(this,(Spikes.__proto__||Object.getPrototypeOf(Spikes)).call(this));return a.lastTriggerTime=-1e3,a.state="Dormant",a.delay=n,a.spikeUpTime=r,a}return(0,d.default)(Spikes,t),(0,s.default)(Spikes,[{key:"addedToScene",value:function(){(0,h.default)(Spikes.prototype.__proto__||Object.getPrototypeOf(Spikes.prototype),"addedToScene",this).call(this),this.spikeSprite=this.entity.componentByName.spines}},{key:"update",value:function(){var t=m.Engine.elapsed,e=t-this.lastTriggerTime,n=this.spikeSprite,i=this.delay+this.spikeUpTime;switch(n.visible="Dormant"!==this.state,this.causesDamage.active=e>this.delay&&e<i,this.state){case"Dormant":e>i&&this.hitbox.check(x.Game.TAGS.PLAYER)&&(this.lastTriggerTime=t,this.state="Triggered",n.rate=1);break;case"Triggered":e>this.delay&&(n.play("thrust",!0),this.state="Up");break;case"Up":e>i&&(n.rate=0,n.frame=0,this.state="Dormant");break;default:throw Error(this.state)}}}]),Spikes}(m.Component);v([m.Component.require,g("design:type",_.Hitbox)],Spikes.prototype,"hitbox",void 0),v([m.Component.require,g("design:type",b.CausesDamage)],Spikes.prototype,"causesDamage",void 0),Spikes=v([m.Component.register,g("design:paramtypes",[Object])],Spikes),e.Spikes=Spikes},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a),u=n(2),l=i(u),c=n(3),h=i(c),f=n(4),d=i(f);Object.defineProperty(e,"__esModule",{value:!0});var p=n(5),y=n(9),SpriteAutoPlay=function(t){function SpriteAutoPlay(t){var e=t.animationName;(0,o.default)(this,SpriteAutoPlay);var n=(0,l.default)(this,(SpriteAutoPlay.__proto__||Object.getPrototypeOf(SpriteAutoPlay)).call(this));return n.animationName=e,n}return(0,h.default)(SpriteAutoPlay,t),(0,s.default)(SpriteAutoPlay,[{key:"addedToScene",value:function(){this.entity.find(y.Sprite).play(this.animationName)}}]),SpriteAutoPlay}(p.Component);SpriteAutoPlay=function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===("undefined"==typeof Reflect?"undefined":(0,d.default)(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a}([p.Component.register,function(t,e){if("object"===("undefined"==typeof Reflect?"undefined":(0,d.default)(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],SpriteAutoPlay),e.SpriteAutoPlay=SpriteAutoPlay},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a),u=n(2),l=i(u),c=n(6),h=i(c),f=n(3),d=i(f),p=n(4),y=i(p),v=function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===("undefined"==typeof Reflect?"undefined":(0,y.default)(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(e,"__esModule",{value:!0});var g=n(10),m=n(9),_=n(43),SpriteEvents=function(t){function SpriteEvents(){(0,o.default)(this,SpriteEvents);var t=(0,l.default)(this,(SpriteEvents.__proto__||Object.getPrototypeOf(SpriteEvents)).apply(this,arguments));return t.wasPlaying=!1,t}return(0,d.default)(SpriteEvents,t),(0,s.default)(SpriteEvents,[{key:"addedToScene",value:function(){(0,h.default)(SpriteEvents.prototype.__proto__||Object.getPrototypeOf(SpriteEvents.prototype),"addedToScene",this).call(this),this.onFinish=new _.EventDelegate(this.opts.onFinish,this.entity)}},{key:"update",value:function(){!this.wasPlaying&&this.sprite.active?this.wasPlaying=!0:this.wasPlaying&&!this.sprite.active&&this.onFinish.invoke()}}]),SpriteEvents}(g.AutoComponent);v([g.AutoComponent.require,function(t,e){if("object"===("undefined"==typeof Reflect?"undefined":(0,y.default)(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:type",m.Sprite)],SpriteEvents.prototype,"sprite",void 0),SpriteEvents=v([g.AutoComponent.register],SpriteEvents),e.SpriteEvents=SpriteEvents},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(2),s=i(a),u=n(3),l=i(u),c=n(4),h=i(c);Object.defineProperty(e,"__esModule",{value:!0});var f=n(5),Teleport=function(t){function Teleport(t){(0,o.default)(this,Teleport);var e=(0,s.default)(this,(Teleport.__proto__||Object.getPrototypeOf(Teleport)).call(this));return e.name=t,e}return(0,l.default)(Teleport,t),Teleport}(f.Component);Teleport=function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===("undefined"==typeof Reflect?"undefined":(0,h.default)(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a}([f.Component.register,function(t,e){if("object"===("undefined"==typeof Reflect?"undefined":(0,h.default)(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[String])],Teleport),e.Teleport=Teleport},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a),u=n(2),l=i(u),c=n(6),h=i(c),f=n(3),d=i(f),p=n(4),y=i(p);Object.defineProperty(e,"__esModule",{value:!0});var v=n(5),g=n(12),m=n(15),_=n(43),Trigger=function(t){function Trigger(t){var e=t.active,n=t.hitboxName,i=t.onTrigger;(0,o.default)(this,Trigger);var r=(0,l.default)(this,(Trigger.__proto__||Object.getPrototypeOf(Trigger)).call(this,{active:e}));return r.triggerEvery=1,r.lastTrigger=-1,r.hitboxName=n,r.onTrigger=new _.EventDelegate(i),r}return(0,d.default)(Trigger,t),(0,s.default)(Trigger,[{key:"completeLevel",value:function(){this.scene.completeLevel()}},{key:"addedToScene",value:function(){(0,h.default)(Trigger.prototype.__proto__||Object.getPrototypeOf(Trigger.prototype),"addedToScene",this).call(this),void 0!==this.hitboxName?this.hitbox=this.entity.componentByName[this.hitboxName]:this.hitbox=this.entity.find(g.Hitbox),this.onTrigger.bind(this.entity)}},{key:"update",value:function(){if((0,h.default)(Trigger.prototype.__proto__||Object.getPrototypeOf(Trigger.prototype),"update",this).call(this),this.hitbox.check(m.Game.TAGS.PLAYER)){var t=v.Engine.elapsed;this.lastTrigger+this.triggerEvery>=t||(this.lastTrigger=t,this.onTrigger.invoke())}}}]),Trigger}(v.Component);Trigger=function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===("undefined"==typeof Reflect?"undefined":(0,y.default)(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a}([v.Component.register,function(t,e){if("object"===("undefined"==typeof Reflect?"undefined":(0,y.default)(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],Trigger),e.Trigger=Trigger},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t){var e,n;return x.default.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:e=0;case 1:if(!(e<t.height)){i.next=12;break}n=0;case 3:if(!(n<t.width)){i.next=9;break}return i.next=6,[n,e];case 6:++n,i.next=3;break;case 9:++e,i.next=1;break;case 12:case"end":return i.stop()}},w[0],this)}function o(t,e){var n=void 0,i=t.getMapLocationByName("water_source",!1);if(i){var o=i.getScenePosition(S.Vector.temp1).sub(e.getScenePosition(S.Vector.temp2)).div(S.Vector.temp3.set(e.tileWidth,e.tileHeight)),a=o.x,s=o.y;e.has(a,s)&&(n=[a,s])}if(!n){var u=!0,l=!1,c=void 0;try{for(var h,f=r(e)[Symbol.iterator]();!(u=(h=f.next()).done);u=!0){var d=(0,_.default)(h.value,2),p=d[0],y=d[1];if(e.has(p,y)){n=[p,y];break}}}catch(t){l=!0,c=t}finally{try{!u&&f.return&&f.return()}finally{if(l)throw c}}}if(n){var v={},g={},m=function(t){var e=(0,_.default)(t,2);return e[0]+"_"+e[1]};g[m(n)]=!0;for(var b=[n],x=0;b.length>0&&++x<1e4;){var w=(0,_.default)(b.splice(0,1)[0],2),k=w[0],O=w[1],E=(m([k,O]),[]),P=!0,C=!1,R=void 0;try{for(var j,M=T[Symbol.iterator]();!(P=(j=M.next()).done);P=!0){var A=(0,_.default)(j.value,2),L=A[0],F=A[1],B=k+L,D=O+F,G=m([B,D]);!g[G]&&e.has(B,D)&&(g[G]=!0,E.push([L,F]),b.push([B,D]))}}catch(t){C=!0,R=t}finally{try{!P&&M.return&&M.return()}finally{if(C)throw R}}void 0===v[k]&&(v[k]={}),v[k][O]=E}return{flowmap:v,numTiles:x}}}var a=n(34),s=i(a),u=n(0),l=i(u),c=n(1),h=i(c),f=n(2),d=i(f),p=n(6),y=i(p),v=n(3),g=i(v),m=n(17),_=i(m),b=n(52),x=i(b),w=[r].map(x.default.mark);Object.defineProperty(e,"__esModule",{value:!0});var k=n(5),O=n(42),S=n(7),E=n(121),T=[[1,0],[0,1],[-1,0],[0,-1]],WaterFlow=function(t){function WaterFlow(t){var e=t.tilemap,n=t.hitgrid;(0,l.default)(this,WaterFlow);var i=(0,d.default)(this,(WaterFlow.__proto__||Object.getPrototypeOf(WaterFlow)).call(this));return i.currentStrength=10,i.rects=[],i.prewarmed=!1,i.debugSub=new S.Color(200,0,200,.8),i.tilemap=e,i.hitgrid=n,i}return(0,g.default)(WaterFlow,t),(0,h.default)(WaterFlow,[{key:"worldToMap",value:function(t){var e=this.scenePosition;t.x=Math.floor((t.x-e.x)/this.tilemap.tileWidth),t.y=Math.floor((t.y-e.y)/this.tilemap.tileHeight)}},{key:"trackObject",value:function(t){this.solids.trackObject(t);var e=[],n=[t.sceneBounds.getCenter(new S.Vector)],i=!0,r=!1,o=void 0;try{for(var a,u=n[Symbol.iterator]();!(i=(a=u.next()).done);i=!0){var l=a.value,c=this.getAtWorld(l);c&&c.length>0&&e.push.apply(e,(0,s.default)(c))}}catch(t){r=!0,o=t}finally{try{!i&&u.return&&u.return()}finally{if(r)throw o}}if(this.directionLastFrame){var h=!0,f=!1,d=void 0;try{for(var p,y=e[Symbol.iterator]();!(h=(p=y.next()).done);h=!0){var v=p.value;if(v[0]===this.directionLastFrame[0]&&v[1]===this.directionLastFrame[1])return v}}catch(t){f=!0,d=t}finally{try{!h&&y.return&&y.return()}finally{if(f)throw d}}}return e.length>0?(this.directionLastFrame=e[0],this.directionLastFrame):void(this.directionLastFrame=void 0)}},{key:"initWaterflow",value:function(){this.map=o(this.scene,this.tilemap);for(var t=this.scenePosition,e=this.tilemap,n=e.tileWidth,i=e.tileHeight,r=0;r<this.tilemap.height;++r)for(var a=0;a<this.tilemap.width;++a)this.has(a,r)&&this.rects.push(new S.Rectangle(t.x+a*n,t.y+r*i,n,i));this.solids=new E.HitgridWithHoles(this.hitgrid.tileWidth,this.hitgrid.tileHeight,["water_solid"]);var s=!0,u=!1,l=void 0;try{for(var c,h=this.hitgrid.tiles()[Symbol.iterator]();!(s=(c=h.next()).done);s=!0){var f=(0,_.default)(c.value,2),d=f[0],p=f[1];this.solids.set(!0,d,p)}}catch(t){u=!0,l=t}finally{try{!s&&h.return&&h.return()}finally{if(u)throw l}}this.hitgrid.entity.add(this.solids),this.particles=this.entity.add(new O.ParticleSystem("water"))}},{key:"update",value:function(){if((0,y.default)(WaterFlow.prototype.__proto__||Object.getPrototypeOf(WaterFlow.prototype),"update",this).call(this),this.map||this.initWaterflow(),!this.prewarmed){this.prewarmed=!0;for(var t=0;t<1e3;++t)this.update()}var e=this.scenePosition,n=this.rects[Math.floor(S.Calc.range(0,this.rects.length))],i=this.tilemap,r=i.tileWidth,o=i.tileHeight;this.particles.activeParticles.length<10*this.map.numTiles&&this.particles.burst(n.x+r/2,n.y+o/2,0,r/2,o/2,5);var a=!0,s=!1,u=void 0;try{for(var l,c=this.particles.activeParticles[Symbol.iterator]();!(a=(l=c.next()).done);a=!0){var h=l.value,f=Math.floor((h.x-e.x)/r),d=Math.floor((h.y-e.y)/o),p=void 0!==this.map.flowmap[f]?this.map.flowmap[f][d]:void 0;if(p){var v=!0,g=!1,m=void 0;try{for(var b,x=p[Symbol.iterator]();!(v=(b=x.next()).done);v=!0){var w=(0,_.default)(b.value,2),k=w[0],O=w[1];h.accelX=Math.min(25*k*.4,48),h.accelY=Math.min(25*O*.4,48)}}catch(t){g=!0,m=t}finally{try{!v&&x.return&&x.return()}finally{if(g)throw m}}}else h.percent=1}}catch(t){s=!0,u=t}finally{try{!a&&c.return&&c.return()}finally{if(s)throw u}}}},{key:"has",value:function(t,e){return void 0!==this.map.flowmap[t]&&!!this.map.flowmap[t][e]}},{key:"getAtWorld",value:function(t){var e=this.scenePosition,n=Math.floor((t.x-e.x)/this.tilemap.tileWidth),i=Math.floor((t.y-e.y)/this.tilemap.tileHeight);return void 0!==this.map.flowmap[n]?this.map.flowmap[n][i]:void 0}},{key:"debugRender",value:function(t){for(var e=k.Engine.graphics,n=this.tilemap,i=n.tileWidth,r=n.tileHeight,o=t.extents,a=this.scenePosition,s=Math.floor((o.left-a.x)/i)-1,u=Math.ceil((o.right-a.x)/i)+1,l=Math.floor((o.top-a.y)/r)-1,c=Math.ceil((o.bottom-a.y)/r)+1,h=s;h<u;h++)if(void 0!==this.map.flowmap[h])for(var f=l;f<c;f++)if(this.map.flowmap[h][f]){var d=a.x+h*i,p=a.y+f*r,y=new S.Color(1,0,1,.7),v=!0,g=!1,m=void 0;try{for(var b,x=this.map.flowmap[h][f][Symbol.iterator]();!(v=(b=x.next()).done);v=!0){var w=(0,_.default)(b.value,2),O=w[0],E=w[1];-1==O&&0==E?e.triangle(S.Vector.temp0.set(d,p+r/2),S.Vector.temp1.set(d+8,p),S.Vector.temp2.set(d+8,p+r),y):1==O&&0==E?e.triangle(S.Vector.temp0.set(d+i-8,p),S.Vector.temp1.set(d+i,p+r/2),S.Vector.temp2.set(d+i-8,p+r),y):0==O&&-1==E?e.triangle(S.Vector.temp0.set(d,p+8),S.Vector.temp1.set(d+i/2,p),S.Vector.temp2.set(d+i,p+8),y):0==O&&1==E&&e.triangle(S.Vector.temp0.set(d,p+r-8),S.Vector.temp1.set(d+i/2,p+r),S.Vector.temp2.set(d+i,p+r-8),y)}}catch(t){g=!0,m=t}finally{try{!v&&x.return&&x.return()}finally{if(g)throw m}}}}}]),WaterFlow}(k.Component);e.WaterFlow=WaterFlow},function(t,e,n){var i=n(221);"string"==typeof i&&(i=[[t.i,i,""]]);var r={};r.transform=void 0,n(223)(i,r),i.locals&&(t.exports=i.locals)},function(t,e,n){e=t.exports=n(222)(void 0),e.push([t.i,"\r\n.json-editor {\r\n\twidth: 400px;\r\n\tposition: absolute;\r\n\tright: 0;\r\n\ttop: 10px;\r\n\tbackground: white;\r\n\tfont-family: Consolas;\r\n\tfont-size: 10px;\r\n}",""])},function(t,e){function n(t,e){var n=t[1]||"",r=t[3];if(!r)return n;if(e&&"function"==typeof btoa){var o=i(r);return[n].concat(r.sources.map(function(t){return"/*# sourceURL="+r.sourceRoot+t+" */"})).concat([o]).join("\n")}return""+n}function i(t){return"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(t))))+" */"}t.exports=function(t){var e=[];return e.toString=function(){return this.map(function(e){var i=n(e,t);return e[2]?"@media "+e[2]+"{"+i+"}":i}).join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var i={},r=0;r<this.length;r++){var o=this[r][0];"number"==typeof o&&(i[o]=!0)}for(r=0;r<t.length;r++){var a=t[r];"number"==typeof a[0]&&i[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),e.push(a))}},e}},function(t,e,n){function i(t,e){for(var n=0;n<t.length;n++){var i=t[n],r=p[i.id];if(r){r.refs++;for(var o=0;o<r.parts.length;o++)r.parts[o](i.parts[o]);for(;o<i.parts.length;o++)r.parts.push(c(i.parts[o],e))}else{for(var a=[],o=0;o<i.parts.length;o++)a.push(c(i.parts[o],e));p[i.id]={id:i.id,refs:1,parts:a}}}}function r(t,e){for(var n=[],i={},r=0;r<t.length;r++){var o=t[r],a=e.base?o[0]+e.base:o[0],s=o[1],u=o[2],l=o[3],c={css:s,media:u,sourceMap:l};i[a]?i[a].parts.push(c):n.push(i[a]={id:a,parts:[c]})}return n}function o(t,e){var n=v(t.insertInto);if(!n)throw Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var i=_[_.length-1];if("top"===t.insertAt)i?i.nextSibling?n.insertBefore(e,i.nextSibling):n.appendChild(e):n.insertBefore(e,n.firstChild),_.push(e);else{if("bottom"!==t.insertAt)throw Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");n.appendChild(e)}}function a(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t);var e=_.indexOf(t);e>=0&&_.splice(e,1)}function s(t){var e=document.createElement("style");return t.attrs.type="text/css",l(e,t.attrs),o(t,e),e}function u(t){var e=document.createElement("link");return t.attrs.type="text/css",t.attrs.rel="stylesheet",l(e,t.attrs),o(t,e),e}function l(t,e){Object.keys(e).forEach(function(n){t.setAttribute(n,e[n])})}function c(t,e){var n,i,r,o;if(e.transform&&t.css){if(!(o=e.transform(t.css)))return function(){};t.css=o}if(e.singleton){var l=m++;n=g||(g=s(e)),i=h.bind(null,n,l,!1),r=h.bind(null,n,l,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=u(e),i=d.bind(null,n,e),r=function(){a(n),n.href&&URL.revokeObjectURL(n.href)}):(n=s(e),i=f.bind(null,n),r=function(){a(n)});return i(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;i(t=e)}else r()}}function h(t,e,n,i){var r=n?"":i.css;if(t.styleSheet)t.styleSheet.cssText=x(e,r);else{var o=document.createTextNode(r),a=t.childNodes;a[e]&&t.removeChild(a[e]),a.length?t.insertBefore(o,a[e]):t.appendChild(o)}}function f(t,e){var n=e.css,i=e.media;if(i&&t.setAttribute("media",i),t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}function d(t,e,n){var i=n.css,r=n.sourceMap,o=void 0===e.convertToAbsoluteUrls&&r;(e.convertToAbsoluteUrls||o)&&(i=b(i)),r&&(i+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */");var a=new Blob([i],{type:"text/css"}),s=t.href;t.href=URL.createObjectURL(a),s&&URL.revokeObjectURL(s)}var p={},y=function(t){var e;return function(){return void 0===e&&(e=t.apply(this,arguments)),e}}(function(){return window&&document&&document.all&&!window.atob}),v=function(t){var e={};return function(n){return void 0===e[n]&&(e[n]=t.call(this,n)),e[n]}}(function(t){return document.querySelector(t)}),g=null,m=0,_=[],b=n(224);t.exports=function(t,e){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw Error("The style-loader cannot be used in a non-browser environment");e=e||{},e.attrs="object"==typeof e.attrs?e.attrs:{},e.singleton||(e.singleton=y()),e.insertInto||(e.insertInto="head"),e.insertAt||(e.insertAt="bottom");var n=r(t,e);return i(n,e),function(t){for(var o=[],a=0;a<n.length;a++){var s=n[a],u=p[s.id];u.refs--,o.push(u)}t&&i(r(t,e),e);for(var a=0;a<o.length;a++){var u=o[a];if(0===u.refs){for(var l=0;l<u.parts.length;l++)u.parts[l]();delete p[u.id]}}}};var x=function(){var t=[];return function(e,n){return t[e]=n,t.filter(Boolean).join("\n")}}()},function(t,e){t.exports=function(t){var e="undefined"!=typeof window&&window.location;if(!e)throw Error("fixUrls requires window.location");if(!t||"string"!=typeof t)return t;var n=e.protocol+"//"+e.host,i=n+e.pathname.replace(/\/[^\/]*$/,"/");return t.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(t,e){var r=e.trim().replace(/^"(.*)"$/,function(t,e){return e}).replace(/^'(.*)'$/,function(t,e){return e});if(/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/)/i.test(r))return t;var o;return o=0===r.indexOf("//")?r:0===r.indexOf("/")?n+r:i+r.replace(/^\.\//,""),"url("+JSON.stringify(o)+")"})}},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a),u=n(2),l=i(u),c=n(6),h=i(c),f=n(3),d=i(f),p=n(4),y=i(p),v=function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===("undefined"==typeof Reflect?"undefined":(0,y.default)(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(e,"__esModule",{value:!0});var g=n(5),m=n(9),_=n(7),b=n(56),Wobble=function(t){function Wobble(){(0,o.default)(this,Wobble);var t=(0,l.default)(this,(Wobble.__proto__||Object.getPrototypeOf(Wobble)).apply(this,arguments));return t.startPos=new _.Vector,t.intensity=3,t.frequency=2.1,t.offset=0,t.extraHeight=-3,t.shadows=[],t}return(0,d.default)(Wobble,t),(0,s.default)(Wobble,[{key:"addedToScene",value:function(){(0,h.default)(Wobble.prototype.__proto__||Object.getPrototypeOf(Wobble.prototype),"addedToScene",this).call(this),this.offset=_.Calc.range(0,2*Math.PI),this.startPos.copy(this.graphic.position);var t=this.scene.numShadows,e=this.entity.add(new b.ChildEntity({name:"Wobble Child of "+this.entity.name}));e.child.depth=this.entity.depth+1;for(var n=0;n<t;++n){var i=this.scene.getShadow(n),r=e.entity.add(new m.Graphic(i,_.Vector.temp0.set(-4,-5)));r.alpha=.7,r.visible=!1,this.shadows.push(r)}}},{key:"update",value:function(){if((0,h.default)(Wobble.prototype.__proto__||Object.getPrototypeOf(Wobble.prototype),"update",this).call(this),!(g.Engine.delta<=0)){var t=Math.sin(g.Engine.elapsed*this.frequency+this.offset),e=(t+1)/2,n=Math.floor(e*this.shadows.length),i=this.startPos.y+e*this.intensity;this.graphic.y=i+this.extraHeight;for(var r=(this.startPos.y,this.intensity,this.startPos.y,this.intensity,0);r<this.shadows.length;++r)this.shadows[r].visible=r===n}}}]),Wobble}(g.Component);v([g.Component.require,function(t,e){if("object"===("undefined"==typeof Reflect?"undefined":(0,y.default)(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:type",m.Graphic)],Wobble.prototype,"graphic",void 0),Wobble=v([g.Component.register],Wobble),e.Wobble=Wobble},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a),u=n(2),l=i(u),c=n(3),h=i(c);Object.defineProperty(e,"__esModule",{value:!0});var f=n(5),d=n(14),p=n(12),y=n(7),v=n(15),g=n(41),m=n(31),_=function(t){function e(t,n,i,r){(0,o.default)(this,e);var a=(0,l.default)(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return a.spawnPlayerTimer=1,a.playerOn=!0,a.isOpen=!0,a.closedEase=1,a.name=t,a.gotoScene=n,a.gotoDoor=i,a.spawnPlayer=r,a.add(a.hitbbox=new p.Hitbox({left:-4,top:-8,width:8,height:8})),a}return(0,h.default)(e,t),(0,s.default)(e,[{key:"added",value:function(){this.spawnPlayer&&this.scene.camera.position.set(this.x,this.y-64)}},{key:"update",value:function(){var t=this;if(this.spawnPlayer&&this.spawnPlayerTimer>0){if(this.spawnPlayerTimer-=1.25*f.Engine.delta,this.scene.camera.position.set(this.x,this.y-64*y.Ease.cubeIn(this.spawnPlayerTimer)),this.spawnPlayerTimer<=0){var e=void 0;this.scene.add(e=new m.Player,new y.Vector(this.x,this.y)),e.find(d.Physics).speed.y=120,this.closedEase=0}}else this.hitbbox.check(v.Game.TAGS.PLAYER)?this.gotoScene.length>0&&!this.playerOn&&(this.scene.remove(this.scene.find(m.Player)),this.playerOn=!0,this.scene.doSlide(1,0,function(){f.Engine.goto(new g.Level(t.gotoScene,t.gotoDoor),!1)})):(this.isOpen&&this.gotoScene.length<=0&&(this.hitbbox.tag(v.Game.TAGS.SOLID),this.isOpen=!1),this.playerOn=!1,this.isOpen||(this.closedEase=y.Calc.approach(this.closedEase,1,f.Engine.delta)))}},{key:"render",value:function(){f.Engine.graphics.rect(this.x+-6,this.y-13,12,13,v.Game.COLORS[3]),f.Engine.graphics.rect(this.x+-5,this.y-12,10,12,v.Game.COLORS[2]),f.Engine.graphics.rect(this.x+-4,this.y-11,8,11,v.Game.COLORS[3]),this.isOpen||f.Engine.graphics.rect(this.x+-3,this.y-10,6,10*this.closedEase,v.Game.COLORS[2])}}]),e}(f.Entity);e.Door=_},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.3;return e.alpha=0,_.Tween.create(t).start(n,0,1,m.Ease.linear,function(t){e.alpha=t},!0).restart()}function o(t){if("ice"===t)return b.SpriteBank.get("blue_orb").first.frames[0];if("mimic"===t)return b.SpriteBank.get("grey_orb").first.frames[0];throw Error(t)}var a=n(0),s=i(a),u=n(1),l=i(u),c=n(2),h=i(c),f=n(6),d=i(f),p=n(3),y=i(p);Object.defineProperty(e,"__esModule",{value:!0});var v=n(5),g=n(9),m=n(7),_=n(14),b=n(54),x=n(36),w=function(t){function e(){(0,s.default)(this,e);var t=(0,h.default)(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.graphics=[],t.totalPadding=new m.Vector(10,10),t.lastShots="~",t.lastNumShots=-1,t.name="Hud",t}return(0,y.default)(e,t),(0,l.default)(e,[{key:"started",value:function(){(0,d.default)(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"started",this).call(this);var t=this.scene.firstColliderInTag("player");t&&(this.gun=t.entity.find(x.FreezingShot),this.rect=this.add(new g.Rectsprite(0,8,new m.Color(0,0,0,.8))),this.rect.y=5)}},{key:"update",value:function(){if((0,d.default)(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),this.gun){var t=b.SpriteBank.get("blue_orb");if(t){var n=this.scene.camera.extents;this.position.set(n.left,n.top).add(this.totalPadding);var i=this.gun.shotsLeft,a=t.first.frames[0],s=this.gun.shots.join("_");if(s!==this.lastShots){this.lastShots=s;var u=this.gun.shots.length-this.lastNumShots;for(this.lastNumShots=this.gun.shots.length;this.graphics.length;)this.remove(this.graphics.splice(0,1)[0]);var l=0,c=!0,h=!1,f=void 0;try{for(var p,y=this.gun.shots[Symbol.iterator]();!(c=(p=y.next()).done);c=!0){var v=p.value,_=o(v),x=new g.Graphic(_,m.Vector.temp0.set(this.graphics.length*(_.width+4),0));this.graphics.push(this.add(x)),u>0&&this.gun.shots.length-l-1<u&&r(this,x,.3),l++}}catch(t){h=!0,f=t}finally{try{!c&&y.return&&y.return()}finally{if(h)throw f}}this.rect.visible=i>0,this.rect.width=(a.width+4)*i-4}}}}}]),e}(v.Entity);e.Hud=w},function(t,e,n){"use strict";function i(){return{vert:n(229),frag:n(230)}}Object.defineProperty(e,"__esModule",{value:!0});var r=n(7),o=void 0;t.exports=function(){var t=i(),e=t.vert,n=t.frag;return o=new r.Shader(e,n,[new r.ShaderUniform("time",r.ShaderUniformType.float),new r.ShaderUniform("matrix",r.ShaderUniformType.matrix3d),new r.ShaderUniform("texture",r.ShaderUniformType.sampler2D)],[new r.ShaderAttribute("a_position",r.ShaderAttributeType.Position),new r.ShaderAttribute("a_texcoord",r.ShaderAttributeType.Texcoord),new r.ShaderAttribute("a_color",r.ShaderAttributeType.Color),new r.ShaderAttribute("a_colorAdd",r.ShaderAttributeType.Color)])}},function(t,e){t.exports="uniform float time;\r\n\r\nattribute vec2 a_position;\r\nattribute vec2 a_texcoord;\r\nattribute vec4 a_color;\r\nattribute vec4 a_colorAdd;\r\n\r\nuniform mat3 matrix;\r\nvarying vec2 v_texcoord;\r\nvarying vec4 v_color;\r\nvarying vec4 v_colorAdd;\r\n\r\nvoid main()\r\n{\r\n\tvec4 pos = vec4((matrix * vec3(a_position, 1.0)).xy, 0.0, 1.0);\r\n\tgl_Position = pos;\r\n\tv_texcoord = vec2(a_texcoord.x, a_texcoord.y);\r\n\tv_color = vec4(a_color.rgb * a_color.a, a_color.a);\r\n\tv_colorAdd = vec4(a_colorAdd.rgb * a_colorAdd.a, a_colorAdd.a);\r\n}"},function(t,e){t.exports="// fragment shader\r\nprecision mediump float;\r\nvarying vec2 v_texcoord;\r\nvarying vec4 v_color;\r\nvarying vec4 v_colorAdd;\r\nuniform sampler2D texture;\r\n\r\nvoid main() \r\n{\r\n\tgl_FragColor = texture2D(texture, v_texcoord) * v_color;\r\n}"},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(1),s=i(a),u=n(2),l=i(u),c=n(6),h=i(c),f=n(3),d=i(f);Object.defineProperty(e,"__esModule",{value:!0});var p=n(5),y=n(54),v=n(79),g=n(9),m=n(7),_=n(16),b=n(44),x=function(t){function e(){(0,o.default)(this,e);var t=(0,l.default)(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.sliderEnabled=!1,t.scene="title",t}return(0,d.default)(e,t),(0,s.default)(e,[{key:"begin",value:function(){(0,h.default)(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"begin",this).call(this);var t=new p.Entity,n=new m.Color(0,0,0,.3),i=t.add(new g.Rectsprite(1e3,80,n));i.x=-50,i.rotation=-.1;var r=t.add(new g.Rectsprite(1e3,120,n));r.x=-50,r.y=230,r.rotation=-.1,this.add(t),y.SpriteBank.get("question").get("mark").loops=!0,this.add(_.instantiatePrefab("endscreen",null,219,135)),this.add(new p.Entity).add(new v.StaticGraphic({texture:"lookingformore",x:45,y:70}));var o=document.getElementById("mailchimp_signup");o&&(o.style.position="absolute",o.style.left="50vh",o.style.bottom="10vh",o.style.alignContent="center",o.style.display="block",o.style.zIndex="1000"),this.loaded=!0}}]),e}(b.EditableScene);e.EndScreen=x},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(0),o=i(r),a=n(2),s=i(a),u=n(3),l=i(u);Object.defineProperty(e,"__esModule",{value:!0});var c=n(112),h=n(5),f=n(44),d=n(16),p=function(t){function e(t){(0,o.default)(this,e);var n=(0,s.default)(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return setTimeout(function(){n.entity=n.add(d.instantiatePrefab(t)),n.camera.origin.set(h.Engine.width/2,h.Engine.height/2),n.entity.components.each(function(t){t instanceof c.Burst&&(t.loop=!0)})},50),n}return(0,l.default)(e,t),e}(f.EditableScene);e.PrefabTestScene=p},function(t,e,n){"use strict";function i(){function t(t,e){new r.ParticleTemplate(t).colors(e,e).accelY(-90,15).duration(.35).alphaFrom(1).alphaTo(0).alphaEase(o.Ease.linear)}new r.ParticleTemplate("water").colors([o.Color.white,new o.Color(0,0,1,1),new o.Color(0,0,.5,1)]).duration(3.2,.9),new r.ParticleTemplate("pickup").speed(0,90).accelY(350).duration(.3,.09).colors([o.Color.red,new o.Color(1,.5,1)]).alphaFrom(1).alphaTo(0).alphaEase(o.Ease.linear),new r.ParticleTemplate("freezing_shot_shatter").speed(0,90).accelY(100,200).duration(.22,.1).colors([new o.Color(100,100,255),new o.Color(150,150,255)]).alphaFrom(.9,.1).alphaTo(0),new r.ParticleTemplate("ice_shatter").speed(0,90).accelY(100).duration(.22,.1).colors([o.Color.white,o.Color.blue]).alphaFrom(.9,.1).alphaTo(0),new r.ParticleTemplate("treasure_pickup").speed(0,-10).accelY(-800,500).colors([new o.Color(0,1,1)]).duration(.7).alphaFrom(1).alphaTo(0),new r.ParticleTemplate("dust").accelX(-120,40).accelY(-20,10).colors([o.Color.red,o.Color.white,o.Color.blue]).duration(12).scale(1.5,.5),new r.ParticleTemplate("dragon_fire_burst").colors([o.Color.red,new o.Color(.8,.1,.1),new o.Color(.4,0,0)]).speed(0,90).accelY(350).duration(.3,.09).colors([o.Color.red,new o.Color(1,.5,1)]).alphaFrom(1).alphaTo(0).alphaEase(o.Ease.linear),t("ice_heart_ambient",[o.Color.fromHex("#3448ac"),o.Color.fromHex("#3b77c2")]),t("mimic_heart_ambient",[o.Color.fromHex("#c0c0c0"),o.Color.fromHex("#666666"),o.Color.fromHex("#ffffff")])}Object.defineProperty(e,"__esModule",{value:!0});var r=n(42),o=n(7);e.defineTemplates=i},function(t,e){t.exports={levels:["level0","block_intro","shot_intro","shatter_intro","dragon_intro","tutorial_block","level2","water_teach","medusa_teach","medusa_simple","mimic_teach","mimic_cross","mimic_intro","spikes_intro","spike_circle"]}}]);